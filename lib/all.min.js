/*!
  * Bootstrap v5.3.0 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).bootstrap=e()}(this,(function(){"use strict";const t=new Map,e={set(e,i,n){t.has(e)||t.set(e,new Map);const s=t.get(e);s.has(i)||0===s.size?s.set(i,n):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(s.keys())[0]}.`)},get:(e,i)=>t.has(e)&&t.get(e).get(i)||null,remove(e,i){if(!t.has(e))return;const n=t.get(e);n.delete(i),0===n.size&&t.delete(e)}},i="transitionend",n=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,((t,e)=>`#${CSS.escape(e)}`))),t),s=t=>{t.dispatchEvent(new Event(i))},o=t=>!(!t||"object"!=typeof t)&&(void 0!==t.jquery&&(t=t[0]),void 0!==t.nodeType),r=t=>o(t)?t.jquery?t[0]:t:"string"==typeof t&&t.length>0?document.querySelector(n(t)):null,a=t=>{if(!o(t)||0===t.getClientRects().length)return!1;const e="visible"===getComputedStyle(t).getPropertyValue("visibility"),i=t.closest("details:not([open])");if(!i)return e;if(i!==t){const e=t.closest("summary");if(e&&e.parentNode!==i)return!1;if(null===e)return!1}return e},l=t=>!t||t.nodeType!==Node.ELEMENT_NODE||!!t.classList.contains("disabled")||(void 0!==t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled")),c=t=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?c(t.parentNode):null},h=()=>{},d=t=>{t.offsetHeight},u=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,f=[],p=()=>"rtl"===document.documentElement.dir,m=t=>{var e;e=()=>{const e=u();if(e){const i=t.NAME,n=e.fn[i];e.fn[i]=t.jQueryInterface,e.fn[i].Constructor=t,e.fn[i].noConflict=()=>(e.fn[i]=n,t.jQueryInterface)}},"loading"===document.readyState?(f.length||document.addEventListener("DOMContentLoaded",(()=>{for(const t of f)t()})),f.push(e)):e()},g=(t,e=[],i=t)=>"function"==typeof t?t(...e):i,_=(t,e,n=!0)=>{if(!n)return void g(t);const o=(t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:i}=window.getComputedStyle(t);const n=Number.parseFloat(e),s=Number.parseFloat(i);return n||s?(e=e.split(",")[0],i=i.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(i))):0})(e)+5;let r=!1;const a=({target:n})=>{n===e&&(r=!0,e.removeEventListener(i,a),g(t))};e.addEventListener(i,a),setTimeout((()=>{r||s(e)}),o)},b=(t,e,i,n)=>{const s=t.length;let o=t.indexOf(e);return-1===o?!i&&n?t[s-1]:t[0]:(o+=i?1:-1,n&&(o=(o+s)%s),t[Math.max(0,Math.min(o,s-1))])},v=/[^.]*(?=\..*)\.|.*/,y=/\..*/,w=/::\d+$/,A={};let E=1;const T={mouseenter:"mouseover",mouseleave:"mouseout"},C=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function O(t,e){return e&&`${e}::${E++}`||t.uidEvent||E++}function x(t){const e=O(t);return t.uidEvent=e,A[e]=A[e]||{},A[e]}function k(t,e,i=null){return Object.values(t).find((t=>t.callable===e&&t.delegationSelector===i))}function L(t,e,i){const n="string"==typeof e,s=n?i:e||i;let o=N(t);return C.has(o)||(o=t),[n,s,o]}function S(t,e,i,n,s){if("string"!=typeof e||!t)return;let[o,r,a]=L(e,i,n);if(e in T){const t=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};r=t(r)}const l=x(t),c=l[a]||(l[a]={}),h=k(c,r,o?i:null);if(h)return void(h.oneOff=h.oneOff&&s);const d=O(r,e.replace(v,"")),u=o?function(t,e,i){return function n(s){const o=t.querySelectorAll(e);for(let{target:r}=s;r&&r!==this;r=r.parentNode)for(const a of o)if(a===r)return M(s,{delegateTarget:r}),n.oneOff&&P.off(t,s.type,e,i),i.apply(r,[s])}}(t,i,r):function(t,e){return function i(n){return M(n,{delegateTarget:t}),i.oneOff&&P.off(t,n.type,e),e.apply(t,[n])}}(t,r);u.delegationSelector=o?i:null,u.callable=r,u.oneOff=s,u.uidEvent=d,c[d]=u,t.addEventListener(a,u,o)}function D(t,e,i,n,s){const o=k(e[i],n,s);o&&(t.removeEventListener(i,o,Boolean(s)),delete e[i][o.uidEvent])}function I(t,e,i,n){const s=e[i]||{};for(const[o,r]of Object.entries(s))o.includes(n)&&D(t,e,i,r.callable,r.delegationSelector)}function N(t){return t=t.replace(y,""),T[t]||t}const P={on(t,e,i,n){S(t,e,i,n,!1)},one(t,e,i,n){S(t,e,i,n,!0)},off(t,e,i,n){if("string"!=typeof e||!t)return;const[s,o,r]=L(e,i,n),a=r!==e,l=x(t),c=l[r]||{},h=e.startsWith(".");if(void 0===o){if(h)for(const i of Object.keys(l))I(t,l,i,e.slice(1));for(const[i,n]of Object.entries(c)){const s=i.replace(w,"");a&&!e.includes(s)||D(t,l,r,n.callable,n.delegationSelector)}}else{if(!Object.keys(c).length)return;D(t,l,r,o,s?i:null)}},trigger(t,e,i){if("string"!=typeof e||!t)return null;const n=u();let s=null,o=!0,r=!0,a=!1;e!==N(e)&&n&&(s=n.Event(e,i),n(t).trigger(s),o=!s.isPropagationStopped(),r=!s.isImmediatePropagationStopped(),a=s.isDefaultPrevented());const l=M(new Event(e,{bubbles:o,cancelable:!0}),i);return a&&l.preventDefault(),r&&t.dispatchEvent(l),l.defaultPrevented&&s&&s.preventDefault(),l}};function M(t,e={}){for(const[i,n]of Object.entries(e))try{t[i]=n}catch(e){Object.defineProperty(t,i,{configurable:!0,get:()=>n})}return t}function j(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(e){return t}}function F(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}const H={setDataAttribute(t,e,i){t.setAttribute(`data-bs-${F(e)}`,i)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${F(e)}`)},getDataAttributes(t){if(!t)return{};const e={},i=Object.keys(t.dataset).filter((t=>t.startsWith("bs")&&!t.startsWith("bsConfig")));for(const n of i){let i=n.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1,i.length),e[i]=j(t.dataset[n])}return e},getDataAttribute:(t,e)=>j(t.getAttribute(`data-bs-${F(e)}`))};class ${static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const i=o(e)?H.getDataAttribute(e,"config"):{};return{...this.constructor.Default,..."object"==typeof i?i:{},...o(e)?H.getDataAttributes(e):{},..."object"==typeof t?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[n,s]of Object.entries(e)){const e=t[n],r=o(e)?"element":null==(i=e)?`${i}`:Object.prototype.toString.call(i).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(s).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${r}" but expected type "${s}".`)}var i}}class W extends ${constructor(t,i){super(),(t=r(t))&&(this._element=t,this._config=this._getConfig(i),e.set(this._element,this.constructor.DATA_KEY,this))}dispose(){e.remove(this._element,this.constructor.DATA_KEY),P.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,i=!0){_(t,e,i)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return e.get(r(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,"object"==typeof e?e:null)}static get VERSION(){return"5.3.0"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const B=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let i=t.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),e=i&&"#"!==i?i.trim():null}return n(e)},z={find:(t,e=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(e,t)),findOne:(t,e=document.documentElement)=>Element.prototype.querySelector.call(e,t),children:(t,e)=>[].concat(...t.children).filter((t=>t.matches(e))),parents(t,e){const i=[];let n=t.parentNode.closest(e);for(;n;)i.push(n),n=n.parentNode.closest(e);return i},prev(t,e){let i=t.previousElementSibling;for(;i;){if(i.matches(e))return[i];i=i.previousElementSibling}return[]},next(t,e){let i=t.nextElementSibling;for(;i;){if(i.matches(e))return[i];i=i.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((t=>`${t}:not([tabindex^="-"])`)).join(",");return this.find(e,t).filter((t=>!l(t)&&a(t)))},getSelectorFromElement(t){const e=B(t);return e&&z.findOne(e)?e:null},getElementFromSelector(t){const e=B(t);return e?z.findOne(e):null},getMultipleElementsFromSelector(t){const e=B(t);return e?z.find(e):[]}},R=(t,e="hide")=>{const i=`click.dismiss${t.EVENT_KEY}`,n=t.NAME;P.on(document,i,`[data-bs-dismiss="${n}"]`,(function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),l(this))return;const s=z.getElementFromSelector(this)||this.closest(`.${n}`);t.getOrCreateInstance(s)[e]()}))};class q extends W{static get NAME(){return"alert"}close(){if(P.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const t=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,t)}_destroyElement(){this._element.remove(),P.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(t){return this.each((function(){const e=q.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}R(q,"close"),m(q);const V='[data-bs-toggle="button"]';class K extends W{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each((function(){const e=K.getOrCreateInstance(this);"toggle"===t&&e[t]()}))}}P.on(document,"click.bs.button.data-api",V,(t=>{t.preventDefault();const e=t.target.closest(V);K.getOrCreateInstance(e).toggle()})),m(K);const Q={endCallback:null,leftCallback:null,rightCallback:null},X={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Y extends ${constructor(t,e){super(),this._element=t,t&&Y.isSupported()&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return Q}static get DefaultType(){return X}static get NAME(){return"swipe"}dispose(){P.off(this._element,".bs.swipe")}_start(t){this._supportPointerEvents?this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX):this._deltaX=t.touches[0].clientX}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),g(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=40)return;const e=t/this._deltaX;this._deltaX=0,e&&g(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(P.on(this._element,"pointerdown.bs.swipe",(t=>this._start(t))),P.on(this._element,"pointerup.bs.swipe",(t=>this._end(t))),this._element.classList.add("pointer-event")):(P.on(this._element,"touchstart.bs.swipe",(t=>this._start(t))),P.on(this._element,"touchmove.bs.swipe",(t=>this._move(t))),P.on(this._element,"touchend.bs.swipe",(t=>this._end(t))))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&("pen"===t.pointerType||"touch"===t.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const U="next",G="prev",J="left",Z="right",tt="slid.bs.carousel",et="carousel",it="active",nt={ArrowLeft:Z,ArrowRight:J},st={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},ot={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class rt extends W{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=z.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===et&&this.cycle()}static get Default(){return st}static get DefaultType(){return ot}static get NAME(){return"carousel"}next(){this._slide(U)}nextWhenVisible(){!document.hidden&&a(this._element)&&this.next()}prev(){this._slide(G)}pause(){this._isSliding&&s(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval((()=>this.nextWhenVisible()),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?P.one(this._element,tt,(()=>this.cycle())):this.cycle())}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding)return void P.one(this._element,tt,(()=>this.to(t)));const i=this._getItemIndex(this._getActive());if(i===t)return;const n=t>i?U:G;this._slide(n,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&P.on(this._element,"keydown.bs.carousel",(t=>this._keydown(t))),"hover"===this._config.pause&&(P.on(this._element,"mouseenter.bs.carousel",(()=>this.pause())),P.on(this._element,"mouseleave.bs.carousel",(()=>this._maybeEnableCycle()))),this._config.touch&&Y.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const t of z.find(".carousel-item img",this._element))P.on(t,"dragstart.bs.carousel",(t=>t.preventDefault()));const t={leftCallback:()=>this._slide(this._directionToOrder(J)),rightCallback:()=>this._slide(this._directionToOrder(Z)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((()=>this._maybeEnableCycle()),500+this._config.interval))}};this._swipeHelper=new Y(this._element,t)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=nt[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=z.findOne(".active",this._indicatorsElement);e.classList.remove(it),e.removeAttribute("aria-current");const i=z.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);i&&(i.classList.add(it),i.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const i=this._getActive(),n=t===U,s=e||b(this._getItems(),i,n,this._config.wrap);if(s===i)return;const o=this._getItemIndex(s),r=e=>P.trigger(this._element,e,{relatedTarget:s,direction:this._orderToDirection(t),from:this._getItemIndex(i),to:o});if(r("slide.bs.carousel").defaultPrevented)return;if(!i||!s)return;const a=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=s;const l=n?"carousel-item-start":"carousel-item-end",c=n?"carousel-item-next":"carousel-item-prev";s.classList.add(c),d(s),i.classList.add(l),s.classList.add(l),this._queueCallback((()=>{s.classList.remove(l,c),s.classList.add(it),i.classList.remove(it,c,l),this._isSliding=!1,r(tt)}),i,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return z.findOne(".active.carousel-item",this._element)}_getItems(){return z.find(".carousel-item",this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return p()?t===J?G:U:t===J?U:G}_orderToDirection(t){return p()?t===G?J:Z:t===G?Z:J}static jQueryInterface(t){return this.each((function(){const e=rt.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}else e.to(t)}))}}P.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",(function(t){const e=z.getElementFromSelector(this);if(!e||!e.classList.contains(et))return;t.preventDefault();const i=rt.getOrCreateInstance(e),n=this.getAttribute("data-bs-slide-to");return n?(i.to(n),void i._maybeEnableCycle()):"next"===H.getDataAttribute(this,"slide")?(i.next(),void i._maybeEnableCycle()):(i.prev(),void i._maybeEnableCycle())})),P.on(window,"load.bs.carousel.data-api",(()=>{const t=z.find('[data-bs-ride="carousel"]');for(const e of t)rt.getOrCreateInstance(e)})),m(rt);const at="show",lt="collapse",ct="collapsing",ht='[data-bs-toggle="collapse"]',dt={parent:null,toggle:!0},ut={parent:"(null|element)",toggle:"boolean"};class ft extends W{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const i=z.find(ht);for(const t of i){const e=z.getSelectorFromElement(t),i=z.find(e).filter((t=>t===this._element));null!==e&&i.length&&this._triggerArray.push(t)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return dt}static get DefaultType(){return ut}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((t=>t!==this._element)).map((t=>ft.getOrCreateInstance(t,{toggle:!1})))),t.length&&t[0]._isTransitioning)return;if(P.trigger(this._element,"show.bs.collapse").defaultPrevented)return;for(const e of t)e.hide();const e=this._getDimension();this._element.classList.remove(lt),this._element.classList.add(ct),this._element.style[e]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=`scroll${e[0].toUpperCase()+e.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(ct),this._element.classList.add(lt,at),this._element.style[e]="",P.trigger(this._element,"shown.bs.collapse")}),this._element,!0),this._element.style[e]=`${this._element[i]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(P.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,d(this._element),this._element.classList.add(ct),this._element.classList.remove(lt,at);for(const t of this._triggerArray){const e=z.getElementFromSelector(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0,this._element.style[t]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(ct),this._element.classList.add(lt),P.trigger(this._element,"hidden.bs.collapse")}),this._element,!0)}_isShown(t=this._element){return t.classList.contains(at)}_configAfterMerge(t){return t.toggle=Boolean(t.toggle),t.parent=r(t.parent),t}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(ht);for(const e of t){const t=z.getElementFromSelector(e);t&&this._addAriaAndCollapsedClass([e],this._isShown(t))}}_getFirstLevelChildren(t){const e=z.find(":scope .collapse .collapse",this._config.parent);return z.find(t,this._config.parent).filter((t=>!e.includes(t)))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const i of t)i.classList.toggle("collapsed",!e),i.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return"string"==typeof t&&/show|hide/.test(t)&&(e.toggle=!1),this.each((function(){const i=ft.getOrCreateInstance(this,e);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t]()}}))}}P.on(document,"click.bs.collapse.data-api",ht,(function(t){("A"===t.target.tagName||t.delegateTarget&&"A"===t.delegateTarget.tagName)&&t.preventDefault();for(const t of z.getMultipleElementsFromSelector(this))ft.getOrCreateInstance(t,{toggle:!1}).toggle()})),m(ft);var pt="top",mt="bottom",gt="right",_t="left",bt="auto",vt=[pt,mt,gt,_t],yt="start",wt="end",At="clippingParents",Et="viewport",Tt="popper",Ct="reference",Ot=vt.reduce((function(t,e){return t.concat([e+"-"+yt,e+"-"+wt])}),[]),xt=[].concat(vt,[bt]).reduce((function(t,e){return t.concat([e,e+"-"+yt,e+"-"+wt])}),[]),kt="beforeRead",Lt="read",St="afterRead",Dt="beforeMain",It="main",Nt="afterMain",Pt="beforeWrite",Mt="write",jt="afterWrite",Ft=[kt,Lt,St,Dt,It,Nt,Pt,Mt,jt];function Ht(t){return t?(t.nodeName||"").toLowerCase():null}function $t(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Wt(t){return t instanceof $t(t).Element||t instanceof Element}function Bt(t){return t instanceof $t(t).HTMLElement||t instanceof HTMLElement}function zt(t){return"undefined"!=typeof ShadowRoot&&(t instanceof $t(t).ShadowRoot||t instanceof ShadowRoot)}const Rt={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var i=e.styles[t]||{},n=e.attributes[t]||{},s=e.elements[t];Bt(s)&&Ht(s)&&(Object.assign(s.style,i),Object.keys(n).forEach((function(t){var e=n[t];!1===e?s.removeAttribute(t):s.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach((function(t){var n=e.elements[t],s=e.attributes[t]||{},o=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:i[t]).reduce((function(t,e){return t[e]="",t}),{});Bt(n)&&Ht(n)&&(Object.assign(n.style,o),Object.keys(s).forEach((function(t){n.removeAttribute(t)})))}))}},requires:["computeStyles"]};function qt(t){return t.split("-")[0]}var Vt=Math.max,Kt=Math.min,Qt=Math.round;function Xt(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function Yt(){return!/^((?!chrome|android).)*safari/i.test(Xt())}function Ut(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var n=t.getBoundingClientRect(),s=1,o=1;e&&Bt(t)&&(s=t.offsetWidth>0&&Qt(n.width)/t.offsetWidth||1,o=t.offsetHeight>0&&Qt(n.height)/t.offsetHeight||1);var r=(Wt(t)?$t(t):window).visualViewport,a=!Yt()&&i,l=(n.left+(a&&r?r.offsetLeft:0))/s,c=(n.top+(a&&r?r.offsetTop:0))/o,h=n.width/s,d=n.height/o;return{width:h,height:d,top:c,right:l+h,bottom:c+d,left:l,x:l,y:c}}function Gt(t){var e=Ut(t),i=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:n}}function Jt(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&zt(i)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Zt(t){return $t(t).getComputedStyle(t)}function te(t){return["table","td","th"].indexOf(Ht(t))>=0}function ee(t){return((Wt(t)?t.ownerDocument:t.document)||window.document).documentElement}function ie(t){return"html"===Ht(t)?t:t.assignedSlot||t.parentNode||(zt(t)?t.host:null)||ee(t)}function ne(t){return Bt(t)&&"fixed"!==Zt(t).position?t.offsetParent:null}function se(t){for(var e=$t(t),i=ne(t);i&&te(i)&&"static"===Zt(i).position;)i=ne(i);return i&&("html"===Ht(i)||"body"===Ht(i)&&"static"===Zt(i).position)?e:i||function(t){var e=/firefox/i.test(Xt());if(/Trident/i.test(Xt())&&Bt(t)&&"fixed"===Zt(t).position)return null;var i=ie(t);for(zt(i)&&(i=i.host);Bt(i)&&["html","body"].indexOf(Ht(i))<0;){var n=Zt(i);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||e&&"filter"===n.willChange||e&&n.filter&&"none"!==n.filter)return i;i=i.parentNode}return null}(t)||e}function oe(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function re(t,e,i){return Vt(t,Kt(e,i))}function ae(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function le(t,e){return e.reduce((function(e,i){return e[i]=t,e}),{})}const ce={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,i=t.state,n=t.name,s=t.options,o=i.elements.arrow,r=i.modifiersData.popperOffsets,a=qt(i.placement),l=oe(a),c=[_t,gt].indexOf(a)>=0?"height":"width";if(o&&r){var h=function(t,e){return ae("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:le(t,vt))}(s.padding,i),d=Gt(o),u="y"===l?pt:_t,f="y"===l?mt:gt,p=i.rects.reference[c]+i.rects.reference[l]-r[l]-i.rects.popper[c],m=r[l]-i.rects.reference[l],g=se(o),_=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,b=p/2-m/2,v=h[u],y=_-d[c]-h[f],w=_/2-d[c]/2+b,A=re(v,w,y),E=l;i.modifiersData[n]=((e={})[E]=A,e.centerOffset=A-w,e)}},effect:function(t){var e=t.state,i=t.options.element,n=void 0===i?"[data-popper-arrow]":i;null!=n&&("string"!=typeof n||(n=e.elements.popper.querySelector(n)))&&Jt(e.elements.popper,n)&&(e.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function he(t){return t.split("-")[1]}var de={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ue(t){var e,i=t.popper,n=t.popperRect,s=t.placement,o=t.variation,r=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,h=t.roundOffsets,d=t.isFixed,u=r.x,f=void 0===u?0:u,p=r.y,m=void 0===p?0:p,g="function"==typeof h?h({x:f,y:m}):{x:f,y:m};f=g.x,m=g.y;var _=r.hasOwnProperty("x"),b=r.hasOwnProperty("y"),v=_t,y=pt,w=window;if(c){var A=se(i),E="clientHeight",T="clientWidth";A===$t(i)&&"static"!==Zt(A=ee(i)).position&&"absolute"===a&&(E="scrollHeight",T="scrollWidth"),(s===pt||(s===_t||s===gt)&&o===wt)&&(y=mt,m-=(d&&A===w&&w.visualViewport?w.visualViewport.height:A[E])-n.height,m*=l?1:-1),s!==_t&&(s!==pt&&s!==mt||o!==wt)||(v=gt,f-=(d&&A===w&&w.visualViewport?w.visualViewport.width:A[T])-n.width,f*=l?1:-1)}var C,O=Object.assign({position:a},c&&de),x=!0===h?function(t,e){var i=t.x,n=t.y,s=e.devicePixelRatio||1;return{x:Qt(i*s)/s||0,y:Qt(n*s)/s||0}}({x:f,y:m},$t(i)):{x:f,y:m};return f=x.x,m=x.y,l?Object.assign({},O,((C={})[y]=b?"0":"",C[v]=_?"0":"",C.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+m+"px)":"translate3d("+f+"px, "+m+"px, 0)",C)):Object.assign({},O,((e={})[y]=b?m+"px":"",e[v]=_?f+"px":"",e.transform="",e))}const fe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,i=t.options,n=i.gpuAcceleration,s=void 0===n||n,o=i.adaptive,r=void 0===o||o,a=i.roundOffsets,l=void 0===a||a,c={placement:qt(e.placement),variation:he(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:s,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,ue(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,ue(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}};var pe={passive:!0};const me={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,i=t.instance,n=t.options,s=n.scroll,o=void 0===s||s,r=n.resize,a=void 0===r||r,l=$t(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach((function(t){t.addEventListener("scroll",i.update,pe)})),a&&l.addEventListener("resize",i.update,pe),function(){o&&c.forEach((function(t){t.removeEventListener("scroll",i.update,pe)})),a&&l.removeEventListener("resize",i.update,pe)}},data:{}};var ge={left:"right",right:"left",bottom:"top",top:"bottom"};function _e(t){return t.replace(/left|right|bottom|top/g,(function(t){return ge[t]}))}var be={start:"end",end:"start"};function ve(t){return t.replace(/start|end/g,(function(t){return be[t]}))}function ye(t){var e=$t(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function we(t){return Ut(ee(t)).left+ye(t).scrollLeft}function Ae(t){var e=Zt(t),i=e.overflow,n=e.overflowX,s=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+s+n)}function Ee(t){return["html","body","#document"].indexOf(Ht(t))>=0?t.ownerDocument.body:Bt(t)&&Ae(t)?t:Ee(ie(t))}function Te(t,e){var i;void 0===e&&(e=[]);var n=Ee(t),s=n===(null==(i=t.ownerDocument)?void 0:i.body),o=$t(n),r=s?[o].concat(o.visualViewport||[],Ae(n)?n:[]):n,a=e.concat(r);return s?a:a.concat(Te(ie(r)))}function Ce(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Oe(t,e,i){return e===Et?Ce(function(t,e){var i=$t(t),n=ee(t),s=i.visualViewport,o=n.clientWidth,r=n.clientHeight,a=0,l=0;if(s){o=s.width,r=s.height;var c=Yt();(c||!c&&"fixed"===e)&&(a=s.offsetLeft,l=s.offsetTop)}return{width:o,height:r,x:a+we(t),y:l}}(t,i)):Wt(e)?function(t,e){var i=Ut(t,!1,"fixed"===e);return i.top=i.top+t.clientTop,i.left=i.left+t.clientLeft,i.bottom=i.top+t.clientHeight,i.right=i.left+t.clientWidth,i.width=t.clientWidth,i.height=t.clientHeight,i.x=i.left,i.y=i.top,i}(e,i):Ce(function(t){var e,i=ee(t),n=ye(t),s=null==(e=t.ownerDocument)?void 0:e.body,o=Vt(i.scrollWidth,i.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),r=Vt(i.scrollHeight,i.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),a=-n.scrollLeft+we(t),l=-n.scrollTop;return"rtl"===Zt(s||i).direction&&(a+=Vt(i.clientWidth,s?s.clientWidth:0)-o),{width:o,height:r,x:a,y:l}}(ee(t)))}function xe(t){var e,i=t.reference,n=t.element,s=t.placement,o=s?qt(s):null,r=s?he(s):null,a=i.x+i.width/2-n.width/2,l=i.y+i.height/2-n.height/2;switch(o){case pt:e={x:a,y:i.y-n.height};break;case mt:e={x:a,y:i.y+i.height};break;case gt:e={x:i.x+i.width,y:l};break;case _t:e={x:i.x-n.width,y:l};break;default:e={x:i.x,y:i.y}}var c=o?oe(o):null;if(null!=c){var h="y"===c?"height":"width";switch(r){case yt:e[c]=e[c]-(i[h]/2-n[h]/2);break;case wt:e[c]=e[c]+(i[h]/2-n[h]/2)}}return e}function ke(t,e){void 0===e&&(e={});var i=e,n=i.placement,s=void 0===n?t.placement:n,o=i.strategy,r=void 0===o?t.strategy:o,a=i.boundary,l=void 0===a?At:a,c=i.rootBoundary,h=void 0===c?Et:c,d=i.elementContext,u=void 0===d?Tt:d,f=i.altBoundary,p=void 0!==f&&f,m=i.padding,g=void 0===m?0:m,_=ae("number"!=typeof g?g:le(g,vt)),b=u===Tt?Ct:Tt,v=t.rects.popper,y=t.elements[p?b:u],w=function(t,e,i,n){var s="clippingParents"===e?function(t){var e=Te(ie(t)),i=["absolute","fixed"].indexOf(Zt(t).position)>=0&&Bt(t)?se(t):t;return Wt(i)?e.filter((function(t){return Wt(t)&&Jt(t,i)&&"body"!==Ht(t)})):[]}(t):[].concat(e),o=[].concat(s,[i]),r=o[0],a=o.reduce((function(e,i){var s=Oe(t,i,n);return e.top=Vt(s.top,e.top),e.right=Kt(s.right,e.right),e.bottom=Kt(s.bottom,e.bottom),e.left=Vt(s.left,e.left),e}),Oe(t,r,n));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}(Wt(y)?y:y.contextElement||ee(t.elements.popper),l,h,r),A=Ut(t.elements.reference),E=xe({reference:A,element:v,strategy:"absolute",placement:s}),T=Ce(Object.assign({},v,E)),C=u===Tt?T:A,O={top:w.top-C.top+_.top,bottom:C.bottom-w.bottom+_.bottom,left:w.left-C.left+_.left,right:C.right-w.right+_.right},x=t.modifiersData.offset;if(u===Tt&&x){var k=x[s];Object.keys(O).forEach((function(t){var e=[gt,mt].indexOf(t)>=0?1:-1,i=[pt,mt].indexOf(t)>=0?"y":"x";O[t]+=k[i]*e}))}return O}function Le(t,e){void 0===e&&(e={});var i=e,n=i.placement,s=i.boundary,o=i.rootBoundary,r=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,c=void 0===l?xt:l,h=he(n),d=h?a?Ot:Ot.filter((function(t){return he(t)===h})):vt,u=d.filter((function(t){return c.indexOf(t)>=0}));0===u.length&&(u=d);var f=u.reduce((function(e,i){return e[i]=ke(t,{placement:i,boundary:s,rootBoundary:o,padding:r})[qt(i)],e}),{});return Object.keys(f).sort((function(t,e){return f[t]-f[e]}))}const Se={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var s=i.mainAxis,o=void 0===s||s,r=i.altAxis,a=void 0===r||r,l=i.fallbackPlacements,c=i.padding,h=i.boundary,d=i.rootBoundary,u=i.altBoundary,f=i.flipVariations,p=void 0===f||f,m=i.allowedAutoPlacements,g=e.options.placement,_=qt(g),b=l||(_!==g&&p?function(t){if(qt(t)===bt)return[];var e=_e(t);return[ve(t),e,ve(e)]}(g):[_e(g)]),v=[g].concat(b).reduce((function(t,i){return t.concat(qt(i)===bt?Le(e,{placement:i,boundary:h,rootBoundary:d,padding:c,flipVariations:p,allowedAutoPlacements:m}):i)}),[]),y=e.rects.reference,w=e.rects.popper,A=new Map,E=!0,T=v[0],C=0;C<v.length;C++){var O=v[C],x=qt(O),k=he(O)===yt,L=[pt,mt].indexOf(x)>=0,S=L?"width":"height",D=ke(e,{placement:O,boundary:h,rootBoundary:d,altBoundary:u,padding:c}),I=L?k?gt:_t:k?mt:pt;y[S]>w[S]&&(I=_e(I));var N=_e(I),P=[];if(o&&P.push(D[x]<=0),a&&P.push(D[I]<=0,D[N]<=0),P.every((function(t){return t}))){T=O,E=!1;break}A.set(O,P)}if(E)for(var M=function(t){var e=v.find((function(e){var i=A.get(e);if(i)return i.slice(0,t).every((function(t){return t}))}));if(e)return T=e,"break"},j=p?3:1;j>0&&"break"!==M(j);j--);e.placement!==T&&(e.modifiersData[n]._skip=!0,e.placement=T,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function De(t,e,i){return void 0===i&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function Ie(t){return[pt,gt,mt,_t].some((function(e){return t[e]>=0}))}const Ne={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,i=t.name,n=e.rects.reference,s=e.rects.popper,o=e.modifiersData.preventOverflow,r=ke(e,{elementContext:"reference"}),a=ke(e,{altBoundary:!0}),l=De(r,n),c=De(a,s,o),h=Ie(l),d=Ie(c);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":d})}},Pe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,i=t.options,n=t.name,s=i.offset,o=void 0===s?[0,0]:s,r=xt.reduce((function(t,i){return t[i]=function(t,e,i){var n=qt(t),s=[_t,pt].indexOf(n)>=0?-1:1,o="function"==typeof i?i(Object.assign({},e,{placement:t})):i,r=o[0],a=o[1];return r=r||0,a=(a||0)*s,[_t,gt].indexOf(n)>=0?{x:a,y:r}:{x:r,y:a}}(i,e.rects,o),t}),{}),a=r[e.placement],l=a.x,c=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[n]=r}},Me={name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,i=t.name;e.modifiersData[i]=xe({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},je={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,i=t.options,n=t.name,s=i.mainAxis,o=void 0===s||s,r=i.altAxis,a=void 0!==r&&r,l=i.boundary,c=i.rootBoundary,h=i.altBoundary,d=i.padding,u=i.tether,f=void 0===u||u,p=i.tetherOffset,m=void 0===p?0:p,g=ke(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:h}),_=qt(e.placement),b=he(e.placement),v=!b,y=oe(_),w="x"===y?"y":"x",A=e.modifiersData.popperOffsets,E=e.rects.reference,T=e.rects.popper,C="function"==typeof m?m(Object.assign({},e.rects,{placement:e.placement})):m,O="number"==typeof C?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),x=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,k={x:0,y:0};if(A){if(o){var L,S="y"===y?pt:_t,D="y"===y?mt:gt,I="y"===y?"height":"width",N=A[y],P=N+g[S],M=N-g[D],j=f?-T[I]/2:0,F=b===yt?E[I]:T[I],H=b===yt?-T[I]:-E[I],$=e.elements.arrow,W=f&&$?Gt($):{width:0,height:0},B=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},z=B[S],R=B[D],q=re(0,E[I],W[I]),V=v?E[I]/2-j-q-z-O.mainAxis:F-q-z-O.mainAxis,K=v?-E[I]/2+j+q+R+O.mainAxis:H+q+R+O.mainAxis,Q=e.elements.arrow&&se(e.elements.arrow),X=Q?"y"===y?Q.clientTop||0:Q.clientLeft||0:0,Y=null!=(L=null==x?void 0:x[y])?L:0,U=N+K-Y,G=re(f?Kt(P,N+V-Y-X):P,N,f?Vt(M,U):M);A[y]=G,k[y]=G-N}if(a){var J,Z="x"===y?pt:_t,tt="x"===y?mt:gt,et=A[w],it="y"===w?"height":"width",nt=et+g[Z],st=et-g[tt],ot=-1!==[pt,_t].indexOf(_),rt=null!=(J=null==x?void 0:x[w])?J:0,at=ot?nt:et-E[it]-T[it]-rt+O.altAxis,lt=ot?et+E[it]+T[it]-rt-O.altAxis:st,ct=f&&ot?function(t,e,i){var n=re(t,e,i);return n>i?i:n}(at,et,lt):re(f?at:nt,et,f?lt:st);A[w]=ct,k[w]=ct-et}e.modifiersData[n]=k}},requiresIfExists:["offset"]};function Fe(t,e,i){void 0===i&&(i=!1);var n,s,o=Bt(e),r=Bt(e)&&function(t){var e=t.getBoundingClientRect(),i=Qt(e.width)/t.offsetWidth||1,n=Qt(e.height)/t.offsetHeight||1;return 1!==i||1!==n}(e),a=ee(e),l=Ut(t,r,i),c={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(o||!o&&!i)&&(("body"!==Ht(e)||Ae(a))&&(c=(n=e)!==$t(n)&&Bt(n)?{scrollLeft:(s=n).scrollLeft,scrollTop:s.scrollTop}:ye(n)),Bt(e)?((h=Ut(e,!0)).x+=e.clientLeft,h.y+=e.clientTop):a&&(h.x=we(a))),{x:l.left+c.scrollLeft-h.x,y:l.top+c.scrollTop-h.y,width:l.width,height:l.height}}function He(t){var e=new Map,i=new Set,n=[];function s(t){i.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!i.has(t)){var n=e.get(t);n&&s(n)}})),n.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){i.has(t.name)||s(t)})),n}var $e={placement:"bottom",modifiers:[],strategy:"absolute"};function We(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function Be(t){void 0===t&&(t={});var e=t,i=e.defaultModifiers,n=void 0===i?[]:i,s=e.defaultOptions,o=void 0===s?$e:s;return function(t,e,i){void 0===i&&(i=o);var s,r,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},$e,o),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},l=[],c=!1,h={state:a,setOptions:function(i){var s="function"==typeof i?i(a.options):i;d(),a.options=Object.assign({},o,a.options,s),a.scrollParents={reference:Wt(t)?Te(t):t.contextElement?Te(t.contextElement):[],popper:Te(e)};var r,c,u=function(t){var e=He(t);return Ft.reduce((function(t,i){return t.concat(e.filter((function(t){return t.phase===i})))}),[])}((r=[].concat(n,a.options.modifiers),c=r.reduce((function(t,e){var i=t[e.name];return t[e.name]=i?Object.assign({},i,e,{options:Object.assign({},i.options,e.options),data:Object.assign({},i.data,e.data)}):e,t}),{}),Object.keys(c).map((function(t){return c[t]}))));return a.orderedModifiers=u.filter((function(t){return t.enabled})),a.orderedModifiers.forEach((function(t){var e=t.name,i=t.options,n=void 0===i?{}:i,s=t.effect;if("function"==typeof s){var o=s({state:a,name:e,instance:h,options:n});l.push(o||function(){})}})),h.update()},forceUpdate:function(){if(!c){var t=a.elements,e=t.reference,i=t.popper;if(We(e,i)){a.rects={reference:Fe(e,se(i),"fixed"===a.options.strategy),popper:Gt(i)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(t){return a.modifiersData[t.name]=Object.assign({},t.data)}));for(var n=0;n<a.orderedModifiers.length;n++)if(!0!==a.reset){var s=a.orderedModifiers[n],o=s.fn,r=s.options,l=void 0===r?{}:r,d=s.name;"function"==typeof o&&(a=o({state:a,options:l,name:d,instance:h})||a)}else a.reset=!1,n=-1}}},update:(s=function(){return new Promise((function(t){h.forceUpdate(),t(a)}))},function(){return r||(r=new Promise((function(t){Promise.resolve().then((function(){r=void 0,t(s())}))}))),r}),destroy:function(){d(),c=!0}};if(!We(t,e))return h;function d(){l.forEach((function(t){return t()})),l=[]}return h.setOptions(i).then((function(t){!c&&i.onFirstUpdate&&i.onFirstUpdate(t)})),h}}var ze=Be(),Re=Be({defaultModifiers:[me,Me,fe,Rt]}),qe=Be({defaultModifiers:[me,Me,fe,Rt,Pe,Se,je,ce,Ne]});const Ve=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Nt,afterRead:St,afterWrite:jt,applyStyles:Rt,arrow:ce,auto:bt,basePlacements:vt,beforeMain:Dt,beforeRead:kt,beforeWrite:Pt,bottom:mt,clippingParents:At,computeStyles:fe,createPopper:qe,createPopperBase:ze,createPopperLite:Re,detectOverflow:ke,end:wt,eventListeners:me,flip:Se,hide:Ne,left:_t,main:It,modifierPhases:Ft,offset:Pe,placements:xt,popper:Tt,popperGenerator:Be,popperOffsets:Me,preventOverflow:je,read:Lt,reference:Ct,right:gt,start:yt,top:pt,variationPlacements:Ot,viewport:Et,write:Mt},Symbol.toStringTag,{value:"Module"})),Ke="dropdown",Qe="ArrowUp",Xe="ArrowDown",Ye="click.bs.dropdown.data-api",Ue="keydown.bs.dropdown.data-api",Ge="show",Je='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Ze=`${Je}.show`,ti=".dropdown-menu",ei=p()?"top-end":"top-start",ii=p()?"top-start":"top-end",ni=p()?"bottom-end":"bottom-start",si=p()?"bottom-start":"bottom-end",oi=p()?"left-start":"right-start",ri=p()?"right-start":"left-start",ai={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},li={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class ci extends W{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=z.next(this._element,ti)[0]||z.prev(this._element,ti)[0]||z.findOne(ti,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return ai}static get DefaultType(){return li}static get NAME(){return Ke}toggle(){return this._isShown()?this.hide():this.show()}show(){if(l(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!P.trigger(this._element,"show.bs.dropdown",t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const t of[].concat(...document.body.children))P.on(t,"mouseover",h);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Ge),this._element.classList.add(Ge),P.trigger(this._element,"shown.bs.dropdown",t)}}hide(){if(l(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!P.trigger(this._element,"hide.bs.dropdown",t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))P.off(t,"mouseover",h);this._popper&&this._popper.destroy(),this._menu.classList.remove(Ge),this._element.classList.remove(Ge),this._element.setAttribute("aria-expanded","false"),H.removeDataAttribute(this._menu,"popper"),P.trigger(this._element,"hidden.bs.dropdown",t)}}_getConfig(t){if("object"==typeof(t=super._getConfig(t)).reference&&!o(t.reference)&&"function"!=typeof t.reference.getBoundingClientRect)throw new TypeError(`${Ke.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(void 0===Ve)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let t=this._element;"parent"===this._config.reference?t=this._parent:o(this._config.reference)?t=r(this._config.reference):"object"==typeof this._config.reference&&(t=this._config.reference);const e=this._getPopperConfig();this._popper=qe(t,this._menu,e)}_isShown(){return this._menu.classList.contains(Ge)}_getPlacement(){const t=this._parent;if(t.classList.contains("dropend"))return oi;if(t.classList.contains("dropstart"))return ri;if(t.classList.contains("dropup-center"))return"top";if(t.classList.contains("dropdown-center"))return"bottom";const e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return t.classList.contains("dropup")?e?ii:ei:e?si:ni}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(H.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...g(this._config.popperConfig,[t])}}_selectMenuItem({key:t,target:e}){const i=z.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter((t=>a(t)));i.length&&b(i,e,t===Xe,!i.includes(e)).focus()}static jQueryInterface(t){return this.each((function(){const e=ci.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}static clearMenus(t){if(2===t.button||"keyup"===t.type&&"Tab"!==t.key)return;const e=z.find(Ze);for(const i of e){const e=ci.getInstance(i);if(!e||!1===e._config.autoClose)continue;const n=t.composedPath(),s=n.includes(e._menu);if(n.includes(e._element)||"inside"===e._config.autoClose&&!s||"outside"===e._config.autoClose&&s)continue;if(e._menu.contains(t.target)&&("keyup"===t.type&&"Tab"===t.key||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const o={relatedTarget:e._element};"click"===t.type&&(o.clickEvent=t),e._completeHide(o)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),i="Escape"===t.key,n=[Qe,Xe].includes(t.key);if(!n&&!i)return;if(e&&!i)return;t.preventDefault();const s=this.matches(Je)?this:z.prev(this,Je)[0]||z.next(this,Je)[0]||z.findOne(Je,t.delegateTarget.parentNode),o=ci.getOrCreateInstance(s);if(n)return t.stopPropagation(),o.show(),void o._selectMenuItem(t);o._isShown()&&(t.stopPropagation(),o.hide(),s.focus())}}P.on(document,Ue,Je,ci.dataApiKeydownHandler),P.on(document,Ue,ti,ci.dataApiKeydownHandler),P.on(document,Ye,ci.clearMenus),P.on(document,"keyup.bs.dropdown.data-api",ci.clearMenus),P.on(document,Ye,Je,(function(t){t.preventDefault(),ci.getOrCreateInstance(this).toggle()})),m(ci);const hi="show",di="mousedown.bs.backdrop",ui={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},fi={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class pi extends ${constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return ui}static get DefaultType(){return fi}static get NAME(){return"backdrop"}show(t){if(!this._config.isVisible)return void g(t);this._append();const e=this._getElement();this._config.isAnimated&&d(e),e.classList.add(hi),this._emulateAnimation((()=>{g(t)}))}hide(t){this._config.isVisible?(this._getElement().classList.remove(hi),this._emulateAnimation((()=>{this.dispose(),g(t)}))):g(t)}dispose(){this._isAppended&&(P.off(this._element,di),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add("fade"),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=r(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),P.on(t,di,(()=>{g(this._config.clickCallback)})),this._isAppended=!0}_emulateAnimation(t){_(t,this._getElement(),this._config.isAnimated)}}const mi=".bs.focustrap",gi="backward",_i={autofocus:!0,trapElement:null},bi={autofocus:"boolean",trapElement:"element"};class vi extends ${constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return _i}static get DefaultType(){return bi}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),P.off(document,mi),P.on(document,"focusin.bs.focustrap",(t=>this._handleFocusin(t))),P.on(document,"keydown.tab.bs.focustrap",(t=>this._handleKeydown(t))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,P.off(document,mi))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const i=z.focusableChildren(e);0===i.length?e.focus():this._lastTabNavDirection===gi?i[i.length-1].focus():i[0].focus()}_handleKeydown(t){"Tab"===t.key&&(this._lastTabNavDirection=t.shiftKey?gi:"forward")}}const yi=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",wi=".sticky-top",Ai="padding-right",Ei="margin-right";class Ti{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ai,(e=>e+t)),this._setElementAttributes(yi,Ai,(e=>e+t)),this._setElementAttributes(wi,Ei,(e=>e-t))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ai),this._resetElementAttributes(yi,Ai),this._resetElementAttributes(wi,Ei)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,i){const n=this.getWidth();this._applyManipulationCallback(t,(t=>{if(t!==this._element&&window.innerWidth>t.clientWidth+n)return;this._saveInitialAttribute(t,e);const s=window.getComputedStyle(t).getPropertyValue(e);t.style.setProperty(e,`${i(Number.parseFloat(s))}px`)}))}_saveInitialAttribute(t,e){const i=t.style.getPropertyValue(e);i&&H.setDataAttribute(t,e,i)}_resetElementAttributes(t,e){this._applyManipulationCallback(t,(t=>{const i=H.getDataAttribute(t,e);null!==i?(H.removeDataAttribute(t,e),t.style.setProperty(e,i)):t.style.removeProperty(e)}))}_applyManipulationCallback(t,e){if(o(t))e(t);else for(const i of z.find(t,this._element))e(i)}}const Ci=".bs.modal",Oi="hidden.bs.modal",xi="show.bs.modal",ki="modal-open",Li="show",Si="modal-static",Di={backdrop:!0,focus:!0,keyboard:!0},Ii={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Ni extends W{constructor(t,e){super(t,e),this._dialog=z.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Ti,this._addEventListeners()}static get Default(){return Di}static get DefaultType(){return Ii}static get NAME(){return"modal"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||P.trigger(this._element,xi,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(ki),this._adjustDialog(),this._backdrop.show((()=>this._showElement(t))))}hide(){this._isShown&&!this._isTransitioning&&(P.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Li),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated())))}dispose(){P.off(window,Ci),P.off(this._dialog,Ci),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new pi({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new vi({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=z.findOne(".modal-body",this._dialog);e&&(e.scrollTop=0),d(this._element),this._element.classList.add(Li),this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,P.trigger(this._element,"shown.bs.modal",{relatedTarget:t})}),this._dialog,this._isAnimated())}_addEventListeners(){P.on(this._element,"keydown.dismiss.bs.modal",(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())})),P.on(window,"resize.bs.modal",(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),P.on(this._element,"mousedown.dismiss.bs.modal",(t=>{P.one(this._element,"click.dismiss.bs.modal",(e=>{this._element===t.target&&this._element===e.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(ki),this._resetAdjustments(),this._scrollBar.reset(),P.trigger(this._element,Oi)}))}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(P.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._element.style.overflowY;"hidden"===e||this._element.classList.contains(Si)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Si),this._queueCallback((()=>{this._element.classList.remove(Si),this._queueCallback((()=>{this._element.style.overflowY=e}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),i=e>0;if(i&&!t){const t=p()?"paddingLeft":"paddingRight";this._element.style[t]=`${e}px`}if(!i&&t){const t=p()?"paddingRight":"paddingLeft";this._element.style[t]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each((function(){const i=Ni.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===i[t])throw new TypeError(`No method named "${t}"`);i[t](e)}}))}}P.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',(function(t){const e=z.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),P.one(e,xi,(t=>{t.defaultPrevented||P.one(e,Oi,(()=>{a(this)&&this.focus()}))}));const i=z.findOne(".modal.show");i&&Ni.getInstance(i).hide(),Ni.getOrCreateInstance(e).toggle(this)})),R(Ni),m(Ni);const Pi="show",Mi="showing",ji="hiding",Fi=".offcanvas.show",Hi="hidePrevented.bs.offcanvas",$i="hidden.bs.offcanvas",Wi={backdrop:!0,keyboard:!0,scroll:!1},Bi={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class zi extends W{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Wi}static get DefaultType(){return Bi}static get NAME(){return"offcanvas"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||P.trigger(this._element,"show.bs.offcanvas",{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new Ti).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Mi),this._queueCallback((()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(Pi),this._element.classList.remove(Mi),P.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:t})}),this._element,!0))}hide(){this._isShown&&(P.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(ji),this._backdrop.hide(),this._queueCallback((()=>{this._element.classList.remove(Pi,ji),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new Ti).reset(),P.trigger(this._element,$i)}),this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=Boolean(this._config.backdrop);return new pi({className:"offcanvas-backdrop",isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?()=>{"static"!==this._config.backdrop?this.hide():P.trigger(this._element,Hi)}:null})}_initializeFocusTrap(){return new vi({trapElement:this._element})}_addEventListeners(){P.on(this._element,"keydown.dismiss.bs.offcanvas",(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():P.trigger(this._element,Hi))}))}static jQueryInterface(t){return this.each((function(){const e=zi.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}P.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',(function(t){const e=z.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),l(this))return;P.one(e,$i,(()=>{a(this)&&this.focus()}));const i=z.findOne(Fi);i&&i!==e&&zi.getInstance(i).hide(),zi.getOrCreateInstance(e).toggle(this)})),P.on(window,"load.bs.offcanvas.data-api",(()=>{for(const t of z.find(Fi))zi.getOrCreateInstance(t).show()})),P.on(window,"resize.bs.offcanvas",(()=>{for(const t of z.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(t).position&&zi.getOrCreateInstance(t).hide()})),R(zi),m(zi);const Ri={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},qi=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Vi=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Ki=(t,e)=>{const i=t.nodeName.toLowerCase();return e.includes(i)?!qi.has(i)||Boolean(Vi.test(t.nodeValue)):e.filter((t=>t instanceof RegExp)).some((t=>t.test(i)))},Qi={allowList:Ri,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Xi={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Yi={entry:"(string|element|function|null)",selector:"(string|element)"};class Ui extends ${constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return Qi}static get DefaultType(){return Xi}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map((t=>this._resolvePossibleFunction(t))).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[e,i]of Object.entries(this._config.content))this._setContent(t,i,e);const e=t.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&e.classList.add(...i.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,i]of Object.entries(t))super._typeCheckConfig({selector:e,entry:i},Yi)}_setContent(t,e,i){const n=z.findOne(i,t);n&&((e=this._resolvePossibleFunction(e))?o(e)?this._putElementInTemplate(r(e),n):this._config.html?n.innerHTML=this._maybeSanitize(e):n.textContent=e:n.remove())}_maybeSanitize(t){return this._config.sanitize?function(t,e,i){if(!t.length)return t;if(i&&"function"==typeof i)return i(t);const n=(new window.DOMParser).parseFromString(t,"text/html"),s=[].concat(...n.body.querySelectorAll("*"));for(const t of s){const i=t.nodeName.toLowerCase();if(!Object.keys(e).includes(i)){t.remove();continue}const n=[].concat(...t.attributes),s=[].concat(e["*"]||[],e[i]||[]);for(const e of n)Ki(e,s)||t.removeAttribute(e.nodeName)}return n.body.innerHTML}(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return g(t,[this])}_putElementInTemplate(t,e){if(this._config.html)return e.innerHTML="",void e.append(t);e.textContent=t.textContent}}const Gi=new Set(["sanitize","allowList","sanitizeFn"]),Ji="fade",Zi="show",tn=".modal",en="hide.bs.modal",nn="hover",sn="focus",on={AUTO:"auto",TOP:"top",RIGHT:p()?"left":"right",BOTTOM:"bottom",LEFT:p()?"right":"left"},rn={allowList:Ri,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},an={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class ln extends W{constructor(t,e){if(void 0===Ve)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(t,e),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return rn}static get DefaultType(){return an}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),P.off(this._element.closest(tn),en,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const t=P.trigger(this._element,this.constructor.eventName("show")),e=(c(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!e)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:n}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(n.append(i),P.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(i),i.classList.add(Zi),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))P.on(t,"mouseover",h);this._queueCallback((()=>{P.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1}),this.tip,this._isAnimated())}hide(){if(this._isShown()&&!P.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Zi),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))P.off(t,"mouseover",h);this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,this._isHovered=null,this._queueCallback((()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),P.trigger(this._element,this.constructor.eventName("hidden")))}),this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(Ji,Zi),e.classList.add(`bs-${this.constructor.NAME}-auto`);const i=(t=>{do{t+=Math.floor(1e6*Math.random())}while(document.getElementById(t));return t})(this.constructor.NAME).toString();return e.setAttribute("id",i),this._isAnimated()&&e.classList.add(Ji),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new Ui({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ji)}_isShown(){return this.tip&&this.tip.classList.contains(Zi)}_createPopper(t){const e=g(this._config.placement,[this,t,this._element]),i=on[e.toUpperCase()];return qe(this._element,t,this._getPopperConfig(i))}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(t){return g(t,[this._element])}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:t=>{this._getTipElement().setAttribute("data-popper-placement",t.state.placement)}}]};return{...e,...g(this._config.popperConfig,[e])}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if("click"===e)P.on(this._element,this.constructor.eventName("click"),this._config.selector,(t=>{this._initializeOnDelegatedTarget(t).toggle()}));else if("manual"!==e){const t=e===nn?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),i=e===nn?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");P.on(this._element,t,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusin"===t.type?sn:nn]=!0,e._enter()})),P.on(this._element,i,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusout"===t.type?sn:nn]=e._element.contains(t.relatedTarget),e._leave()}))}this._hideModalHandler=()=>{this._element&&this.hide()},P.on(this._element.closest(tn),en,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout((()=>{this._isHovered&&this.show()}),this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout((()=>{this._isHovered||this.hide()}),this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=H.getDataAttributes(this._element);for(const t of Object.keys(e))Gi.has(t)&&delete e[t];return t={...e,..."object"==typeof t&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=!1===t.container?document.body:r(t.container),"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const[e,i]of Object.entries(this._config))this.constructor.Default[e]!==i&&(t[e]=i);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each((function(){const e=ln.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}m(ln);const cn={...ln.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},hn={...ln.DefaultType,content:"(null|string|element|function)"};class dn extends ln{static get Default(){return cn}static get DefaultType(){return hn}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each((function(){const e=dn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}m(dn);const un="click.bs.scrollspy",fn="active",pn="[href]",mn={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},gn={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class _n extends W{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return mn}static get DefaultType(){return gn}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=r(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,"string"==typeof t.threshold&&(t.threshold=t.threshold.split(",").map((t=>Number.parseFloat(t)))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(P.off(this._config.target,un),P.on(this._config.target,un,pn,(t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const i=this._rootElement||window,n=e.offsetTop-this._element.offsetTop;if(i.scrollTo)return void i.scrollTo({top:n,behavior:"smooth"});i.scrollTop=n}})))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver((t=>this._observerCallback(t)),t)}_observerCallback(t){const e=t=>this._targetLinks.get(`#${t.target.id}`),i=t=>{this._previousScrollData.visibleEntryTop=t.target.offsetTop,this._process(e(t))},n=(this._rootElement||document.documentElement).scrollTop,s=n>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=n;for(const o of t){if(!o.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(o));continue}const t=o.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(s&&t){if(i(o),!n)return}else s||t||i(o)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=z.find(pn,this._config.target);for(const e of t){if(!e.hash||l(e))continue;const t=z.findOne(decodeURI(e.hash),this._element);a(t)&&(this._targetLinks.set(decodeURI(e.hash),e),this._observableSections.set(e.hash,t))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(fn),this._activateParents(t),P.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:t}))}_activateParents(t){if(t.classList.contains("dropdown-item"))z.findOne(".dropdown-toggle",t.closest(".dropdown")).classList.add(fn);else for(const e of z.parents(t,".nav, .list-group"))for(const t of z.prev(e,".nav-link, .nav-item > .nav-link, .list-group-item"))t.classList.add(fn)}_clearActiveClass(t){t.classList.remove(fn);const e=z.find("[href].active",t);for(const t of e)t.classList.remove(fn)}static jQueryInterface(t){return this.each((function(){const e=_n.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}P.on(window,"load.bs.scrollspy.data-api",(()=>{for(const t of z.find('[data-bs-spy="scroll"]'))_n.getOrCreateInstance(t)})),m(_n);const bn="ArrowLeft",vn="ArrowRight",yn="ArrowUp",wn="ArrowDown",An="active",En="fade",Tn="show",Cn='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',On=`.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), ${Cn}`;class xn extends W{constructor(t){super(t),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),P.on(this._element,"keydown.bs.tab",(t=>this._keydown(t))))}static get NAME(){return"tab"}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),i=e?P.trigger(e,"hide.bs.tab",{relatedTarget:t}):null;P.trigger(t,"show.bs.tab",{relatedTarget:e}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){t&&(t.classList.add(An),this._activate(z.getElementFromSelector(t)),this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),P.trigger(t,"shown.bs.tab",{relatedTarget:e})):t.classList.add(Tn)}),t,t.classList.contains(En)))}_deactivate(t,e){t&&(t.classList.remove(An),t.blur(),this._deactivate(z.getElementFromSelector(t)),this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),P.trigger(t,"hidden.bs.tab",{relatedTarget:e})):t.classList.remove(Tn)}),t,t.classList.contains(En)))}_keydown(t){if(![bn,vn,yn,wn].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=[vn,wn].includes(t.key),i=b(this._getChildren().filter((t=>!l(t))),t.target,e,!0);i&&(i.focus({preventScroll:!0}),xn.getOrCreateInstance(i).show())}_getChildren(){return z.find(On,this._parent)}_getActiveElem(){return this._getChildren().find((t=>this._elemIsActive(t)))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const t of e)this._setInitialAttributesOnChild(t)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),i=this._getOuterElement(t);t.setAttribute("aria-selected",e),i!==t&&this._setAttributeIfNotExists(i,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=z.getElementFromSelector(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,e){const i=this._getOuterElement(t);if(!i.classList.contains("dropdown"))return;const n=(t,n)=>{const s=z.findOne(t,i);s&&s.classList.toggle(n,e)};n(".dropdown-toggle",An),n(".dropdown-menu",Tn),i.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,i){t.hasAttribute(e)||t.setAttribute(e,i)}_elemIsActive(t){return t.classList.contains(An)}_getInnerElement(t){return t.matches(On)?t:z.findOne(On,t)}_getOuterElement(t){return t.closest(".nav-item, .list-group-item")||t}static jQueryInterface(t){return this.each((function(){const e=xn.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}P.on(document,"click.bs.tab",Cn,(function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),l(this)||xn.getOrCreateInstance(this).show()})),P.on(window,"load.bs.tab",(()=>{for(const t of z.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))xn.getOrCreateInstance(t)})),m(xn);const kn="hide",Ln="show",Sn="showing",Dn={animation:"boolean",autohide:"boolean",delay:"number"},In={animation:!0,autohide:!0,delay:5e3};class Nn extends W{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return In}static get DefaultType(){return Dn}static get NAME(){return"toast"}show(){P.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(kn),d(this._element),this._element.classList.add(Ln,Sn),this._queueCallback((()=>{this._element.classList.remove(Sn),P.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()}),this._element,this._config.animation))}hide(){this.isShown()&&(P.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(Sn),this._queueCallback((()=>{this._element.classList.add(kn),this._element.classList.remove(Sn,Ln),P.trigger(this._element,"hidden.bs.toast")}),this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Ln),super.dispose()}isShown(){return this._element.classList.contains(Ln)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":this._hasMouseInteraction=e;break;case"focusin":case"focusout":this._hasKeyboardInteraction=e}if(e)return void this._clearTimeout();const i=t.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){P.on(this._element,"mouseover.bs.toast",(t=>this._onInteraction(t,!0))),P.on(this._element,"mouseout.bs.toast",(t=>this._onInteraction(t,!1))),P.on(this._element,"focusin.bs.toast",(t=>this._onInteraction(t,!0))),P.on(this._element,"focusout.bs.toast",(t=>this._onInteraction(t,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each((function(){const e=Nn.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}return R(Nn),m(Nn),{Alert:q,Button:K,Carousel:rt,Collapse:ft,Dropdown:ci,Modal:Ni,Offcanvas:zi,Popover:dn,ScrollSpy:_n,Tab:xn,Toast:Nn,Tooltip:ln}}));
function str_replace(b,d,c,f){var k,l,h=[].concat(b),e=[].concat(d),m="[object Array]"===Object.prototype.toString.call(e),n="[object Array]"===Object.prototype.toString.call(c);c=[].concat(c);var a="undefined"!==typeof window?window:global;a.$locutus=a.$locutus||{};a=a.$locutus;a.php=a.php||{};if("object"===typeof b&&"string"===typeof d){var g=d;d=[];for(a=0;a<b.length;a+=1)d[a]=g;e=[].concat(d);m="[object Array]"===Object.prototype.toString.call(e)}"undefined"!==typeof f&&(f.value=0);a=0;for(k=
c.length;a<k;a++)if(""!==c[a])for(b=0,l=h.length;b<l;b++)g=c[a]+"",d=m?void 0!==e[b]?e[b]:"":e[0],c[a]=g.split(h[b]).join(d),"undefined"!==typeof f&&(f.value+=g.split(h[b]).length-1);return n?c:c[0]};

!function e(o,n,t){function r(c,s){if(!n[c]){if(!o[c]){var u="function"==typeof require&&require;if(!s&&u)return u(c,!0);if(i)return i(c,!0);var a=new Error("Cannot find module '"+c+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[c]={exports:{}};o[c][0].call(p.exports,(function(e){return r(o[c][1][e]||e)}),p,p.exports,e,o,n,t)}return n[c].exports}for(var i="function"==typeof require&&require,c=0;c<t.length;c++)r(t[c]);return r}({1:[function(e,o,n){window.docCookies=e("doc-cookies")},{"doc-cookies":2}],2:[function(e,o,n){var t={getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,o,n,t,r,i){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var c="";if(n)switch(n.constructor){case Number:c=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:c="; expires="+n;break;case Date:c="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+c+(r?"; domain="+r:"")+(t?"; path="+t:"")+(i?"; secure":""),!0},removeItem:function(e,o,n){return!!this.hasItem(e)&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(o?"; path="+o:""),!0)},hasItem:function(e){return!(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),o=e.length,n=0;n<o;n++)e[n]=decodeURIComponent(e[n]);return e}};void 0!==o&&void 0!==o.exports&&(o.exports=t)},{}]},{},[1]);

/**
 * @licstart The following is the entire license notice for the
 * JavaScript code in this page
 *
 * Copyright 2023 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend The above is the entire license notice for the
 * JavaScript code in this page
 */
!function webpackUniversalModuleDefinition(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("pdfjs-dist/build/pdf",[],e):"object"==typeof exports?exports["pdfjs-dist/build/pdf"]=e():t["pdfjs-dist/build/pdf"]=t.pdfjsLib=e()}(globalThis,(()=>(()=>{"use strict";var __webpack_modules__=[,(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0;e.assert=function assert(t,e){t||unreachable(e)};e.bytesToString=function bytesToString(t){"object"==typeof t&&void 0!==t?.length||unreachable("Invalid argument for bytesToString");const e=t.length,s=8192;if(e<s)return String.fromCharCode.apply(null,t);const n=[];for(let i=0;i<e;i+=s){const a=Math.min(i+s,e),r=t.subarray(i,a);n.push(String.fromCharCode.apply(null,r))}return n.join("")};e.createValidAbsoluteUrl=function createValidAbsoluteUrl(t,e=null,s=null){if(!t)return null;try{if(s&&"string"==typeof t){if(s.addDefaultProtocol&&t.startsWith("www.")){const e=t.match(/\./g);e?.length>=2&&(t=`http://${t}`)}if(s.tryConvertEncoding)try{t=stringToUTF8String(t)}catch{}}const n=e?new URL(t,e):new URL(t);if(function _isValidProtocol(t){switch(t?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(n))return n}catch{}return null};e.getModificationDate=function getModificationDate(t=new Date){return[t.getUTCFullYear().toString(),(t.getUTCMonth()+1).toString().padStart(2,"0"),t.getUTCDate().toString().padStart(2,"0"),t.getUTCHours().toString().padStart(2,"0"),t.getUTCMinutes().toString().padStart(2,"0"),t.getUTCSeconds().toString().padStart(2,"0")].join("")};e.getVerbosityLevel=function getVerbosityLevel(){return n};e.info=function info(t){n>=s.INFOS&&console.log(`Info: ${t}`)};e.isArrayBuffer=function isArrayBuffer(t){return"object"==typeof t&&void 0!==t?.byteLength};e.isArrayEqual=function isArrayEqual(t,e){if(t.length!==e.length)return!1;for(let s=0,n=t.length;s<n;s++)if(t[s]!==e[s])return!1;return!0};e.normalizeUnicode=function normalizeUnicode(t){if(!o){o=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu;l=new Map([["","t"]])}return t.replaceAll(o,((t,e,s)=>e?e.normalize("NFKC"):l.get(s)))};e.objectFromMap=function objectFromMap(t){const e=Object.create(null);for(const[s,n]of t)e[s]=n;return e};e.objectSize=function objectSize(t){return Object.keys(t).length};e.setVerbosityLevel=function setVerbosityLevel(t){Number.isInteger(t)&&(n=t)};e.shadow=shadow;e.string32=function string32(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)};e.stringToBytes=stringToBytes;e.stringToPDFString=function stringToPDFString(t){if(t[0]>=""){let e;""===t[0]&&""===t[1]?e="utf-16be":""===t[0]&&""===t[1]?e="utf-16le":""===t[0]&&""===t[1]&&""===t[2]&&(e="utf-8");if(e)try{const s=new TextDecoder(e,{fatal:!0}),n=stringToBytes(t);return s.decode(n)}catch(t){warn(`stringToPDFString: "${t}".`)}}const e=[];for(let s=0,n=t.length;s<n;s++){const n=r[t.charCodeAt(s)];e.push(n?String.fromCharCode(n):t.charAt(s))}return e.join("")};e.stringToUTF8String=stringToUTF8String;e.unreachable=unreachable;e.utf8StringToString=function utf8StringToString(t){return unescape(encodeURIComponent(t))};e.warn=warn;e.IDENTITY_MATRIX=[1,0,0,1,0,0];e.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0];e.MAX_IMAGE_SIZE_TO_CACHE=1e7;e.LINE_FACTOR=1.35;e.LINE_DESCENT_FACTOR=.35;e.BASELINE_FACTOR=.25925925925925924;e.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationEditorPrefix="pdfjs_internal_editor_";e.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorParamsType={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};e.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationReplyType={GROUP:"Group",REPLY:"R"};e.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.PageActionEventType={O:"PageOpen",C:"PageClose"};const s={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=s;e.CMapCompressionType={NONE:0,BINARY:1};e.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let n=s.WARNINGS;function warn(t){n>=s.WARNINGS&&console.log(`Warning: ${t}`)}function unreachable(t){throw new Error(t)}function shadow(t,e,s,n=!1){Object.defineProperty(t,e,{value:s,enumerable:!n,configurable:!0,writable:!1});return s}const i=function BaseExceptionClosure(){function BaseException(t,e){this.constructor===BaseException&&unreachable("Cannot initialize BaseException.");this.message=t;this.name=e}BaseException.prototype=new Error;BaseException.constructor=BaseException;return BaseException}();e.BaseException=i;e.PasswordException=class PasswordException extends i{constructor(t,e){super(t,"PasswordException");this.code=e}};e.UnknownErrorException=class UnknownErrorException extends i{constructor(t,e){super(t,"UnknownErrorException");this.details=e}};e.InvalidPDFException=class InvalidPDFException extends i{constructor(t){super(t,"InvalidPDFException")}};e.MissingPDFException=class MissingPDFException extends i{constructor(t){super(t,"MissingPDFException")}};e.UnexpectedResponseException=class UnexpectedResponseException extends i{constructor(t,e){super(t,"UnexpectedResponseException");this.status=e}};e.FormatError=class FormatError extends i{constructor(t){super(t,"FormatError")}};e.AbortException=class AbortException extends i{constructor(t){super(t,"AbortException")}};function stringToBytes(t){"string"!=typeof t&&unreachable("Invalid argument for stringToBytes");const e=t.length,s=new Uint8Array(e);for(let n=0;n<e;++n)s[n]=255&t.charCodeAt(n);return s}e.FeatureTest=class FeatureTest{static get isLittleEndian(){return shadow(this,"isLittleEndian",function isLittleEndian(){const t=new Uint8Array(4);t[0]=1;return 1===new Uint32Array(t.buffer,0,1)[0]}())}static get isEvalSupported(){return shadow(this,"isEvalSupported",function isEvalSupported(){try{new Function("");return!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return shadow(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get platform(){return"undefined"==typeof navigator?shadow(this,"platform",{isWin:!1,isMac:!1}):shadow(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}};const a=[...Array(256).keys()].map((t=>t.toString(16).padStart(2,"0")));e.Util=class Util{static makeHexColor(t,e,s){return`#${a[t]}${a[e]}${a[s]}`}static scaleMinMax(t,e){let s;if(t[0]){if(t[0]<0){s=e[0];e[0]=e[1];e[1]=s}e[0]*=t[0];e[1]*=t[0];if(t[3]<0){s=e[2];e[2]=e[3];e[3]=s}e[2]*=t[3];e[3]*=t[3]}else{s=e[0];e[0]=e[2];e[2]=s;s=e[1];e[1]=e[3];e[3]=s;if(t[1]<0){s=e[2];e[2]=e[3];e[3]=s}e[2]*=t[1];e[3]*=t[1];if(t[2]<0){s=e[0];e[0]=e[1];e[1]=s}e[0]*=t[2];e[1]*=t[2]}e[0]+=t[4];e[1]+=t[4];e[2]+=t[5];e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]}static applyInverseTransform(t,e){const s=e[0]*e[3]-e[1]*e[2];return[(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/s,(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/s]}static getAxialAlignedBoundingBox(t,e){const s=this.applyTransform(t,e),n=this.applyTransform(t.slice(2,4),e),i=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(s[0],n[0],i[0],a[0]),Math.min(s[1],n[1],i[1],a[1]),Math.max(s[0],n[0],i[0],a[0]),Math.max(s[1],n[1],i[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],s=t[0]*e[0]+t[1]*e[2],n=t[0]*e[1]+t[1]*e[3],i=t[2]*e[0]+t[3]*e[2],a=t[2]*e[1]+t[3]*e[3],r=(s+a)/2,o=Math.sqrt((s+a)**2-4*(s*a-i*n))/2,l=r+o||1,c=r-o||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(t){const e=t.slice(0);if(t[0]>t[2]){e[0]=t[2];e[2]=t[0]}if(t[1]>t[3]){e[1]=t[3];e[3]=t[1]}return e}static intersect(t,e){const s=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(s>n)return null;const i=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return i>a?null:[s,i,n,a]}static bezierBoundingBox(t,e,s,n,i,a,r,o){const l=[],c=[[],[]];let h,d,u,p,g,f,m,b;for(let c=0;c<2;++c){if(0===c){d=6*t-12*s+6*i;h=-3*t+9*s-9*i+3*r;u=3*s-3*t}else{d=6*e-12*n+6*a;h=-3*e+9*n-9*a+3*o;u=3*n-3*e}if(Math.abs(h)<1e-12){if(Math.abs(d)<1e-12)continue;p=-u/d;0<p&&p<1&&l.push(p)}else{m=d*d-4*u*h;b=Math.sqrt(m);if(!(m<0)){g=(-d+b)/(2*h);0<g&&g<1&&l.push(g);f=(-d-b)/(2*h);0<f&&f<1&&l.push(f)}}}let A,_=l.length;const y=_;for(;_--;){p=l[_];A=1-p;c[0][_]=A*A*A*t+3*A*A*p*s+3*A*p*p*i+p*p*p*r;c[1][_]=A*A*A*e+3*A*A*p*n+3*A*p*p*a+p*p*p*o}c[0][y]=t;c[1][y]=e;c[0][y+1]=r;c[1][y+1]=o;c[0].length=c[1].length=y+2;return[Math.min(...c[0]),Math.min(...c[1]),Math.max(...c[0]),Math.max(...c[1])]}};const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function stringToUTF8String(t){return decodeURIComponent(escape(t))}e.PromiseCapability=class PromiseCapability{#t=!1;constructor(){this.promise=new Promise(((t,e)=>{this.resolve=e=>{this.#t=!0;t(e)};this.reject=t=>{this.#t=!0;e(t)}}))}get settled(){return this.#t}};let o=null,l=null},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0});exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0;exports.getDocument=getDocument;exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_is_node.isNodeJS?__w_pdfjs_require__(20).NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_is_node.isNodeJS?__w_pdfjs_require__(20).NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_is_node.isNodeJS?__w_pdfjs_require__(20).NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_is_node.isNodeJS?__w_pdfjs_require__(20).NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:t}=__w_pdfjs_require__(21);createPDFNetworkStream=e=>new t(e)}else{const{PDFNetworkStream:t}=__w_pdfjs_require__(24),{PDFFetchStream:e}=__w_pdfjs_require__(25);createPDFNetworkStream=s=>(0,_display_utils.isValidFetchUrl)(s.url)?new e(s):new t(s)}function getDocument(t){"string"==typeof t||t instanceof URL?t={url:t}:(0,_util.isArrayBuffer)(t)&&(t={data:t});if("object"!=typeof t)throw new Error("Invalid parameter in getDocument, need parameter object.");if(!t.url&&!t.data&&!t.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const e=new PDFDocumentLoadingTask,{docId:s}=e,n=t.url?getUrlProp(t.url):null,i=t.data?getDataProp(t.data):null,a=t.httpHeaders||null,r=!0===t.withCredentials,o=t.password??null,l=t.range instanceof PDFDataRangeTransport?t.range:null,c=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let h=t.worker instanceof PDFWorker?t.worker:null;const d=t.verbosity,u="string"!=typeof t.docBaseUrl||(0,_display_utils.isDataScheme)(t.docBaseUrl)?null:t.docBaseUrl,p="string"==typeof t.cMapUrl?t.cMapUrl:null,g=!1!==t.cMapPacked,f=t.CMapReaderFactory||DefaultCMapReaderFactory,m="string"==typeof t.standardFontDataUrl?t.standardFontDataUrl:null,b=t.StandardFontDataFactory||DefaultStandardFontDataFactory,A=!0!==t.stopAtErrors,_=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,y=!1!==t.isEvalSupported,v="boolean"==typeof t.isOffscreenCanvasSupported?t.isOffscreenCanvasSupported:!_is_node.isNodeJS,S=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,E="boolean"==typeof t.disableFontFace?t.disableFontFace:_is_node.isNodeJS,x=!0===t.fontExtraProperties,C=!0===t.enableXfa,w=t.ownerDocument||globalThis.document,T=!0===t.disableRange,P=!0===t.disableStream,F=!0===t.disableAutoFetch,k=!0===t.pdfBug,M=l?l.length:t.length??NaN,R="boolean"==typeof t.useSystemFonts?t.useSystemFonts:!_is_node.isNodeJS&&!E,D="boolean"==typeof t.useWorkerFetch?t.useWorkerFetch:f===_display_utils.DOMCMapReaderFactory&&b===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(p,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(m,document.baseURI),I=t.canvasFactory||new DefaultCanvasFactory({ownerDocument:w}),O=t.filterFactory||new DefaultFilterFactory({docId:s,ownerDocument:w});(0,_util.setVerbosityLevel)(d);const L={canvasFactory:I,filterFactory:O};if(!D){L.cMapReaderFactory=new f({baseUrl:p,isCompressed:g});L.standardFontDataFactory=new b({baseUrl:m})}if(!h){const t={verbosity:d,port:_worker_options.GlobalWorkerOptions.workerPort};h=t.port?PDFWorker.fromPort(t):new PDFWorker(t);e._worker=h}const N={docId:s,apiVersion:"3.8.162",data:i,password:o,disableAutoFetch:F,rangeChunkSize:c,length:M,docBaseUrl:u,enableXfa:C,evaluatorOptions:{maxImageSize:_,disableFontFace:E,ignoreErrors:A,isEvalSupported:y,isOffscreenCanvasSupported:v,canvasMaxAreaInBytes:S,fontExtraProperties:x,useSystemFonts:R,cMapUrl:D?p:null,standardFontDataUrl:D?m:null}},B={ignoreErrors:A,isEvalSupported:y,disableFontFace:E,fontExtraProperties:x,enableXfa:C,ownerDocument:w,disableAutoFetch:F,pdfBug:k,styleElement:null};h.promise.then((function(){if(e.destroyed)throw new Error("Loading aborted");const t=_fetchDocument(h,N),o=new Promise((function(t){let e;l?e=new _transport_stream.PDFDataTransportStream({length:M,initialData:l.initialData,progressiveDone:l.progressiveDone,contentDispositionFilename:l.contentDispositionFilename,disableRange:T,disableStream:P},l):i||(e=createPDFNetworkStream({url:n,length:M,httpHeaders:a,withCredentials:r,rangeChunkSize:c,disableRange:T,disableStream:P}));t(e)}));return Promise.all([t,o]).then((function([t,n]){if(e.destroyed)throw new Error("Loading aborted");const i=new _message_handler.MessageHandler(s,t,h.port),a=new WorkerTransport(i,e,n,B,L);e._transport=a;i.send("Ready",null)}))})).catch(e._capability.reject);return e}async function _fetchDocument(t,e){if(t.destroyed)throw new Error("Worker was destroyed");const s=await t.messageHandler.sendWithPromise("GetDocRequest",e,e.data?[e.data.buffer]:null);if(t.destroyed)throw new Error("Worker was destroyed");return s}function getUrlProp(t){if(t instanceof URL)return t.href;try{return new URL(t,window.location).href}catch{if(_is_node.isNodeJS&&"string"==typeof t)return t}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(t){if(_is_node.isNodeJS&&"undefined"!=typeof Buffer&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if("string"==typeof t)return(0,_util.stringToBytes)(t);if("object"==typeof t&&!isNaN(t?.length)||(0,_util.isArrayBuffer)(t))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#e=0;constructor(){this._capability=new _util.PromiseCapability;this._transport=null;this._worker=null;this.docId="d"+PDFDocumentLoadingTask.#e++;this.destroyed=!1;this.onPassword=null;this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;await(this._transport?.destroy());this._transport=null;if(this._worker){this._worker.destroy();this._worker=null}}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,e,s=!1,n=null){this.length=t;this.initialData=e;this.progressiveDone=s;this.contentDispositionFilename=n;this._rangeListeners=[];this._progressListeners=[];this._progressiveReadListeners=[];this._progressiveDoneListeners=[];this._readyCapability=new _util.PromiseCapability}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const s of this._rangeListeners)s(t,e)}onDataProgress(t,e){this._readyCapability.promise.then((()=>{for(const s of this._progressListeners)s(t,e)}))}onDataProgressiveRead(t){this._readyCapability.promise.then((()=>{for(const e of this._progressiveReadListeners)e(t)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const t of this._progressiveDoneListeners)t()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,e){this._pdfInfo=t;this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#s=null;#n=!1;constructor(t,e,s,n=!1){this._pageIndex=t;this._pageInfo=e;this._transport=s;this._stats=n?new _display_utils.StatTimer:null;this._pdfBug=n;this.commonObjs=s.commonObjs;this.objs=new PDFObjects;this._maybeCleanupAfterRender=!1;this._intentStates=new Map;this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:s=0,offsetY:n=0,dontFlip:i=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:e,offsetX:s,offsetY:n,dontFlip:i})}getAnnotations({intent:t="display"}={}){const e=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:s="display",annotationMode:n=_util.AnnotationMode.ENABLE,transform:i=null,background:a=null,optionalContentConfigPromise:r=null,annotationCanvasMap:o=null,pageColors:l=null,printAnnotationStorage:c=null}){this._stats?.time("Overall");const h=this._transport.getRenderingIntent(s,n,c);this.#n=!1;this.#i();r||(r=this._transport.getOptionalContentConfig());let d=this._intentStates.get(h.cacheKey);if(!d){d=Object.create(null);this._intentStates.set(h.cacheKey,d)}if(d.streamReaderCancelTimeout){clearTimeout(d.streamReaderCancelTimeout);d.streamReaderCancelTimeout=null}const u=!!(h.renderingIntent&_util.RenderingIntentFlag.PRINT);if(!d.displayReadyCapability){d.displayReadyCapability=new _util.PromiseCapability;d.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null};this._stats?.time("Page Request");this._pumpOperatorList(h)}const complete=t=>{d.renderTasks.delete(p);(this._maybeCleanupAfterRender||u)&&(this.#n=!0);this.#a(!u);if(t){p.capability.reject(t);this._abortOperatorList({intentState:d,reason:t instanceof Error?t:new Error(t)})}else p.capability.resolve();this._stats?.timeEnd("Rendering");this._stats?.timeEnd("Overall")},p=new InternalRenderTask({callback:complete,params:{canvasContext:t,viewport:e,transform:i,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:o,operatorList:d.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!u,pdfBug:this._pdfBug,pageColors:l});(d.renderTasks||=new Set).add(p);const g=p.task;Promise.all([d.displayReadyCapability.promise,r]).then((([t,e])=>{if(this.destroyed)complete();else{this._stats?.time("Rendering");p.initializeGraphics({transparency:t,optionalContentConfig:e});p.operatorListChanged()}})).catch(complete);return g}getOperatorList({intent:t="display",annotationMode:e=_util.AnnotationMode.ENABLE,printAnnotationStorage:s=null}={}){const n=this._transport.getRenderingIntent(t,e,s,!0);let i,a=this._intentStates.get(n.cacheKey);if(!a){a=Object.create(null);this._intentStates.set(n.cacheKey,a)}if(!a.opListReadCapability){i=Object.create(null);i.operatorListChanged=function operatorListChanged(){if(a.operatorList.lastChunk){a.opListReadCapability.resolve(a.operatorList);a.renderTasks.delete(i)}};a.opListReadCapability=new _util.PromiseCapability;(a.renderTasks||=new Set).add(i);a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null};this._stats?.time("Page Request");this._pumpOperatorList(n)}return a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===t,disableNormalization:!0===e},{highWaterMark:100,size:t=>t.items.length})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then((t=>_xfa_text.XfaText.textContent(t)));const e=this.streamTextContent(t);return new Promise((function(t,s){const n=e.getReader(),i={items:[],styles:Object.create(null)};!function pump(){n.read().then((function({value:e,done:s}){if(s)t(i);else{Object.assign(i.styles,e.styles);i.items.push(...e.items);pump()}}),s)}()}))}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values()){this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0});if(!e.opListReadCapability)for(const s of e.renderTasks){t.push(s.completed);s.cancel()}}this.objs.clear();this.#n=!1;this.#i();return Promise.all(t)}cleanup(t=!1){this.#n=!0;const e=this.#a(!1);t&&e&&(this._stats&&=new _display_utils.StatTimer);return e}#a(t=!1){this.#i();if(!this.#n||this.destroyed)return!1;if(t){this.#s=setTimeout((()=>{this.#s=null;this.#a(!1)}),DELAYED_CLEANUP_TIMEOUT);return!1}for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;this._intentStates.clear();this.objs.clear();this.#n=!1;return!0}#i(){if(this.#s){clearTimeout(this.#s);this.#s=null}}_startRenderPage(t,e){const s=this._intentStates.get(e);if(s){this._stats?.timeEnd("Page Request");s.displayReadyCapability?.resolve(t)}}_renderPageChunk(t,e){for(let s=0,n=t.length;s<n;s++){e.operatorList.fnArray.push(t.fnArray[s]);e.operatorList.argsArray.push(t.argsArray[s])}e.operatorList.lastChunk=t.lastChunk;e.operatorList.separateAnnots=t.separateAnnots;for(const t of e.renderTasks)t.operatorListChanged();t.lastChunk&&this.#a(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:s}){const{map:n,transfers:i}=s,a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:n},i).getReader(),r=this._intentStates.get(e);r.streamReader=a;const pump=()=>{a.read().then((({value:t,done:e})=>{if(e)r.streamReader=null;else if(!this._transport.destroyed){this._renderPageChunk(t,r);pump()}}),(t=>{r.streamReader=null;if(!this._transport.destroyed){if(r.operatorList){r.operatorList.lastChunk=!0;for(const t of r.renderTasks)t.operatorListChanged();this.#a(!0)}if(r.displayReadyCapability)r.displayReadyCapability.reject(t);else{if(!r.opListReadCapability)throw t;r.opListReadCapability.reject(t)}}}))};pump()}_abortOperatorList({intentState:t,reason:e,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout){clearTimeout(t.streamReaderCancelTimeout);t.streamReaderCancelTimeout=null}if(!s){if(t.renderTasks.size>0)return;if(e instanceof _display_utils.RenderingCancelledException){let s=RENDERING_CANCELLED_TIMEOUT;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay);t.streamReaderCancelTimeout=setTimeout((()=>{t.streamReaderCancelTimeout=null;this._abortOperatorList({intentState:t,reason:e,force:!0})}),s);return}}t.streamReader.cancel(new _util.AbortException(e.message)).catch((()=>{}));t.streamReader=null;if(!this._transport.destroyed){for(const[e,s]of this._intentStates)if(s===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#r=new Set;#o=Promise.resolve();postMessage(t,e){const s={data:structuredClone(t,e?{transfer:e}:null)};this.#o.then((()=>{for(const t of this.#r)t.call(this,s)}))}addEventListener(t,e){this.#r.add(e)}removeEventListener(t,e){this.#r.delete(e)}terminate(){this.#r.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;if(_is_node.isNodeJS&&"function"==typeof require){PDFWorkerUtil.isWorkerDisabled=!0;PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js"}else if("object"==typeof document){const t=document?.currentScript?.src;t&&(PDFWorkerUtil.fallbackWorkerSrc=t.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(t,e){let s;try{s=new URL(t);if(!s.origin||"null"===s.origin)return!1}catch{return!1}const n=new URL(e,s);return s.origin===n.origin};PDFWorkerUtil.createCDNWrapper=function(t){const e=`importScripts("${t}");`;return URL.createObjectURL(new Blob([e]))};class PDFWorker{static#l=new WeakMap;constructor({name:t=null,port:e=null,verbosity:s=(0,_util.getVerbosityLevel)()}={}){if(e&&PDFWorker.#l.has(e))throw new Error("Cannot use more than one PDFWorker per port.");this.name=t;this.destroyed=!1;this.verbosity=s;this._readyCapability=new _util.PromiseCapability;this._port=null;this._webWorker=null;this._messageHandler=null;if(e){PDFWorker.#l.set(e,this);this._initializeFromPort(e)}else this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t;this._messageHandler=new _message_handler.MessageHandler("main","worker",t);this._messageHandler.on("ready",(function(){}));this._readyCapability.resolve();this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:t}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,t)||(t=PDFWorkerUtil.createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t),s=new _message_handler.MessageHandler("main","worker",e),terminateEarly=()=>{e.removeEventListener("error",onWorkerError);s.destroy();e.terminate();this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},onWorkerError=()=>{this._webWorker||terminateEarly()};e.addEventListener("error",onWorkerError);s.on("test",(t=>{e.removeEventListener("error",onWorkerError);if(this.destroyed)terminateEarly();else if(t){this._messageHandler=s;this._port=e;this._webWorker=e;this._readyCapability.resolve();s.send("configure",{verbosity:this.verbosity})}else{this._setupFakeWorker();s.destroy();e.terminate()}}));s.on("ready",(t=>{e.removeEventListener("error",onWorkerError);if(this.destroyed)terminateEarly();else try{sendTest()}catch{this._setupFakeWorker()}}));const sendTest=()=>{const t=new Uint8Array;s.send("test",t,[t.buffer])};sendTest();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){if(!PDFWorkerUtil.isWorkerDisabled){(0,_util.warn)("Setting up fake worker.");PDFWorkerUtil.isWorkerDisabled=!0}PDFWorker._setupFakeWorkerGlobal.then((t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const s="fake"+PDFWorkerUtil.fakeWorkerId++,n=new _message_handler.MessageHandler(s+"_worker",s,e);t.setup(n,e);const i=new _message_handler.MessageHandler(s,s+"_worker",e);this._messageHandler=i;this._readyCapability.resolve();i.send("configure",{verbosity:this.verbosity})})).catch((t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))}))}destroy(){this.destroyed=!0;if(this._webWorker){this._webWorker.terminate();this._webWorker=null}PDFWorker.#l.delete(this._port);this._port=null;if(this._messageHandler){this._messageHandler.destroy();this._messageHandler=null}}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#l.has(t.port)?this.#l.get(t.port):new PDFWorker(t)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc){_is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.');return PDFWorkerUtil.fallbackWorkerSrc}throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&"function"==typeof require){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}await(0,_display_utils.loadScript)(this.workerSrc);return window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#c=new Map;#h=new Map;#d=new Map;constructor(t,e,s,n,i){this.messageHandler=t;this.loadingTask=e;this.commonObjs=new PDFObjects;this.fontLoader=new _font_loader.FontLoader({ownerDocument:n.ownerDocument,styleElement:n.styleElement});this._params=n;this.canvasFactory=i.canvasFactory;this.filterFactory=i.filterFactory;this.cMapReaderFactory=i.cMapReaderFactory;this.standardFontDataFactory=i.standardFontDataFactory;this.destroyed=!1;this.destroyCapability=null;this._passwordCapability=null;this._networkStream=s;this._fullReader=null;this._lastProgress=null;this.downloadInfoCapability=new _util.PromiseCapability;this.setupMessageHandler()}#u(t,e=null){const s=this.#c.get(t);if(s)return s;const n=this.messageHandler.sendWithPromise(t,e);this.#c.set(t,n);return n}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(t,e=_util.AnnotationMode.ENABLE,s=null,n=!1){let i=_util.RenderingIntentFlag.DISPLAY,a=_annotation_storage.SerializableEmpty;switch(t){case"any":i=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":i=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(e){case _util.AnnotationMode.DISABLE:i+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:i+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:i+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE;a=(i&_util.RenderingIntentFlag.PRINT&&s instanceof _annotation_storage.PrintAnnotationStorage?s:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${e}`)}n&&(i+=_util.RenderingIntentFlag.OPLIST);return{renderingIntent:i,cacheKey:`${i}_${a.hash}`,annotationStorageSerializable:a}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0;this.destroyCapability=new _util.PromiseCapability;this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const e of this.#h.values())t.push(e._destroy());this.#h.clear();this.#d.clear();this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);t.push(e);Promise.all(t).then((()=>{this.commonObjs.clear();this.fontLoader.clear();this.#c.clear();this.filterFactory.destroy();this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated."));if(this.messageHandler){this.messageHandler.destroy();this.messageHandler=null}this.destroyCapability.resolve()}),this.destroyCapability.reject);return this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",((t,e)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available.");this._fullReader=this._networkStream.getFullReader();this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}};e.onPull=()=>{this._fullReader.read().then((function({value:t,done:s}){if(s)e.close();else{(0,_util.assert)(t instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer.");e.enqueue(new Uint8Array(t),1,[t])}})).catch((t=>{e.error(t)}))};e.onCancel=t=>{this._fullReader.cancel(t);e.ready.catch((t=>{if(!this.destroyed)throw t}))}}));t.on("ReaderHeadersReady",(t=>{const s=new _util.PromiseCapability,n=this._fullReader;n.headersReady.then((()=>{if(!n.isStreamingSupported||!n.isRangeSupported){this._lastProgress&&e.onProgress?.(this._lastProgress);n.onProgress=t=>{e.onProgress?.({loaded:t.loaded,total:t.total})}}s.resolve({isStreamingSupported:n.isStreamingSupported,isRangeSupported:n.isRangeSupported,contentLength:n.contentLength})}),s.reject);return s.promise}));t.on("GetRangeReader",((t,e)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(t.begin,t.end);if(s){e.onPull=()=>{s.read().then((function({value:t,done:s}){if(s)e.close();else{(0,_util.assert)(t instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer.");e.enqueue(new Uint8Array(t),1,[t])}})).catch((t=>{e.error(t)}))};e.onCancel=t=>{s.cancel(t);e.ready.catch((t=>{if(!this.destroyed)throw t}))}}else e.close()}));t.on("GetDoc",(({pdfInfo:t})=>{this._numPages=t.numPages;this._htmlForXfa=t.htmlForXfa;delete t.htmlForXfa;e._capability.resolve(new PDFDocumentProxy(t,this))}));t.on("DocException",(function(t){let s;switch(t.name){case"PasswordException":s=new _util.PasswordException(t.message,t.code);break;case"InvalidPDFException":s=new _util.InvalidPDFException(t.message);break;case"MissingPDFException":s=new _util.MissingPDFException(t.message);break;case"UnexpectedResponseException":s=new _util.UnexpectedResponseException(t.message,t.status);break;case"UnknownErrorException":s=new _util.UnknownErrorException(t.message,t.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}e._capability.reject(s)}));t.on("PasswordRequest",(t=>{this._passwordCapability=new _util.PromiseCapability;if(e.onPassword){const updatePassword=t=>{t instanceof Error?this._passwordCapability.reject(t):this._passwordCapability.resolve({password:t})};try{e.onPassword(updatePassword,t.code)}catch(t){this._passwordCapability.reject(t)}}else this._passwordCapability.reject(new _util.PasswordException(t.message,t.code));return this._passwordCapability.promise}));t.on("DataLoaded",(t=>{e.onProgress?.({loaded:t.length,total:t.length});this.downloadInfoCapability.resolve(t)}));t.on("StartRenderPage",(t=>{if(this.destroyed)return;this.#h.get(t.pageIndex)._startRenderPage(t.transparency,t.cacheKey)}));t.on("commonobj",(([e,s,n])=>{if(!this.destroyed&&!this.commonObjs.has(e))switch(s){case"Font":const i=this._params;if("error"in n){const t=n.error;(0,_util.warn)(`Error during font loading: ${t}`);this.commonObjs.resolve(e,t);break}const a=i.pdfBug&&globalThis.FontInspector?.enabled?(t,e)=>globalThis.FontInspector.fontAdded(t,e):null,r=new _font_loader.FontFaceObject(n,{isEvalSupported:i.isEvalSupported,disableFontFace:i.disableFontFace,ignoreErrors:i.ignoreErrors,inspectFont:a});this.fontLoader.bind(r).catch((s=>t.sendWithPromise("FontFallback",{id:e}))).finally((()=>{!i.fontExtraProperties&&r.data&&(r.data=null);this.commonObjs.resolve(e,r)}));break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(e,n);break;default:throw new Error(`Got unknown common object type ${s}`)}}));t.on("obj",(([t,e,s,n])=>{if(this.destroyed)return;const i=this.#h.get(e);if(!i.objs.has(t))switch(s){case"Image":i.objs.resolve(t,n);if(n){let t;if(n.bitmap){const{width:e,height:s}=n;t=e*s*4}else t=n.data?.length||0;t>_util.MAX_IMAGE_SIZE_TO_CACHE&&(i._maybeCleanupAfterRender=!0)}break;case"Pattern":i.objs.resolve(t,n);break;default:throw new Error(`Got unknown object type ${s}`)}}));t.on("DocProgress",(t=>{this.destroyed||e.onProgress?.({loaded:t.loaded,total:t.total})}));t.on("FetchBuiltInCMap",(t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(t):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))));t.on("FetchStandardFontData",(t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(t):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter."))))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfers:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally((()=>{this.annotationStorage.resetModified()}))}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,s=this.#d.get(e);if(s)return s;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then((t=>{if(this.destroyed)throw new Error("Transport destroyed");const s=new PDFPageProxy(e,t,this,this._params.pdfBug);this.#h.set(e,s);return s}));this.#d.set(e,n);return n}getPageIndex(t){return"object"!=typeof t||null===t||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#u("GetFieldObjects")}hasJSActions(){return this.#u("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then((t=>new _optional_content_config.OptionalContentConfig(t)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#c.get(t);if(e)return e;const s=this.messageHandler.sendWithPromise(t,null).then((t=>({info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null})));this.#c.set(t,s);return s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#h.values()){if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`)}this.commonObjs.clear();t||this.fontLoader.clear();this.#c.clear();this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:t,enableXfa:e}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t,enableXfa:e})}}class PDFObjects{#p=Object.create(null);#g(t){const e=this.#p[t];return e||(this.#p[t]={capability:new _util.PromiseCapability,data:null})}get(t,e=null){if(e){const s=this.#g(t);s.capability.promise.then((()=>e(s.data)));return null}const s=this.#p[t];if(!s?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const e=this.#p[t];return e?.capability.settled||!1}resolve(t,e=null){const s=this.#g(t);s.data=e;s.capability.resolve()}clear(){for(const t in this.#p){const{data:e}=this.#p[t];e?.bitmap?.close()}this.#p=Object.create(null)}}class RenderTask{#f=null;constructor(t){this.#f=t;this.onContinue=null}get promise(){return this.#f.capability.promise}cancel(t=0){this.#f.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#f.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#f;return t.form||t.canvas&&e?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#m=new WeakSet;constructor({callback:t,params:e,objs:s,commonObjs:n,annotationCanvasMap:i,operatorList:a,pageIndex:r,canvasFactory:o,filterFactory:l,useRequestAnimationFrame:c=!1,pdfBug:h=!1,pageColors:d=null}){this.callback=t;this.params=e;this.objs=s;this.commonObjs=n;this.annotationCanvasMap=i;this.operatorListIdx=null;this.operatorList=a;this._pageIndex=r;this.canvasFactory=o;this.filterFactory=l;this._pdfBug=h;this.pageColors=d;this.running=!1;this.graphicsReadyCallback=null;this.graphicsReady=!1;this._useRequestAnimationFrame=!0===c&&"undefined"!=typeof window;this.cancelled=!1;this.capability=new _util.PromiseCapability;this.task=new RenderTask(this);this._cancelBound=this.cancel.bind(this);this._continueBound=this._continue.bind(this);this._scheduleNextBound=this._scheduleNext.bind(this);this._nextBound=this._next.bind(this);this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#m.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#m.add(this._canvas)}if(this._pdfBug&&globalThis.StepperManager?.enabled){this.stepper=globalThis.StepperManager.create(this._pageIndex);this.stepper.init(this.operatorList);this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint()}const{canvasContext:s,viewport:n,transform:i,background:a}=this.params;this.gfx=new _canvas.CanvasGraphics(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors);this.gfx.beginDrawing({transform:i,viewport:n,transparency:t,background:a});this.operatorListIdx=0;this.graphicsReady=!0;this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1;this.cancelled=!0;this.gfx?.endDrawing();this._canvas&&InternalRenderTask.#m.delete(this._canvas);this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){if(this.graphicsReady){this.stepper?.updateOperatorList(this.operatorList);this.running||this._continue()}else this.graphicsReadyCallback||=this._continueBound}_continue(){this.running=!0;this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame((()=>{this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){if(!this.cancelled){this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper);if(this.operatorListIdx===this.operatorList.argsArray.length){this.running=!1;if(this.operatorList.lastChunk){this.gfx.endDrawing(this.pageColors);this._canvas&&InternalRenderTask.#m.delete(this._canvas);this.callback()}}}}}const version="3.8.162";exports.version=version;const build="2c74323e3";exports.build=build},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=s(1),i=s(4),a=s(8);const r=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=r;class AnnotationStorage{#b=!1;#A=new Map;constructor(){this.onSetModified=null;this.onResetModified=null;this.onAnnotationEditor=null}getValue(t,e){const s=this.#A.get(t);return void 0===s?e:Object.assign(e,s)}getRawValue(t){return this.#A.get(t)}remove(t){this.#A.delete(t);0===this.#A.size&&this.resetModified();if("function"==typeof this.onAnnotationEditor){for(const t of this.#A.values())if(t instanceof i.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(t,e){const s=this.#A.get(t);let n=!1;if(void 0!==s){for(const[t,i]of Object.entries(e))if(s[t]!==i){n=!0;s[t]=i}}else{n=!0;this.#A.set(t,e)}n&&this.#_();e instanceof i.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#A.has(t)}getAll(){return this.#A.size>0?(0,n.objectFromMap)(this.#A):null}setAll(t){for(const[e,s]of Object.entries(t))this.setValue(e,s)}get size(){return this.#A.size}#_(){if(!this.#b){this.#b=!0;"function"==typeof this.onSetModified&&this.onSetModified()}}resetModified(){if(this.#b){this.#b=!1;"function"==typeof this.onResetModified&&this.onResetModified()}}get print(){return new PrintAnnotationStorage(this)}get serializable(){if(0===this.#A.size)return r;const t=new Map,e=new a.MurmurHash3_64,s=[];for(const[n,a]of this.#A){const r=a instanceof i.AnnotationEditor?a.serialize():a;if(r){t.set(n,r);e.update(`${n}:${JSON.stringify(r)}`);r.bitmap&&s.push(r.bitmap)}}return t.size>0?{map:t,hash:e.hexdigest(),transfers:s}:r}}e.AnnotationStorage=AnnotationStorage;class PrintAnnotationStorage extends AnnotationStorage{#y;constructor(t){super();const{map:e,hash:s,transfers:n}=t.serializable,i=structuredClone(e,n?{transfer:n}:null);this.#y={map:i,hash:s,transfers:n}}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#y}}e.PrintAnnotationStorage=PrintAnnotationStorage},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.AnnotationEditor=void 0;var n=s(5),i=s(1);class AnnotationEditor{#v=this.focusin.bind(this);#S=this.focusout.bind(this);#E=!1;#x=!1;#C=!1;_uiManager=null;#w=AnnotationEditor._zIndex++;static _colorManager=new n.ColorManager;static _zIndex=1;constructor(t){this.constructor===AnnotationEditor&&(0,i.unreachable)("Cannot initialize AnnotationEditor.");this.parent=t.parent;this.id=t.id;this.width=this.height=null;this.pageIndex=t.parent.pageIndex;this.name=t.name;this.div=null;this._uiManager=t.uiManager;this.annotationElementId=null;const{rotation:e,rawDims:{pageWidth:s,pageHeight:n,pageX:a,pageY:r}}=this.parent.viewport;this.rotation=e;this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360;this.pageDimensions=[s,n];this.pageTranslation=[a,r];const[o,l]=this.parentDimensions;this.x=t.x/o;this.y=t.y/l;this.isAttachedToDOM=!1;this.deleted=!1}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new FakeEditor({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId;e.deleted=!0;e._uiManager.addToAnnotationStorage(e)}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#w}setParent(t){if(null!==t){this.pageIndex=t.pageIndex;this.pageDimensions=t.pageDimensions}this.parent=t}focusin(t){this.#E?this.#E=!1:this.parent.setSelected(this)}focusout(t){if(!this.isAttachedToDOM)return;const e=t.relatedTarget;if(!e?.closest(`#${this.id}`)){t.preventDefault();this.parent?.isMultipleSelection||this.commitOrRemove()}}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(t){const e=this.parent.div.getBoundingClientRect();this.startX=t.clientX-e.x;this.startY=t.clientY-e.y;t.dataTransfer.setData("text/plain",this.id);t.dataTransfer.effectAllowed="move"}setAt(t,e,s,n){const[i,a]=this.parentDimensions;[s,n]=this.screenToPageTranslation(s,n);this.x=(t+s)/i;this.y=(e+n)/a;this.div.style.left=100*this.x+"%";this.div.style.top=100*this.y+"%"}translate(t,e){const[s,n]=this.parentDimensions;[t,e]=this.screenToPageTranslation(t,e);this.x+=t/s;this.y+=e/n;this.div.style.left=100*this.x+"%";this.div.style.top=100*this.y+"%"}screenToPageTranslation(t,e){switch(this.parentRotation){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:t}=this._uiManager.viewParameters,[e,s]=this.pageDimensions;return[e*t,s*t]}setDims(t,e){const[s,n]=this.parentDimensions;this.div.style.width=100*t/s+"%";this.div.style.height=100*e/n+"%"}fixDims(){const{style:t}=this.div,{height:e,width:s}=t,n=s.endsWith("%"),i=e.endsWith("%");if(n&&i)return;const[a,r]=this.parentDimensions;n||(t.width=100*parseFloat(s)/a+"%");i||(t.height=100*parseFloat(e)/r+"%")}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div");this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360);this.div.className=this.name;this.div.setAttribute("id",this.id);this.div.setAttribute("tabIndex",0);this.setInForeground();this.div.addEventListener("focusin",this.#v);this.div.addEventListener("focusout",this.#S);const[t,e]=this.getInitialTranslation();this.translate(t,e);(0,n.bindEvents)(this,this.div,["dragstart","pointerdown"]);return this.div}pointerdown(t){const{isMac:e}=i.FeatureTest.platform;if(0!==t.button||t.ctrlKey&&e)t.preventDefault();else{t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this);this.#E=!0}}getRect(t,e){const s=this.parentScale,[n,i]=this.pageDimensions,[a,r]=this.pageTranslation,o=t/s,l=e/s,c=this.x*n,h=this.y*i,d=this.width*n,u=this.height*i;switch(this.rotation){case 0:return[c+o+a,i-h-l-u+r,c+o+d+a,i-h-l+r];case 90:return[c+l+a,i-h+o+r,c+l+u+a,i-h+o+d+r];case 180:return[c-o-d+a,i-h+l+r,c-o+a,i-h+l+u+r];case 270:return[c-l-u+a,i-h-o-d+r,c-l+a,i-h-o+r];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[s,n,i,a]=t,r=i-s,o=a-n;switch(this.rotation){case 0:return[s,e-a,r,o];case 90:return[s,e-n,o,r];case 180:return[i,e-n,r,o];case 270:return[i,e-a,o,r];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#C=!0}disableEditMode(){this.#C=!1}isInEditMode(){return this.#C}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#v);this.div?.addEventListener("focusout",this.#S)}serialize(t=!1){(0,i.unreachable)("An editor must be serializable")}static deserialize(t,e,s){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:s});n.rotation=t.rotation;const[i,a]=n.pageDimensions,[r,o,l,c]=n.getRectInCurrentCoords(t.rect,a);n.x=r/i;n.y=o/a;n.width=l/i;n.height=c/a;return n}remove(){this.div.removeEventListener("focusin",this.#v);this.div.removeEventListener("focusout",this.#S);this.isEmpty()||this.commit();this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(t,e){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#x}set isEditing(t){this.#x=t;if(t){this.parent.setSelected(this);this.parent.setActiveEditor(this)}else this.parent.setActiveEditor(null)}}e.AnnotationEditor=AnnotationEditor;class FakeEditor extends AnnotationEditor{constructor(t){super(t);this.annotationElementId=t.annotationElementId;this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0;e.bindEvents=function bindEvents(t,e,s){for(const n of s)e.addEventListener(n,t[n].bind(t))};e.opacityToHex=function opacityToHex(t){return Math.round(Math.min(255,Math.max(1,255*t))).toString(16).padStart(2,"0")};var n=s(1),i=s(6);class IdManager{#T=0;getId(){return`${n.AnnotationEditorPrefix}${this.#T++}`}}class CommandManager{#P=[];#F=!1;#k;#M=-1;constructor(t=128){this.#k=t}add({cmd:t,undo:e,mustExec:s,type:n=NaN,overwriteIfSameType:i=!1,keepUndo:a=!1}){s&&t();if(this.#F)return;const r={cmd:t,undo:e,type:n};if(-1===this.#M){this.#P.length>0&&(this.#P.length=0);this.#M=0;this.#P.push(r);return}if(i&&this.#P[this.#M].type===n){a&&(r.undo=this.#P[this.#M].undo);this.#P[this.#M]=r;return}const o=this.#M+1;if(o===this.#k)this.#P.splice(0,1);else{this.#M=o;o<this.#P.length&&this.#P.splice(o)}this.#P.push(r)}undo(){if(-1!==this.#M){this.#F=!0;this.#P[this.#M].undo();this.#F=!1;this.#M-=1}}redo(){if(this.#M<this.#P.length-1){this.#M+=1;this.#F=!0;this.#P[this.#M].cmd();this.#F=!1}}hasSomethingToUndo(){return-1!==this.#M}hasSomethingToRedo(){return this.#M<this.#P.length-1}destroy(){this.#P=null}}e.CommandManager=CommandManager;class KeyboardManager{constructor(t){this.buffer=[];this.callbacks=new Map;this.allKeys=new Set;const{isMac:e}=n.FeatureTest.platform;for(const[s,n,i=!1]of t)for(const t of s){const s=t.startsWith("mac+");if(e&&s){this.callbacks.set(t.slice(4),{callback:n,bubbles:i});this.allKeys.add(t.split("+").at(-1))}else if(!e&&!s){this.callbacks.set(t,{callback:n,bubbles:i});this.allKeys.add(t.split("+").at(-1))}}}#R(t){t.altKey&&this.buffer.push("alt");t.ctrlKey&&this.buffer.push("ctrl");t.metaKey&&this.buffer.push("meta");t.shiftKey&&this.buffer.push("shift");this.buffer.push(t.key);const e=this.buffer.join("+");this.buffer.length=0;return e}exec(t,e){if(!this.allKeys.has(e.key))return;const s=this.callbacks.get(this.#R(e));if(!s)return;const{callback:n,bubbles:i}=s;n.bind(t)();if(!i){e.stopPropagation();e.preventDefault()}}}e.KeyboardManager=KeyboardManager;class ColorManager{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);(0,i.getColorValues)(t);return(0,n.shadow)(this,"_colors",t)}convert(t){const e=(0,i.getRGB)(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[t,s]of this._colors)if(s.every(((t,s)=>t===e[s])))return ColorManager._colorsMapping.get(t);return e}getHexCode(t){const e=this._colors.get(t);return e?n.Util.makeHexColor(...e):t}}e.ColorManager=ColorManager;class AnnotationEditorUIManager{#D=null;#I=new Map;#O=new Map;#L=null;#N=new CommandManager;#B=0;#j=new Set;#U=null;#H=new Set;#q=null;#W=new IdManager;#G=!1;#z=n.AnnotationEditorType.NONE;#V=new Set;#X=this.copy.bind(this);#$=this.cut.bind(this);#K=this.paste.bind(this);#Y=this.keydown.bind(this);#J=this.onEditingAction.bind(this);#Q=this.onPageChanging.bind(this);#Z=this.onScaleChanging.bind(this);#tt=this.onRotationChanging.bind(this);#et={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#st=null;static get _keyboardManager(){return(0,n.shadow)(this,"_keyboardManager",new KeyboardManager([[["ctrl+a","mac+meta+a"],AnnotationEditorUIManager.prototype.selectAll],[["ctrl+z","mac+meta+z"],AnnotationEditorUIManager.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],AnnotationEditorUIManager.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],AnnotationEditorUIManager.prototype.delete],[["Escape","mac+Escape"],AnnotationEditorUIManager.prototype.unselectAll]]))}constructor(t,e,s){this.#st=t;this.#q=e;this.#q._on("editingaction",this.#J);this.#q._on("pagechanging",this.#Q);this.#q._on("scalechanging",this.#Z);this.#q._on("rotationchanging",this.#tt);this.#L=s;this.viewParameters={realScale:i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#nt();this.#q._off("editingaction",this.#J);this.#q._off("pagechanging",this.#Q);this.#q._off("scalechanging",this.#Z);this.#q._off("rotationchanging",this.#tt);for(const t of this.#O.values())t.destroy();this.#O.clear();this.#I.clear();this.#H.clear();this.#D=null;this.#V.clear();this.#N.destroy()}onPageChanging({pageNumber:t}){this.#B=t-1}focusMainContainer(){this.#st.focus()}addShouldRescale(t){this.#H.add(t)}removeShouldRescale(t){this.#H.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove();this.viewParameters.realScale=t*i.PixelsPerInch.PDF_TO_CSS_UNITS;for(const t of this.#H)t.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove();this.viewParameters.rotation=t}addToAnnotationStorage(t){t.isEmpty()||!this.#L||this.#L.has(t.id)||this.#L.setValue(t.id,t)}#it(){this.#st.addEventListener("keydown",this.#Y)}#nt(){this.#st.removeEventListener("keydown",this.#Y)}#at(){document.addEventListener("copy",this.#X);document.addEventListener("cut",this.#$);document.addEventListener("paste",this.#K)}#rt(){document.removeEventListener("copy",this.#X);document.removeEventListener("cut",this.#$);document.removeEventListener("paste",this.#K)}copy(t){t.preventDefault();this.#D&&this.#D.commitOrRemove();if(!this.hasSelection)return;const e=[];for(const t of this.#V){const s=t.serialize(!0);s&&e.push(s)}0!==e.length&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t);this.delete()}paste(t){t.preventDefault();let e=t.clipboardData.getData("application/pdfjs");if(!e)return;try{e=JSON.parse(e)}catch(t){(0,n.warn)(`paste: "${t.message}".`);return}if(!Array.isArray(e))return;this.unselectAll();const s=this.#O.get(this.#B);try{const t=[];for(const n of e){const e=s.deserialize(n);if(!e)return;t.push(e)}const cmd=()=>{for(const e of t)this.#ot(e);this.#lt(t)},undo=()=>{for(const e of t)e.remove()};this.addCommands({cmd:cmd,undo:undo,mustExec:!0})}catch(t){(0,n.warn)(`paste: "${t.message}".`)}}keydown(t){this.getActive()?.shouldGetKeyboardEvents()||AnnotationEditorUIManager._keyboardManager.exec(this,t)}onEditingAction(t){["undo","redo","delete","selectAll"].includes(t.name)&&this[t.name]()}#ct(t){Object.entries(t).some((([t,e])=>this.#et[t]!==e))&&this.#q.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#et,t)})}#ht(t){this.#q.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){if(t){this.#it();this.#at();this.#ct({isEditing:this.#z!==n.AnnotationEditorType.NONE,isEmpty:this.#dt(),hasSomethingToUndo:this.#N.hasSomethingToUndo(),hasSomethingToRedo:this.#N.hasSomethingToRedo(),hasSelectedEditor:!1})}else{this.#nt();this.#rt();this.#ct({isEditing:!1})}}registerEditorTypes(t){if(!this.#U){this.#U=t;for(const t of this.#U)this.#ht(t.defaultPropertiesToUpdate)}}getId(){return this.#W.getId()}get currentLayer(){return this.#O.get(this.#B)}get currentPageIndex(){return this.#B}addLayer(t){this.#O.set(t.pageIndex,t);this.#G?t.enable():t.disable()}removeLayer(t){this.#O.delete(t.pageIndex)}updateMode(t){this.#z=t;if(t===n.AnnotationEditorType.NONE){this.setEditingState(!1);this.#ut()}else{this.setEditingState(!0);this.#pt();for(const e of this.#O.values())e.updateMode(t)}}updateToolbar(t){t!==this.#z&&this.#q.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if(this.#U){for(const s of this.#V)s.updateParams(t,e);for(const s of this.#U)s.updateDefaultParams(t,e)}}#pt(){if(!this.#G){this.#G=!0;for(const t of this.#O.values())t.enable()}}#ut(){this.unselectAll();if(this.#G){this.#G=!1;for(const t of this.#O.values())t.disable()}}getEditors(t){const e=[];for(const s of this.#I.values())s.pageIndex===t&&e.push(s);return e}getEditor(t){return this.#I.get(t)}addEditor(t){this.#I.set(t.id,t)}removeEditor(t){this.#I.delete(t.id);this.unselect(t);t.annotationElementId&&this.#j.has(t.annotationElementId)||this.#L?.remove(t.id)}addDeletedAnnotationElement(t){this.#j.add(t.annotationElementId);t.deleted=!0}isDeletedAnnotationElement(t){return this.#j.has(t)}removeDeletedAnnotationElement(t){this.#j.delete(t.annotationElementId);t.deleted=!1}#ot(t){const e=this.#O.get(t.pageIndex);e?e.addOrRebuild(t):this.addEditor(t)}setActiveEditor(t){if(this.#D!==t){this.#D=t;t&&this.#ht(t.propertiesToUpdate)}}toggleSelected(t){if(this.#V.has(t)){this.#V.delete(t);t.unselect();this.#ct({hasSelectedEditor:this.hasSelection})}else{this.#V.add(t);t.select();this.#ht(t.propertiesToUpdate);this.#ct({hasSelectedEditor:!0})}}setSelected(t){for(const e of this.#V)e!==t&&e.unselect();this.#V.clear();this.#V.add(t);t.select();this.#ht(t.propertiesToUpdate);this.#ct({hasSelectedEditor:!0})}isSelected(t){return this.#V.has(t)}unselect(t){t.unselect();this.#V.delete(t);this.#ct({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#V.size}undo(){this.#N.undo();this.#ct({hasSomethingToUndo:this.#N.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#dt()})}redo(){this.#N.redo();this.#ct({hasSomethingToUndo:!0,hasSomethingToRedo:this.#N.hasSomethingToRedo(),isEmpty:this.#dt()})}addCommands(t){this.#N.add(t);this.#ct({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#dt()})}#dt(){if(0===this.#I.size)return!0;if(1===this.#I.size)for(const t of this.#I.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();if(!this.hasSelection)return;const t=[...this.#V];this.addCommands({cmd:()=>{for(const e of t)e.remove()},undo:()=>{for(const e of t)this.#ot(e)},mustExec:!0})}commitOrRemove(){this.#D?.commitOrRemove()}#lt(t){this.#V.clear();for(const e of t)if(!e.isEmpty()){this.#V.add(e);e.select()}this.#ct({hasSelectedEditor:!0})}selectAll(){for(const t of this.#V)t.commit();this.#lt(this.#I.values())}unselectAll(){if(this.#D)this.#D.commitOrRemove();else if(0!==this.#V.size){for(const t of this.#V)t.unselect();this.#V.clear();this.#ct({hasSelectedEditor:!1})}}isActive(t){return this.#D===t}getActive(){return this.#D}getMode(){return this.#z}}e.AnnotationEditorUIManager=AnnotationEditorUIManager},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=e.AnnotationPrefix=void 0;e.deprecated=function deprecated(t){console.log("Deprecated API usage: "+t)};e.getColorValues=function getColorValues(t){const e=document.createElement("span");e.style.visibility="hidden";document.body.append(e);for(const s of t.keys()){e.style.color=s;const n=window.getComputedStyle(e).color;t.set(s,getRGB(n))}e.remove()};e.getCurrentTransform=function getCurrentTransform(t){const{a:e,b:s,c:n,d:i,e:a,f:r}=t.getTransform();return[e,s,n,i,a,r]};e.getCurrentTransformInverse=function getCurrentTransformInverse(t){const{a:e,b:s,c:n,d:i,e:a,f:r}=t.getTransform().invertSelf();return[e,s,n,i,a,r]};e.getFilenameFromUrl=function getFilenameFromUrl(t,e=!1){e||([t]=t.split(/[#?]/,1));return t.substring(t.lastIndexOf("/")+1)};e.getPdfFilenameFromUrl=function getPdfFilenameFromUrl(t,e="document.pdf"){if("string"!=typeof t)return e;if(isDataScheme(t)){(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.');return e}const s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(t);let a=s.exec(n[1])||s.exec(n[2])||s.exec(n[3]);if(a){a=a[0];if(a.includes("%"))try{a=s.exec(decodeURIComponent(a))[0]}catch{}}return a||e};e.getRGB=getRGB;e.getXfaPageViewport=function getXfaPageViewport(t,{scale:e=1,rotation:s=0}){const{width:n,height:i}=t.attributes.style,a=[0,0,parseInt(n),parseInt(i)];return new PageViewport({viewBox:a,scale:e,rotation:s})};e.isDataScheme=isDataScheme;e.isPdfFile=function isPdfFile(t){return"string"==typeof t&&/\.pdf$/i.test(t)};e.isValidFetchUrl=isValidFetchUrl;e.loadScript=function loadScript(t,e=!1){return new Promise(((s,n)=>{const i=document.createElement("script");i.src=t;i.onload=function(t){e&&i.remove();s(t)};i.onerror=function(){n(new Error(`Cannot load script at: ${i.src}`))};(document.head||document.documentElement).append(i)}))};e.setLayerDimensions=function setLayerDimensions(t,e,s=!1,n=!0){if(e instanceof PageViewport){const{pageWidth:n,pageHeight:i}=e.rawDims,{style:a}=t,r=`calc(var(--scale-factor) * ${n}px)`,o=`calc(var(--scale-factor) * ${i}px)`;if(s&&e.rotation%180!=0){a.width=o;a.height=r}else{a.width=r;a.height=o}}n&&t.setAttribute("data-main-rotation",e.rotation)};var n=s(7),i=s(1);const a="http://www.w3.org/2000/svg";e.AnnotationPrefix="pdfjs_internal_id_";class PixelsPerInch{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}e.PixelsPerInch=PixelsPerInch;class DOMFilterFactory extends n.BaseFilterFactory{#gt;#ft;#e;#mt;#bt;#At;#_t;#yt;#vt;#St;#T=0;constructor({docId:t,ownerDocument:e=globalThis.document}={}){super();this.#e=t;this.#mt=e}get#Et(){return this.#gt||=new Map}get#xt(){if(!this.#ft){const t=this.#mt.createElement("div"),{style:e}=t;e.visibility="hidden";e.contain="strict";e.width=e.height=0;e.position="absolute";e.top=e.left=0;e.zIndex=-1;const s=this.#mt.createElementNS(a,"svg");s.setAttribute("width",0);s.setAttribute("height",0);this.#ft=this.#mt.createElementNS(a,"defs");t.append(s);s.append(this.#ft);this.#mt.body.append(t)}return this.#ft}addFilter(t){if(!t)return"none";let e,s,n,i,a=this.#Et.get(t);if(a)return a;if(1===t.length){const a=t[0],r=new Array(256);for(let t=0;t<256;t++)r[t]=a[t]/255;i=e=s=n=r.join(",")}else{const[a,r,o]=t,l=new Array(256),c=new Array(256),h=new Array(256);for(let t=0;t<256;t++){l[t]=a[t]/255;c[t]=r[t]/255;h[t]=o[t]/255}e=l.join(",");s=c.join(",");n=h.join(",");i=`${e}${s}${n}`}a=this.#Et.get(i);if(a){this.#Et.set(t,a);return a}const r=`g_${this.#e}_transfer_map_${this.#T++}`,o=`url(#${r})`;this.#Et.set(t,o);this.#Et.set(i,o);const l=this.#Ct(r);this.#wt(e,s,n,l);return o}addHCMFilter(t,e){const s=`${t}-${e}`;if(this.#At===s)return this.#_t;this.#At=s;this.#_t="none";this.#bt?.remove();if(!t||!e)return this.#_t;const n=this.#Tt(t);t=i.Util.makeHexColor(...n);const a=this.#Tt(e);e=i.Util.makeHexColor(...a);this.#xt.style.color="";if("#000000"===t&&"#ffffff"===e||t===e)return this.#_t;const r=new Array(256);for(let t=0;t<=255;t++){const e=t/255;r[t]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const o=r.join(","),l=`g_${this.#e}_hcm_filter`,c=this.#yt=this.#Ct(l);this.#wt(o,o,o,c);this.#Pt(c);const getSteps=(t,e)=>{const s=n[t]/255,i=a[t]/255,r=new Array(e+1);for(let t=0;t<=e;t++)r[t]=s+t/e*(i-s);return r.join(",")};this.#wt(getSteps(0,5),getSteps(1,5),getSteps(2,5),c);this.#_t=`url(#${l})`;return this.#_t}addHighlightHCMFilter(t,e,s,n){const i=`${t}-${e}-${s}-${n}`;if(this.#vt===i)return this.#St;this.#vt=i;this.#St="none";this.#yt?.remove();if(!t||!e)return this.#St;const[a,r]=[t,e].map(this.#Tt.bind(this));let o=Math.round(.2126*a[0]+.7152*a[1]+.0722*a[2]),l=Math.round(.2126*r[0]+.7152*r[1]+.0722*r[2]),[c,h]=[s,n].map(this.#Tt.bind(this));l<o&&([o,l,c,h]=[l,o,h,c]);this.#xt.style.color="";const getSteps=(t,e,s)=>{const n=new Array(256),i=(l-o)/s,a=t/255,r=(e-t)/(255*s);let c=0;for(let t=0;t<=s;t++){const e=Math.round(o+t*i),s=a+t*r;for(let t=c;t<=e;t++)n[t]=s;c=e+1}for(let t=c;t<256;t++)n[t]=n[c-1];return n.join(",")},d=`g_${this.#e}_hcm_highlight_filter`,u=this.#yt=this.#Ct(d);this.#Pt(u);this.#wt(getSteps(c[0],h[0],5),getSteps(c[1],h[1],5),getSteps(c[2],h[2],5),u);this.#St=`url(#${d})`;return this.#St}destroy(t=!1){if(!t||!this.#_t&&!this.#St){if(this.#ft){this.#ft.parentNode.parentNode.remove();this.#ft=null}if(this.#gt){this.#gt.clear();this.#gt=null}this.#T=0}}#Pt(t){const e=this.#mt.createElementNS(a,"feColorMatrix");e.setAttribute("type","matrix");e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0");t.append(e)}#Ct(t){const e=this.#mt.createElementNS(a,"filter");e.setAttribute("color-interpolation-filters","sRGB");e.setAttribute("id",t);this.#xt.append(e);return e}#Ft(t,e,s){const n=this.#mt.createElementNS(a,e);n.setAttribute("type","discrete");n.setAttribute("tableValues",s);t.append(n)}#wt(t,e,s,n){const i=this.#mt.createElementNS(a,"feComponentTransfer");n.append(i);this.#Ft(i,"feFuncR",t);this.#Ft(i,"feFuncG",e);this.#Ft(i,"feFuncB",s)}#Tt(t){this.#xt.style.color=t;return getRGB(getComputedStyle(this.#xt).getPropertyValue("color"))}}e.DOMFilterFactory=DOMFilterFactory;class DOMCanvasFactory extends n.BaseCanvasFactory{constructor({ownerDocument:t=globalThis.document}={}){super();this._document=t}_createCanvas(t,e){const s=this._document.createElement("canvas");s.width=t;s.height=e;return s}}e.DOMCanvasFactory=DOMCanvasFactory;async function fetchData(t,e=!1){if(isValidFetchUrl(t,document.baseURI)){const s=await fetch(t);if(!s.ok)throw new Error(s.statusText);return e?new Uint8Array(await s.arrayBuffer()):(0,i.stringToBytes)(await s.text())}return new Promise(((s,n)=>{const a=new XMLHttpRequest;a.open("GET",t,!0);e&&(a.responseType="arraybuffer");a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(200===a.status||0===a.status){let t;e&&a.response?t=new Uint8Array(a.response):!e&&a.responseText&&(t=(0,i.stringToBytes)(a.responseText));if(t){s(t);return}}n(new Error(a.statusText))}};a.send(null)}))}class DOMCMapReaderFactory extends n.BaseCMapReaderFactory{_fetchData(t,e){return fetchData(t,this.isCompressed).then((t=>({cMapData:t,compressionType:e})))}}e.DOMCMapReaderFactory=DOMCMapReaderFactory;class DOMStandardFontDataFactory extends n.BaseStandardFontDataFactory{_fetchData(t){return fetchData(t,!0)}}e.DOMStandardFontDataFactory=DOMStandardFontDataFactory;class DOMSVGFactory extends n.BaseSVGFactory{_createSVG(t){return document.createElementNS(a,t)}}e.DOMSVGFactory=DOMSVGFactory;class PageViewport{constructor({viewBox:t,scale:e,rotation:s,offsetX:n=0,offsetY:i=0,dontFlip:a=!1}){this.viewBox=t;this.scale=e;this.rotation=s;this.offsetX=n;this.offsetY=i;const r=(t[2]+t[0])/2,o=(t[3]+t[1])/2;let l,c,h,d,u,p,g,f;(s%=360)<0&&(s+=360);switch(s){case 180:l=-1;c=0;h=0;d=1;break;case 90:l=0;c=1;h=1;d=0;break;case 270:l=0;c=-1;h=-1;d=0;break;case 0:l=1;c=0;h=0;d=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}if(a){h=-h;d=-d}if(0===l){u=Math.abs(o-t[1])*e+n;p=Math.abs(r-t[0])*e+i;g=(t[3]-t[1])*e;f=(t[2]-t[0])*e}else{u=Math.abs(r-t[0])*e+n;p=Math.abs(o-t[1])*e+i;g=(t[2]-t[0])*e;f=(t[3]-t[1])*e}this.transform=[l*e,c*e,h*e,d*e,u-l*e*r-h*e*o,p-c*e*r-d*e*o];this.width=g;this.height=f}get rawDims(){const{viewBox:t}=this;return(0,i.shadow)(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:s=this.offsetX,offsetY:n=this.offsetY,dontFlip:i=!1}={}){return new PageViewport({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:s,offsetY:n,dontFlip:i})}convertToViewportPoint(t,e){return i.Util.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=i.Util.applyTransform([t[0],t[1]],this.transform),s=i.Util.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],s[0],s[1]]}convertToPdfPoint(t,e){return i.Util.applyInverseTransform([t,e],this.transform)}}e.PageViewport=PageViewport;class RenderingCancelledException extends i.BaseException{constructor(t,e=0){super(t,"RenderingCancelledException");this.extraDelay=e}}e.RenderingCancelledException=RenderingCancelledException;function isDataScheme(t){const e=t.length;let s=0;for(;s<e&&""===t[s].trim();)s++;return"data:"===t.substring(s,s+5).toLowerCase()}e.StatTimer=class StatTimer{started=Object.create(null);times=[];time(t){t in this.started&&(0,i.warn)(`Timer is already running for ${t}`);this.started[t]=Date.now()}timeEnd(t){t in this.started||(0,i.warn)(`Timer has not been started for ${t}`);this.times.push({name:t,start:this.started[t],end:Date.now()});delete this.started[t]}toString(){const t=[];let e=0;for(const{name:t}of this.times)e=Math.max(t.length,e);for(const{name:s,start:n,end:i}of this.times)t.push(`${s.padEnd(e)} ${i-n}ms\n`);return t.join("")}};function isValidFetchUrl(t,e){try{const{protocol:s}=e?new URL(t,e):new URL(t);return"http:"===s||"https:"===s}catch{return!1}}let r;e.PDFDateString=class PDFDateString{static toDateObject(t){if(!t||"string"!=typeof t)return null;r||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=r.exec(t);if(!e)return null;const s=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let i=parseInt(e[3],10);i=i>=1&&i<=31?i:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(e[6],10);l=l>=0&&l<=59?l:0;const c=e[7]||"Z";let h=parseInt(e[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(e[9],10)||0;d=d>=0&&d<=59?d:0;if("-"===c){a+=h;o+=d}else if("+"===c){a-=h;o-=d}return new Date(Date.UTC(s,n,i,a,o,l))}};function getRGB(t){if(t.startsWith("#")){const e=parseInt(t.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}if(t.startsWith("rgb("))return t.slice(4,-1).split(",").map((t=>parseInt(t)));if(t.startsWith("rgba("))return t.slice(5,-1).split(",").map((t=>parseInt(t))).slice(0,3);(0,i.warn)(`Not a valid color format: "${t}"`);return[0,0,0]}},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=s(1);class BaseFilterFactory{constructor(){this.constructor===BaseFilterFactory&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addHighlightHCMFilter(t,e,s,n){return"none"}destroy(t=!1){}}e.BaseFilterFactory=BaseFilterFactory;class BaseCanvasFactory{constructor(){this.constructor===BaseCanvasFactory&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,e);return{canvas:s,context:s.getContext("2d")}}reset(t,e,s){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=e;t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0;t.canvas.height=0;t.canvas=null;t.context=null}_createCanvas(t,e){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=BaseCanvasFactory;class BaseCMapReaderFactory{constructor({baseUrl:t=null,isCompressed:e=!0}){this.constructor===BaseCMapReaderFactory&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory.");this.baseUrl=t;this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":""),s=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(e,s).catch((t=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)}))}_fetchData(t,e){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=BaseCMapReaderFactory;class BaseStandardFontDataFactory{constructor({baseUrl:t=null}){this.constructor===BaseStandardFontDataFactory&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory.");this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetchData(e).catch((t=>{throw new Error(`Unable to load font data at: ${e}`)}))}_fetchData(t){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=BaseStandardFontDataFactory;class BaseSVGFactory{constructor(){this.constructor===BaseSVGFactory&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(t,e,s=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");n.setAttribute("version","1.1");if(!s){n.setAttribute("width",`${t}px`);n.setAttribute("height",`${e}px`)}n.setAttribute("preserveAspectRatio","none");n.setAttribute("viewBox",`0 0 ${t} ${e}`);return n}createElement(t){if("string"!=typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=BaseSVGFactory},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.MurmurHash3_64=void 0;var n=s(1);const i=3285377520,a=4294901760,r=65535;e.MurmurHash3_64=class MurmurHash3_64{constructor(t){this.h1=t?4294967295&t:i;this.h2=t?4294967295&t:i}update(t){let e,s;if("string"==typeof t){e=new Uint8Array(2*t.length);s=0;for(let n=0,i=t.length;n<i;n++){const i=t.charCodeAt(n);if(i<=255)e[s++]=i;else{e[s++]=i>>>8;e[s++]=255&i}}}else{if(!(0,n.isArrayBuffer)(t))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");e=t.slice();s=e.byteLength}const i=s>>2,o=s-4*i,l=new Uint32Array(e.buffer,0,i);let c=0,h=0,d=this.h1,u=this.h2;const p=3432918353,g=461845907,f=11601,m=13715;for(let t=0;t<i;t++)if(1&t){c=l[t];c=c*p&a|c*f&r;c=c<<15|c>>>17;c=c*g&a|c*m&r;d^=c;d=d<<13|d>>>19;d=5*d+3864292196}else{h=l[t];h=h*p&a|h*f&r;h=h<<15|h>>>17;h=h*g&a|h*m&r;u^=h;u=u<<13|u>>>19;u=5*u+3864292196}c=0;switch(o){case 3:c^=e[4*i+2]<<16;case 2:c^=e[4*i+1]<<8;case 1:c^=e[4*i];c=c*p&a|c*f&r;c=c<<15|c>>>17;c=c*g&a|c*m&r;1&i?d^=c:u^=c}this.h1=d;this.h2=u}hexdigest(){let t=this.h1,e=this.h2;t^=e>>>1;t=3981806797*t&a|36045*t&r;e=4283543511*e&a|(2950163797*(e<<16|t>>>16)&a)>>>16;t^=e>>>1;t=444984403*t&a|60499*t&r;e=3301882366*e&a|(3120437893*(e<<16|t>>>16)&a)>>>16;t^=e>>>1;return(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.FontLoader=e.FontFaceObject=void 0;var n=s(1),i=s(10);e.FontLoader=class FontLoader{#kt=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t;this.nativeFontFaces=new Set;this.styleElement=null;this.loadingRequests=[];this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t);this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t);this._document.fonts.delete(t)}insertRule(t){if(!this.styleElement){this.styleElement=this._document.createElement("style");this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement)}const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear();this.#kt.clear();if(this.styleElement){this.styleElement.remove();this.styleElement=null}}async loadSystemFont(t){if(t&&!this.#kt.has(t.loadedName)){(0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set.");if(this.isFontLoadingAPISupported){const{loadedName:e,src:s,style:i}=t,a=new FontFace(e,s,i);this.addNativeFontFace(a);try{await a.load();this.#kt.add(e)}catch{(0,n.warn)(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`);this.removeNativeFontFace(a)}}else(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;t.attached=!0;if(t.systemFontInfo){await this.loadSystemFont(t.systemFontInfo);return}if(this.isFontLoadingAPISupported){const e=t.createNativeFontFace();if(e){this.addNativeFontFace(e);try{await e.loaded}catch(s){(0,n.warn)(`Failed to load font '${e.family}': '${s}'.`);t.disableFontFace=!0;throw s}}return}const e=t.createFontFaceRule();if(e){this.insertRule(e);if(this.isSyncFontLoadingSupported)return;await new Promise((e=>{const s=this._queueLoadingCallback(e);this._prepareFontLoadEvent(t,s)}))}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return(0,n.shadow)(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;(i.isNodeJS||"undefined"!=typeof navigator&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0);return(0,n.shadow)(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){const{loadingRequests:e}=this,s={done:!1,complete:function completeRequest(){(0,n.assert)(!s.done,"completeRequest() cannot be called twice.");s.done=!0;for(;e.length>0&&e[0].done;){const t=e.shift();setTimeout(t.callback,0)}},callback:t};e.push(s);return s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function int32(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function spliceString(t,e,s,n){return t.substring(0,e)+n+t.substring(e+s)}let s,i;const a=this._document.createElement("canvas");a.width=1;a.height=1;const r=a.getContext("2d");let o=0;const l=`lt${Date.now()}${this.loadTestFontId++}`;let c=this._loadTestFont;c=spliceString(c,976,l.length,l);const h=1482184792;let d=int32(c,16);for(s=0,i=l.length-3;s<i;s+=4)d=d-h+int32(l,s)|0;s<l.length&&(d=d-h+int32(l+"XXX",s)|0);c=spliceString(c,16,4,(0,n.string32)(d));const u=`@font-face {font-family:"${l}";src:${`url(data:font/opentype;base64,${btoa(c)});`}}`;this.insertRule(u);const p=this._document.createElement("div");p.style.visibility="hidden";p.style.width=p.style.height="10px";p.style.position="absolute";p.style.top=p.style.left="0px";for(const e of[t.loadedName,l]){const t=this._document.createElement("span");t.textContent="Hi";t.style.fontFamily=e;p.append(t)}this._document.body.append(p);!function isFontReady(t,e){if(++o>30){(0,n.warn)("Load test font never loaded.");e();return}r.font="30px "+t;r.fillText(".",0,20);r.getImageData(0,0,1,1).data[3]>0?e():setTimeout(isFontReady.bind(null,t,e))}(l,(()=>{p.remove();e.complete()}))}};e.FontFaceObject=class FontFaceObject{constructor(t,{isEvalSupported:e=!0,disableFontFace:s=!1,ignoreErrors:n=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const e in t)this[e]=t[e];this.isEvalSupported=!1!==e;this.disableFontFace=!0===s;this.ignoreErrors=!0===n;this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`);t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});this._inspectFont?.(this);return t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=(0,n.bytesToString)(this.data),e=`url(data:${this.mimetype};base64,${btoa(t)});`;let s;if(this.cssFontInfo){let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`);s=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${e}}`}else s=`@font-face {font-family:"${this.loadedName}";src:${e}}`;this._inspectFont?.(this,e);return s}getPathGenerator(t,e){if(void 0!==this.compiledGlyphs[e])return this.compiledGlyphs[e];let s;try{s=t.get(this.loadedName+"_path_"+e)}catch(t){if(!this.ignoreErrors)throw t;(0,n.warn)(`getPathGenerator - ignoring character: "${t}".`);return this.compiledGlyphs[e]=function(t,e){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const t=[];for(const e of s){const s=void 0!==e.args?e.args.join(","):"";t.push("c.",e.cmd,"(",s,");\n")}return this.compiledGlyphs[e]=new Function("c","size",t.join(""))}return this.compiledGlyphs[e]=function(t,e){for(const n of s){"scale"===n.cmd&&(n.args=[e,-e]);t[n.cmd].apply(t,n.args)}}}}},(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.isNodeJS=void 0;const s=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);e.isNodeJS=s},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.CanvasGraphics=void 0;var n=s(1),i=s(6),a=s(12),r=s(13),o=s(10);const l=4096,c=16;class CachedCanvases{constructor(t){this.canvasFactory=t;this.cache=Object.create(null)}getCanvas(t,e,s){let n;if(void 0!==this.cache[t]){n=this.cache[t];this.canvasFactory.reset(n,e,s)}else{n=this.canvasFactory.create(e,s);this.cache[t]=n}return n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e);delete this.cache[t]}}}function drawImageAtIntegerCoords(t,e,s,n,a,r,o,l,c,h){const[d,u,p,g,f,m]=(0,i.getCurrentTransform)(t);if(0===u&&0===p){const i=o*d+f,b=Math.round(i),A=l*g+m,_=Math.round(A),y=(o+c)*d+f,v=Math.abs(Math.round(y)-b)||1,S=(l+h)*g+m,E=Math.abs(Math.round(S)-_)||1;t.setTransform(Math.sign(d),0,0,Math.sign(g),b,_);t.drawImage(e,s,n,a,r,0,0,v,E);t.setTransform(d,u,p,g,f,m);return[v,E]}if(0===d&&0===g){const i=l*p+f,b=Math.round(i),A=o*u+m,_=Math.round(A),y=(l+h)*p+f,v=Math.abs(Math.round(y)-b)||1,S=(o+c)*u+m,E=Math.abs(Math.round(S)-_)||1;t.setTransform(0,Math.sign(u),Math.sign(p),0,b,_);t.drawImage(e,s,n,a,r,0,0,E,v);t.setTransform(d,u,p,g,f,m);return[E,v]}t.drawImage(e,s,n,a,r,o,l,c,h);return[Math.hypot(d,u)*c,Math.hypot(p,g)*h]}class CanvasExtraState{constructor(t,e){this.alphaIsShape=!1;this.fontSize=0;this.fontSizeScale=1;this.textMatrix=n.IDENTITY_MATRIX;this.textMatrixScale=1;this.fontMatrix=n.FONT_IDENTITY_MATRIX;this.leading=0;this.x=0;this.y=0;this.lineX=0;this.lineY=0;this.charSpacing=0;this.wordSpacing=0;this.textHScale=1;this.textRenderingMode=n.TextRenderingMode.FILL;this.textRise=0;this.fillColor="#000000";this.strokeColor="#000000";this.patternFill=!1;this.fillAlpha=1;this.strokeAlpha=1;this.lineWidth=1;this.activeSMask=null;this.transferMaps="none";this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);t.clipBox=this.clipBox.slice();return t}setCurrentPoint(t,e){this.x=t;this.y=e}updatePathMinMax(t,e,s){[e,s]=n.Util.applyTransform([e,s],t);this.minX=Math.min(this.minX,e);this.minY=Math.min(this.minY,s);this.maxX=Math.max(this.maxX,e);this.maxY=Math.max(this.maxY,s)}updateRectMinMax(t,e){const s=n.Util.applyTransform(e,t),i=n.Util.applyTransform(e.slice(2),t);this.minX=Math.min(this.minX,s[0],i[0]);this.minY=Math.min(this.minY,s[1],i[1]);this.maxX=Math.max(this.maxX,s[0],i[0]);this.maxY=Math.max(this.maxY,s[1],i[1])}updateScalingPathMinMax(t,e){n.Util.scaleMinMax(t,e);this.minX=Math.min(this.minX,e[0]);this.maxX=Math.max(this.maxX,e[1]);this.minY=Math.min(this.minY,e[2]);this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,s,i,a,r,o,l,c,h){const d=n.Util.bezierBoundingBox(e,s,i,a,r,o,l,c);if(h){h[0]=Math.min(h[0],d[0],d[2]);h[1]=Math.max(h[1],d[0],d[2]);h[2]=Math.min(h[2],d[1],d[3]);h[3]=Math.max(h[3],d[1],d[3])}else this.updateRectMinMax(t,d)}getPathBoundingBox(t=a.PathType.FILL,e=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(t===a.PathType.STROKE){e||(0,n.unreachable)("Stroke bounding box must include transform.");const t=n.Util.singularValueDecompose2dScale(e),i=t[0]*this.lineWidth/2,a=t[1]*this.lineWidth/2;s[0]-=i;s[1]-=a;s[2]+=i;s[3]+=a}return s}updateClipFromPath(){const t=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t;this.minX=1/0;this.minY=1/0;this.maxX=0;this.maxY=0}getClippedPathBoundingBox(t=a.PathType.FILL,e=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function putBinaryImageData(t,e){if("undefined"!=typeof ImageData&&e instanceof ImageData){t.putImageData(e,0,0);return}const s=e.height,i=e.width,a=s%c,r=(s-a)/c,o=0===a?r:r+1,l=t.createImageData(i,c);let h,d=0;const u=e.data,p=l.data;let g,f,m,b;if(e.kind===n.ImageKind.GRAYSCALE_1BPP){const e=u.byteLength,s=new Uint32Array(p.buffer,0,p.byteLength>>2),b=s.length,A=i+7>>3,_=4294967295,y=n.FeatureTest.isLittleEndian?4278190080:255;for(g=0;g<o;g++){m=g<r?c:a;h=0;for(f=0;f<m;f++){const t=e-d;let n=0;const a=t>A?i:8*t-7,r=-8&a;let o=0,l=0;for(;n<r;n+=8){l=u[d++];s[h++]=128&l?_:y;s[h++]=64&l?_:y;s[h++]=32&l?_:y;s[h++]=16&l?_:y;s[h++]=8&l?_:y;s[h++]=4&l?_:y;s[h++]=2&l?_:y;s[h++]=1&l?_:y}for(;n<a;n++){if(0===o){l=u[d++];o=128}s[h++]=l&o?_:y;o>>=1}}for(;h<b;)s[h++]=0;t.putImageData(l,0,g*c)}}else if(e.kind===n.ImageKind.RGBA_32BPP){f=0;b=i*c*4;for(g=0;g<r;g++){p.set(u.subarray(d,d+b));d+=b;t.putImageData(l,0,f);f+=c}if(g<o){b=i*a*4;p.set(u.subarray(d,d+b));t.putImageData(l,0,f)}}else{if(e.kind!==n.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${e.kind}`);m=c;b=i*m;for(g=0;g<o;g++){if(g>=r){m=a;b=i*m}h=0;for(f=b;f--;){p[h++]=u[d++];p[h++]=u[d++];p[h++]=u[d++];p[h++]=255}t.putImageData(l,0,g*c)}}}function putBinaryImageMask(t,e){if(e.bitmap){t.drawImage(e.bitmap,0,0);return}const s=e.height,n=e.width,i=s%c,a=(s-i)/c,o=0===i?a:a+1,l=t.createImageData(n,c);let h=0;const d=e.data,u=l.data;for(let e=0;e<o;e++){const s=e<a?c:i;({srcPos:h}=(0,r.convertBlackAndWhiteToRGBA)({src:d,srcPos:h,dest:u,width:n,height:s,nonBlackColor:0}));t.putImageData(l,0,e*c)}}function copyCtxState(t,e){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of s)void 0!==t[n]&&(e[n]=t[n]);if(void 0!==t.setLineDash){e.setLineDash(t.getLineDash());e.lineDashOffset=t.lineDashOffset}}function resetCtxToDefault(t){t.strokeStyle=t.fillStyle="#000000";t.fillRule="nonzero";t.globalAlpha=1;t.lineWidth=1;t.lineCap="butt";t.lineJoin="miter";t.miterLimit=10;t.globalCompositeOperation="source-over";t.font="10px sans-serif";if(void 0!==t.setLineDash){t.setLineDash([]);t.lineDashOffset=0}o.isNodeJS||(t.filter="none")}function composeSMaskBackdrop(t,e,s,n){const i=t.length;for(let a=3;a<i;a+=4){const i=t[a];if(0===i){t[a-3]=e;t[a-2]=s;t[a-1]=n}else if(i<255){const r=255-i;t[a-3]=t[a-3]*i+e*r>>8;t[a-2]=t[a-2]*i+s*r>>8;t[a-1]=t[a-1]*i+n*r>>8}}}function composeSMaskAlpha(t,e,s){const n=t.length;for(let i=3;i<n;i+=4){const n=s?s[t[i]]:t[i];e[i]=e[i]*n*.00392156862745098|0}}function composeSMaskLuminosity(t,e,s){const n=t.length;for(let i=3;i<n;i+=4){const n=77*t[i-3]+152*t[i-2]+28*t[i-1];e[i]=s?e[i]*s[n>>8]>>8:e[i]*n>>16}}function composeSMask(t,e,s,n){const i=n[0],a=n[1],r=n[2]-i,o=n[3]-a;if(0!==r&&0!==o){!function genericComposeSMask(t,e,s,n,i,a,r,o,l,c,h){const d=!!a,u=d?a[0]:0,p=d?a[1]:0,g=d?a[2]:0;let f;f="Luminosity"===i?composeSMaskLuminosity:composeSMaskAlpha;const m=Math.min(n,Math.ceil(1048576/s));for(let i=0;i<n;i+=m){const a=Math.min(m,n-i),b=t.getImageData(o-c,i+(l-h),s,a),A=e.getImageData(o,i+l,s,a);d&&composeSMaskBackdrop(b.data,u,p,g);f(b.data,A.data,r);e.putImageData(A,o,i+l)}}(e.context,s,r,o,e.subtype,e.backdrop,e.transferMap,i,a,e.offsetX,e.offsetY);t.save();t.globalAlpha=1;t.globalCompositeOperation="source-over";t.setTransform(1,0,0,1,0,0);t.drawImage(s.canvas,0,0);t.restore()}}function getImageSmoothingEnabled(t,e){const s=n.Util.singularValueDecompose2dScale(t);s[0]=Math.fround(s[0]);s[1]=Math.fround(s[1]);const a=Math.fround((globalThis.devicePixelRatio||1)*i.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==e?e:s[0]<=a||s[1]<=a}const h=["butt","round","square"],d=["miter","round","bevel"],u={},p={};class CanvasGraphics{constructor(t,e,s,n,i,{optionalContentConfig:a,markedContentStack:r=null},o,l){this.ctx=t;this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height);this.stateStack=[];this.pendingClip=null;this.pendingEOFill=!1;this.res=null;this.xobjs=null;this.commonObjs=e;this.objs=s;this.canvasFactory=n;this.filterFactory=i;this.groupStack=[];this.processingType3=null;this.baseTransform=null;this.baseTransformStack=[];this.groupLevel=0;this.smaskStack=[];this.smaskCounter=0;this.tempSMask=null;this.suspendedCtx=null;this.contentVisible=!0;this.markedContentStack=r||[];this.optionalContentConfig=a;this.cachedCanvases=new CachedCanvases(this.canvasFactory);this.cachedPatterns=new Map;this.annotationCanvasMap=o;this.viewportScale=1;this.outputScaleX=1;this.outputScaleY=1;this.pageColors=l;this._cachedScaleForStroking=[-1,0];this._cachedGetSinglePixelWidth=null;this._cachedBitmapsMap=new Map}getObject(t,e=null){return"string"==typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:s=!1,background:n=null}){const a=this.ctx.canvas.width,r=this.ctx.canvas.height,o=this.ctx.fillStyle;this.ctx.fillStyle=n||"#ffffff";this.ctx.fillRect(0,0,a,r);this.ctx.fillStyle=o;if(s){const t=this.cachedCanvases.getCanvas("transparent",a,r);this.compositeCtx=this.ctx;this.transparentCanvas=t.canvas;this.ctx=t.context;this.ctx.save();this.ctx.transform(...(0,i.getCurrentTransform)(this.compositeCtx))}this.ctx.save();resetCtxToDefault(this.ctx);if(t){this.ctx.transform(...t);this.outputScaleX=t[0];this.outputScaleY=t[0]}this.ctx.transform(...e.transform);this.viewportScale=e.scale;this.baseTransform=(0,i.getCurrentTransform)(this.ctx)}executeOperatorList(t,e,s,i){const a=t.argsArray,r=t.fnArray;let o=e||0;const l=a.length;if(l===o)return o;const c=l-o>10&&"function"==typeof s,h=c?Date.now()+15:0;let d=0;const u=this.commonObjs,p=this.objs;let g;for(;;){if(void 0!==i&&o===i.nextBreakPoint){i.breakIt(o,s);return o}g=r[o];if(g!==n.OPS.dependency)this[g].apply(this,a[o]);else for(const t of a[o]){const e=t.startsWith("g_")?u:p;if(!e.has(t)){e.get(t,s);return o}}o++;if(o===l)return o;if(c&&++d>10){if(Date.now()>h){s();return o}d=0}}}#Mt(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore();if(this.transparentCanvas){this.ctx=this.compositeCtx;this.ctx.save();this.ctx.setTransform(1,0,0,1,0,0);this.ctx.drawImage(this.transparentCanvas,0,0);this.ctx.restore();this.transparentCanvas=null}}endDrawing(){this.#Mt();this.cachedCanvases.clear();this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear();this.#Rt()}#Rt(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==t){const e=this.ctx.filter;this.ctx.filter=t;this.ctx.drawImage(this.ctx.canvas,0,0);this.ctx.filter=e}}}_scaleImage(t,e){const s=t.width,n=t.height;let i,a,r=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=s,c=n,h="prescale1";for(;r>2&&l>1||o>2&&c>1;){let e=l,s=c;if(r>2&&l>1){e=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2);r/=l/e}if(o>2&&c>1){s=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2;o/=c/s}i=this.cachedCanvases.getCanvas(h,e,s);a=i.context;a.clearRect(0,0,e,s);a.drawImage(t,0,0,l,c,0,0,e,s);t=i.canvas;l=e;c=s;h="prescale1"===h?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:c}}_createMaskCanvas(t){const e=this.ctx,{width:s,height:r}=t,o=this.current.fillColor,l=this.current.patternFill,c=(0,i.getCurrentTransform)(e);let h,d,u,p;if((t.bitmap||t.data)&&t.count>1){const e=t.bitmap||t.data.buffer;d=JSON.stringify(l?c:[c.slice(0,4),o]);h=this._cachedBitmapsMap.get(e);if(!h){h=new Map;this._cachedBitmapsMap.set(e,h)}const s=h.get(d);if(s&&!l){return{canvas:s,offsetX:Math.round(Math.min(c[0],c[2])+c[4]),offsetY:Math.round(Math.min(c[1],c[3])+c[5])}}u=s}if(!u){p=this.cachedCanvases.getCanvas("maskCanvas",s,r);putBinaryImageMask(p.context,t)}let g=n.Util.transform(c,[1/s,0,0,-1/r,0,0]);g=n.Util.transform(g,[1,0,0,1,0,-r]);const f=n.Util.applyTransform([0,0],g),m=n.Util.applyTransform([s,r],g),b=n.Util.normalizeRect([f[0],f[1],m[0],m[1]]),A=Math.round(b[2]-b[0])||1,_=Math.round(b[3]-b[1])||1,y=this.cachedCanvases.getCanvas("fillCanvas",A,_),v=y.context,S=Math.min(f[0],m[0]),E=Math.min(f[1],m[1]);v.translate(-S,-E);v.transform(...g);if(!u){u=this._scaleImage(p.canvas,(0,i.getCurrentTransformInverse)(v));u=u.img;h&&l&&h.set(d,u)}v.imageSmoothingEnabled=getImageSmoothingEnabled((0,i.getCurrentTransform)(v),t.interpolate);drawImageAtIntegerCoords(v,u,0,0,u.width,u.height,0,0,s,r);v.globalCompositeOperation="source-in";const x=n.Util.transform((0,i.getCurrentTransformInverse)(v),[1,0,0,1,-S,-E]);v.fillStyle=l?o.getPattern(e,this,x,a.PathType.FILL):o;v.fillRect(0,0,s,r);if(h&&!l){this.cachedCanvases.delete("fillCanvas");h.set(d,y.canvas)}return{canvas:y.canvas,offsetX:Math.round(S),offsetY:Math.round(E)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1);this.current.lineWidth=t;this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=h[t]}setLineJoin(t){this.ctx.lineJoin=d[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const s=this.ctx;if(void 0!==s.setLineDash){s.setLineDash(t);s.lineDashOffset=e}}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,s]of t)switch(e){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s;this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null;this.tempSMask=null;this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(s,t,e);this.suspendedCtx=this.ctx;this.ctx=n.context;const a=this.ctx;a.setTransform(...(0,i.getCurrentTransform)(this.suspendedCtx));copyCtxState(this.suspendedCtx,a);!function mirrorContextOperations(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save;t.__originalRestore=t.restore;t.__originalRotate=t.rotate;t.__originalScale=t.scale;t.__originalTranslate=t.translate;t.__originalTransform=t.transform;t.__originalSetTransform=t.setTransform;t.__originalResetTransform=t.resetTransform;t.__originalClip=t.clip;t.__originalMoveTo=t.moveTo;t.__originalLineTo=t.lineTo;t.__originalBezierCurveTo=t.bezierCurveTo;t.__originalRect=t.rect;t.__originalClosePath=t.closePath;t.__originalBeginPath=t.beginPath;t._removeMirroring=()=>{t.save=t.__originalSave;t.restore=t.__originalRestore;t.rotate=t.__originalRotate;t.scale=t.__originalScale;t.translate=t.__originalTranslate;t.transform=t.__originalTransform;t.setTransform=t.__originalSetTransform;t.resetTransform=t.__originalResetTransform;t.clip=t.__originalClip;t.moveTo=t.__originalMoveTo;t.lineTo=t.__originalLineTo;t.bezierCurveTo=t.__originalBezierCurveTo;t.rect=t.__originalRect;t.closePath=t.__originalClosePath;t.beginPath=t.__originalBeginPath;delete t._removeMirroring};t.save=function ctxSave(){e.save();this.__originalSave()};t.restore=function ctxRestore(){e.restore();this.__originalRestore()};t.translate=function ctxTranslate(t,s){e.translate(t,s);this.__originalTranslate(t,s)};t.scale=function ctxScale(t,s){e.scale(t,s);this.__originalScale(t,s)};t.transform=function ctxTransform(t,s,n,i,a,r){e.transform(t,s,n,i,a,r);this.__originalTransform(t,s,n,i,a,r)};t.setTransform=function ctxSetTransform(t,s,n,i,a,r){e.setTransform(t,s,n,i,a,r);this.__originalSetTransform(t,s,n,i,a,r)};t.resetTransform=function ctxResetTransform(){e.resetTransform();this.__originalResetTransform()};t.rotate=function ctxRotate(t){e.rotate(t);this.__originalRotate(t)};t.clip=function ctxRotate(t){e.clip(t);this.__originalClip(t)};t.moveTo=function(t,s){e.moveTo(t,s);this.__originalMoveTo(t,s)};t.lineTo=function(t,s){e.lineTo(t,s);this.__originalLineTo(t,s)};t.bezierCurveTo=function(t,s,n,i,a,r){e.bezierCurveTo(t,s,n,i,a,r);this.__originalBezierCurveTo(t,s,n,i,a,r)};t.rect=function(t,s,n,i){e.rect(t,s,n,i);this.__originalRect(t,s,n,i)};t.closePath=function(){e.closePath();this.__originalClosePath()};t.beginPath=function(){e.beginPath();this.__originalBeginPath()}}(a,this.suspendedCtx);this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring();copyCtxState(this.ctx,this.suspendedCtx);this.ctx=this.suspendedCtx;this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;if(t){t[0]=Math.floor(t[0]);t[1]=Math.floor(t[1]);t[2]=Math.ceil(t[2]);t[3]=Math.ceil(t[3])}else t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask;composeSMask(this.suspendedCtx,e,this.ctx,t);this.ctx.save();this.ctx.setTransform(1,0,0,1,0,0);this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);this.ctx.restore()}save(){if(this.inSMaskMode){copyCtxState(this.ctx,this.suspendedCtx);this.suspendedCtx.save()}else this.ctx.save();const t=this.current;this.stateStack.push(t);this.current=t.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode();if(0!==this.stateStack.length){this.current=this.stateStack.pop();if(this.inSMaskMode){this.suspendedCtx.restore();copyCtxState(this.suspendedCtx,this.ctx)}else this.ctx.restore();this.checkSMaskState();this.pendingClip=null;this._cachedScaleForStroking[0]=-1;this._cachedGetSinglePixelWidth=null}}transform(t,e,s,n,i,a){this.ctx.transform(t,e,s,n,i,a);this._cachedScaleForStroking[0]=-1;this._cachedGetSinglePixelWidth=null}constructPath(t,e,s){const a=this.ctx,r=this.current;let o,l,c=r.x,h=r.y;const d=(0,i.getCurrentTransform)(a),u=0===d[0]&&0===d[3]||0===d[1]&&0===d[2],p=u?s.slice(0):null;for(let s=0,i=0,g=t.length;s<g;s++)switch(0|t[s]){case n.OPS.rectangle:c=e[i++];h=e[i++];const t=e[i++],s=e[i++],g=c+t,f=h+s;a.moveTo(c,h);if(0===t||0===s)a.lineTo(g,f);else{a.lineTo(g,h);a.lineTo(g,f);a.lineTo(c,f)}u||r.updateRectMinMax(d,[c,h,g,f]);a.closePath();break;case n.OPS.moveTo:c=e[i++];h=e[i++];a.moveTo(c,h);u||r.updatePathMinMax(d,c,h);break;case n.OPS.lineTo:c=e[i++];h=e[i++];a.lineTo(c,h);u||r.updatePathMinMax(d,c,h);break;case n.OPS.curveTo:o=c;l=h;c=e[i+4];h=e[i+5];a.bezierCurveTo(e[i],e[i+1],e[i+2],e[i+3],c,h);r.updateCurvePathMinMax(d,o,l,e[i],e[i+1],e[i+2],e[i+3],c,h,p);i+=6;break;case n.OPS.curveTo2:o=c;l=h;a.bezierCurveTo(c,h,e[i],e[i+1],e[i+2],e[i+3]);r.updateCurvePathMinMax(d,o,l,c,h,e[i],e[i+1],e[i+2],e[i+3],p);c=e[i+2];h=e[i+3];i+=4;break;case n.OPS.curveTo3:o=c;l=h;c=e[i+2];h=e[i+3];a.bezierCurveTo(e[i],e[i+1],c,h,c,h);r.updateCurvePathMinMax(d,o,l,e[i],e[i+1],c,h,c,h,p);i+=4;break;case n.OPS.closePath:a.closePath()}u&&r.updateScalingPathMinMax(d,p);r.setCurrentPoint(c,h)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,s=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha;if(this.contentVisible)if("object"==typeof s&&s?.getPattern){e.save();e.strokeStyle=s.getPattern(e,this,(0,i.getCurrentTransformInverse)(e),a.PathType.STROKE);this.rescaleAndStroke(!1);e.restore()}else this.rescaleAndStroke(!0);t&&this.consumePath(this.current.getClippedPathBoundingBox());e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath();this.stroke()}fill(t=!0){const e=this.ctx,s=this.current.fillColor;let n=!1;if(this.current.patternFill){e.save();e.fillStyle=s.getPattern(e,this,(0,i.getCurrentTransformInverse)(e),a.PathType.FILL);n=!0}const r=this.current.getClippedPathBoundingBox();if(this.contentVisible&&null!==r)if(this.pendingEOFill){e.fill("evenodd");this.pendingEOFill=!1}else e.fill();n&&e.restore();t&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0;this.fill()}fillStroke(){this.fill(!1);this.stroke(!1);this.consumePath()}eoFillStroke(){this.pendingEOFill=!0;this.fillStroke()}closeFillStroke(){this.closePath();this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0;this.closePath();this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=u}eoClip(){this.pendingClip=p}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX;this.current.textMatrixScale=1;this.current.x=this.current.lineX=0;this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(void 0!==t){e.save();e.beginPath();for(const s of t){e.setTransform(...s.transform);e.translate(s.x,s.y);s.addToPath(e,s.fontSize)}e.restore();e.clip();e.beginPath();delete this.pendingTextPaths}else e.beginPath()}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const s=this.commonObjs.get(t),i=this.current;if(!s)throw new Error(`Can't find font for ${t}`);i.fontMatrix=s.fontMatrix||n.FONT_IDENTITY_MATRIX;0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||(0,n.warn)("Invalid font matrix for font "+t);if(e<0){e=-e;i.fontDirection=-1}else i.fontDirection=1;this.current.font=s;this.current.fontSize=e;if(s.isType3Font)return;const a=s.loadedName||"sans-serif",r=s.systemFontInfo?.css||`"${a}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const l=s.italic?"italic":"normal";let c=e;e<16?c=16:e>100&&(c=100);this.current.fontSizeScale=e/c;this.ctx.font=`${l} ${o} ${c}px ${r}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t;this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e);this.moveText(t,e)}setTextMatrix(t,e,s,n,i,a){this.current.textMatrix=[t,e,s,n,i,a];this.current.textMatrixScale=Math.hypot(t,e);this.current.x=this.current.lineX=0;this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,s,a){const r=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,d=c&n.TextRenderingMode.FILL_STROKE_MASK,u=!!(c&n.TextRenderingMode.ADD_TO_PATH_FLAG),p=o.patternFill&&!l.missingFile;let g;(l.disableFontFace||u||p)&&(g=l.getPathGenerator(this.commonObjs,t));if(l.disableFontFace||p){r.save();r.translate(e,s);r.beginPath();g(r,h);a&&r.setTransform(...a);d!==n.TextRenderingMode.FILL&&d!==n.TextRenderingMode.FILL_STROKE||r.fill();d!==n.TextRenderingMode.STROKE&&d!==n.TextRenderingMode.FILL_STROKE||r.stroke();r.restore()}else{d!==n.TextRenderingMode.FILL&&d!==n.TextRenderingMode.FILL_STROKE||r.fillText(t,e,s);d!==n.TextRenderingMode.STROKE&&d!==n.TextRenderingMode.FILL_STROKE||r.strokeText(t,e,s)}if(u){(this.pendingTextPaths||=[]).push({transform:(0,i.getCurrentTransform)(r),x:e,y:s,fontSize:h,addToPath:g})}}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1);t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let s=!1;for(let t=3;t<e.length;t+=4)if(e[t]>0&&e[t]<255){s=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",s)}showText(t){const e=this.current,s=e.font;if(s.isType3Font)return this.showType3Text(t);const r=e.fontSize;if(0===r)return;const o=this.ctx,l=e.fontSizeScale,c=e.charSpacing,h=e.wordSpacing,d=e.fontDirection,u=e.textHScale*d,p=t.length,g=s.vertical,f=g?1:-1,m=s.defaultVMetrics,b=r*e.fontMatrix[0],A=e.textRenderingMode===n.TextRenderingMode.FILL&&!s.disableFontFace&&!e.patternFill;o.save();o.transform(...e.textMatrix);o.translate(e.x,e.y+e.textRise);d>0?o.scale(u,-1):o.scale(u,1);let _;if(e.patternFill){o.save();const t=e.fillColor.getPattern(o,this,(0,i.getCurrentTransformInverse)(o),a.PathType.FILL);_=(0,i.getCurrentTransform)(o);o.restore();o.fillStyle=t}let y=e.lineWidth;const v=e.textMatrixScale;if(0===v||0===y){const t=e.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;t!==n.TextRenderingMode.STROKE&&t!==n.TextRenderingMode.FILL_STROKE||(y=this.getSinglePixelWidth())}else y/=v;if(1!==l){o.scale(l,l);y/=l}o.lineWidth=y;if(s.isInvalidPDFjsFont){const s=[];let n=0;for(const e of t){s.push(e.unicode);n+=e.width}o.fillText(s.join(""),0,0);e.x+=n*b*u;o.restore();this.compose();return}let S,E=0;for(S=0;S<p;++S){const e=t[S];if("number"==typeof e){E+=f*e*r/1e3;continue}let n=!1;const i=(e.isSpace?h:0)+c,a=e.fontChar,u=e.accent;let p,y,v,x=e.width;if(g){const t=e.vmetric||m,s=-(e.vmetric?t[1]:.5*x)*b,n=t[2]*b;x=t?-t[0]:x;p=s/l;y=(E+n)/l}else{p=E/l;y=0}if(s.remeasure&&x>0){const t=1e3*o.measureText(a).width/r*l;if(x<t&&this.isFontSubpixelAAEnabled){const e=x/t;n=!0;o.save();o.scale(e,1);p/=e}else x!==t&&(p+=(x-t)/2e3*r/l)}if(this.contentVisible&&(e.isInFont||s.missingFile))if(A&&!u)o.fillText(a,p,y);else{this.paintChar(a,p,y,_);if(u){const t=p+r*u.offset.x/l,e=y-r*u.offset.y/l;this.paintChar(u.fontChar,t,e,_)}}v=g?x*b-i*d:x*b+i*d;E+=v;n&&o.restore()}g?e.y-=E:e.x+=E*u;o.restore();this.compose()}showType3Text(t){const e=this.ctx,s=this.current,i=s.font,a=s.fontSize,r=s.fontDirection,o=i.vertical?1:-1,l=s.charSpacing,c=s.wordSpacing,h=s.textHScale*r,d=s.fontMatrix||n.FONT_IDENTITY_MATRIX,u=t.length;let p,g,f,m;if(!(s.textRenderingMode===n.TextRenderingMode.INVISIBLE)&&0!==a){this._cachedScaleForStroking[0]=-1;this._cachedGetSinglePixelWidth=null;e.save();e.transform(...s.textMatrix);e.translate(s.x,s.y);e.scale(h,r);for(p=0;p<u;++p){g=t[p];if("number"==typeof g){m=o*g*a/1e3;this.ctx.translate(m,0);s.x+=m*h;continue}const r=(g.isSpace?c:0)+l,u=i.charProcOperatorList[g.operatorListId];if(!u){(0,n.warn)(`Type3 character "${g.operatorListId}" is not available.`);continue}if(this.contentVisible){this.processingType3=g;this.save();e.scale(a,a);e.transform(...d);this.executeOperatorList(u);this.restore()}f=n.Util.applyTransform([g.width,0],d)[0]*a+r;e.translate(f,0);s.x+=f*h}e.restore();this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,s,n,i,a){this.ctx.rect(s,n,i-s,a-n);this.ctx.clip();this.endPath()}getColorN_Pattern(t){let e;if("TilingPattern"===t[0]){const s=t[1],n=this.baseTransform||(0,i.getCurrentTransform)(this.ctx),r={createCanvasGraphics:t=>new CanvasGraphics(t,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new a.TilingPattern(t,s,this.ctx,r,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments);this.current.patternFill=!0}setStrokeRGBColor(t,e,s){const i=n.Util.makeHexColor(t,e,s);this.ctx.strokeStyle=i;this.current.strokeColor=i}setFillRGBColor(t,e,s){const i=n.Util.makeHexColor(t,e,s);this.ctx.fillStyle=i;this.current.fillColor=i;this.current.patternFill=!1}_getPattern(t,e=null){let s;if(this.cachedPatterns.has(t))s=this.cachedPatterns.get(t);else{s=(0,a.getShadingPattern)(this.getObject(t));this.cachedPatterns.set(t,s)}e&&(s.matrix=e);return s}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const s=this._getPattern(t);e.fillStyle=s.getPattern(e,this,(0,i.getCurrentTransformInverse)(e),a.PathType.SHADING);const r=(0,i.getCurrentTransformInverse)(e);if(r){const{width:t,height:s}=e.canvas,[i,a,o,l]=n.Util.getAxialAlignedBoundingBox([0,0,t,s],r);this.ctx.fillRect(i,a,o-i,l-a)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox());this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible){this.save();this.baseTransformStack.push(this.baseTransform);Array.isArray(t)&&6===t.length&&this.transform(...t);this.baseTransform=(0,i.getCurrentTransform)(this.ctx);if(e){const t=e[2]-e[0],s=e[3]-e[1];this.ctx.rect(e[0],e[1],t,s);this.current.updateRectMinMax((0,i.getCurrentTransform)(this.ctx),e);this.clip();this.endPath()}}}paintFormXObjectEnd(){if(this.contentVisible){this.restore();this.baseTransform=this.baseTransformStack.pop()}}beginGroup(t){if(!this.contentVisible)return;this.save();if(this.inSMaskMode){this.endSMaskMode();this.current.activeSMask=null}const e=this.ctx;t.isolated||(0,n.info)("TODO: Support non-isolated groups.");t.knockout&&(0,n.warn)("Knockout groups not supported.");const s=(0,i.getCurrentTransform)(e);t.matrix&&e.transform(...t.matrix);if(!t.bbox)throw new Error("Bounding box is required.");let a=n.Util.getAxialAlignedBoundingBox(t.bbox,(0,i.getCurrentTransform)(e));const r=[0,0,e.canvas.width,e.canvas.height];a=n.Util.intersect(a,r)||[0,0,0,0];const o=Math.floor(a[0]),c=Math.floor(a[1]);let h=Math.max(Math.ceil(a[2])-o,1),d=Math.max(Math.ceil(a[3])-c,1),u=1,p=1;if(h>l){u=h/l;h=l}if(d>l){p=d/l;d=l}this.current.startNewPathAndClipBox([0,0,h,d]);let g="groupAt"+this.groupLevel;t.smask&&(g+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(g,h,d),m=f.context;m.scale(1/u,1/p);m.translate(-o,-c);m.transform(...s);if(t.smask)this.smaskStack.push({canvas:f.canvas,context:m,offsetX:o,offsetY:c,scaleX:u,scaleY:p,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null});else{e.setTransform(1,0,0,1,0,0);e.translate(o,c);e.scale(u,p);e.save()}copyCtxState(e,m);this.ctx=m;this.setGState([["BM","source-over"],["ca",1],["CA",1]]);this.groupStack.push(e);this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,s=this.groupStack.pop();this.ctx=s;this.ctx.imageSmoothingEnabled=!1;if(t.smask){this.tempSMask=this.smaskStack.pop();this.restore()}else{this.ctx.restore();const t=(0,i.getCurrentTransform)(this.ctx);this.restore();this.ctx.save();this.ctx.setTransform(...t);const s=n.Util.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],t);this.ctx.drawImage(e.canvas,0,0);this.ctx.restore();this.compose(s)}}beginAnnotation(t,e,s,a,r){this.#Mt();resetCtxToDefault(this.ctx);this.ctx.save();this.save();this.baseTransform&&this.ctx.setTransform(...this.baseTransform);if(Array.isArray(e)&&4===e.length){const a=e[2]-e[0],o=e[3]-e[1];if(r&&this.annotationCanvasMap){(s=s.slice())[4]-=e[0];s[5]-=e[1];(e=e.slice())[0]=e[1]=0;e[2]=a;e[3]=o;const[r,l]=n.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(this.ctx)),{viewportScale:c}=this,h=Math.ceil(a*this.outputScaleX*c),d=Math.ceil(o*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(h,d);const{canvas:u,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(t,u);this.annotationCanvas.savedCtx=this.ctx;this.ctx=p;this.ctx.save();this.ctx.setTransform(r,0,0,-l,0,o*l);resetCtxToDefault(this.ctx)}else{resetCtxToDefault(this.ctx);this.ctx.rect(e[0],e[1],a,o);this.ctx.clip();this.endPath()}}this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height);this.transform(...s);this.transform(...a)}endAnnotation(){if(this.annotationCanvas){this.ctx.restore();this.#Rt();this.ctx=this.annotationCanvas.savedCtx;delete this.annotationCanvas.savedCtx;delete this.annotationCanvas}}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;(t=this.getObject(t.data,t)).count=e;const s=this.ctx,n=this.processingType3;if(n){void 0===n.compiled&&(n.compiled=function compileType3Glyph(t){const{width:e,height:s}=t;if(e>1e3||s>1e3)return null;const n=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=e+1;let a,r,o,l=new Uint8Array(i*(s+1));const c=e+7&-8;let h=new Uint8Array(c*s),d=0;for(const e of t.data){let t=128;for(;t>0;){h[d++]=e&t?0:255;t>>=1}}let u=0;d=0;if(0!==h[d]){l[0]=1;++u}for(r=1;r<e;r++){if(h[d]!==h[d+1]){l[r]=h[d]?2:1;++u}d++}if(0!==h[d]){l[r]=2;++u}for(a=1;a<s;a++){d=a*c;o=a*i;if(h[d-c]!==h[d]){l[o]=h[d]?1:8;++u}let t=(h[d]?4:0)+(h[d-c]?8:0);for(r=1;r<e;r++){t=(t>>2)+(h[d+1]?4:0)+(h[d-c+1]?8:0);if(n[t]){l[o+r]=n[t];++u}d++}if(h[d-c]!==h[d]){l[o+r]=h[d]?2:4;++u}if(u>1e3)return null}d=c*(s-1);o=a*i;if(0!==h[d]){l[o]=8;++u}for(r=1;r<e;r++){if(h[d]!==h[d+1]){l[o+r]=h[d]?4:8;++u}d++}if(0!==h[d]){l[o+r]=4;++u}if(u>1e3)return null;const p=new Int32Array([0,i,-1,0,-i,0,0,0,1]),g=new Path2D;for(a=0;u&&a<=s;a++){let t=a*i;const s=t+e;for(;t<s&&!l[t];)t++;if(t===s)continue;g.moveTo(t%i,a);const n=t;let r=l[t];do{const e=p[r];do{t+=e}while(!l[t]);const s=l[t];if(5!==s&&10!==s){r=s;l[t]=0}else{r=s&51*r>>4;l[t]&=r>>2|r<<2}g.lineTo(t%i,t/i|0);l[t]||--u}while(n!==t);--a}h=null;l=null;return function(t){t.save();t.scale(1/e,-1/s);t.translate(0,-s);t.fill(g);t.beginPath();t.restore()}}(t));if(n.compiled){n.compiled(s);return}}const i=this._createMaskCanvas(t),a=i.canvas;s.save();s.setTransform(1,0,0,1,0,0);s.drawImage(a,i.offsetX,i.offsetY);s.restore();this.compose()}paintImageMaskXObjectRepeat(t,e,s=0,a=0,r,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const c=(0,i.getCurrentTransform)(l);l.transform(e,s,a,r,0,0);const h=this._createMaskCanvas(t);l.setTransform(1,0,0,1,h.offsetX-c[4],h.offsetY-c[5]);for(let t=0,i=o.length;t<i;t+=2){const i=n.Util.transform(c,[e,s,a,r,o[t],o[t+1]]),[d,u]=n.Util.applyTransform([0,0],i);l.drawImage(h.canvas,d,u)}l.restore();this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,s=this.current.fillColor,n=this.current.patternFill;for(const r of t){const{data:t,width:o,height:l,transform:c}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),d=h.context;d.save();putBinaryImageMask(d,this.getObject(t,r));d.globalCompositeOperation="source-in";d.fillStyle=n?s.getPattern(d,this,(0,i.getCurrentTransformInverse)(e),a.PathType.FILL):s;d.fillRect(0,0,o,l);d.restore();e.save();e.transform(...c);e.scale(1,-1);drawImageAtIntegerCoords(e,h.canvas,0,0,o,l,0,-1,1,1);e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);e?this.paintInlineImageXObject(e):(0,n.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(t,e,s,i){if(!this.contentVisible)return;const a=this.getObject(t);if(!a){(0,n.warn)("Dependent image isn't ready yet");return}const r=a.width,o=a.height,l=[];for(let t=0,n=i.length;t<n;t+=2)l.push({transform:[e,0,0,s,i[t],i[t+1]],x:0,y:0,w:r,h:o});this.paintInlineImageXObjectGroup(a,l)}applyTransferMapsToCanvas(t){if("none"!==this.current.transferMaps){t.filter=this.current.transferMaps;t.drawImage(t.canvas,0,0);t.filter="none"}return t.canvas}applyTransferMapsToBitmap(t){if("none"===this.current.transferMaps)return t.bitmap;const{bitmap:e,width:s,height:n}=t,i=this.cachedCanvases.getCanvas("inlineImage",s,n),a=i.context;a.filter=this.current.transferMaps;a.drawImage(e,0,0);a.filter="none";return i.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,s=t.height,n=this.ctx;this.save();o.isNodeJS||(n.filter="none");n.scale(1/e,-1/s);let a;if(t.bitmap)a=this.applyTransferMapsToBitmap(t);else if("function"==typeof HTMLElement&&t instanceof HTMLElement||!t.data)a=t;else{const n=this.cachedCanvases.getCanvas("inlineImage",e,s).context;putBinaryImageData(n,t);a=this.applyTransferMapsToCanvas(n)}const r=this._scaleImage(a,(0,i.getCurrentTransformInverse)(n));n.imageSmoothingEnabled=getImageSmoothingEnabled((0,i.getCurrentTransform)(n),t.interpolate);drawImageAtIntegerCoords(n,r.img,0,0,r.paintWidth,r.paintHeight,0,-s,e,s);this.compose();this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const s=this.ctx;let n;if(t.bitmap)n=t.bitmap;else{const e=t.width,s=t.height,i=this.cachedCanvases.getCanvas("inlineImage",e,s).context;putBinaryImageData(i,t);n=this.applyTransferMapsToCanvas(i)}for(const t of e){s.save();s.transform(...t.transform);s.scale(1,-1);drawImageAtIntegerCoords(s,n,t.x,t.y,t.w,t.h,0,-1,1,1);s.restore()}this.compose()}paintSolidColorImageMask(){if(this.contentVisible){this.ctx.fillRect(0,0,1,1);this.compose()}}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0});this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop();this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath();this.pendingClip||this.compose(t);const s=this.ctx;if(this.pendingClip){e||(this.pendingClip===p?s.clip("evenodd"):s.clip());this.pendingClip=null}this.current.startNewPathAndClipBox(this.current.clipBox);s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=(0,i.getCurrentTransform)(this.ctx);if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:t}=this.current,{a:e,b:s,c:n,d:i}=this.ctx.getTransform();let a,r;if(0===s&&0===n){const s=Math.abs(e),n=Math.abs(i);if(s===n)if(0===t)a=r=1/s;else{const e=s*t;a=r=e<1?1/e:1}else if(0===t){a=1/s;r=1/n}else{const e=s*t,i=n*t;a=e<1?1/e:1;r=i<1?1/i:1}}else{const o=Math.abs(e*i-s*n),l=Math.hypot(e,s),c=Math.hypot(n,i);if(0===t){a=c/o;r=l/o}else{const e=t*o;a=c>e?c/e:1;r=l>e?l/e:1}}this._cachedScaleForStroking[0]=a;this._cachedScaleForStroking[1]=r}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:s}=this.current,[n,i]=this.getScaleForStroking();e.lineWidth=s||1;if(1===n&&1===i){e.stroke();return}const a=e.getLineDash();t&&e.save();e.scale(n,i);if(a.length>0){const t=Math.max(n,i);e.setLineDash(a.map((e=>e/t)));e.lineDashOffset/=t}e.stroke();t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}e.CanvasGraphics=CanvasGraphics;for(const t in n.OPS)void 0!==CanvasGraphics.prototype[t]&&(CanvasGraphics.prototype[n.OPS[t]]=CanvasGraphics.prototype[t])},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.TilingPattern=e.PathType=void 0;e.getShadingPattern=function getShadingPattern(t){switch(t[0]){case"RadialAxial":return new RadialAxialShadingPattern(t);case"Mesh":return new MeshShadingPattern(t);case"Dummy":return new DummyShadingPattern}throw new Error(`Unknown IR type: ${t[0]}`)};var n=s(1),i=s(6);const a={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=a;function applyBoundingBox(t,e){if(!e)return;const s=e[2]-e[0],n=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],s,n);t.clip(i)}class BaseShadingPattern{constructor(){this.constructor===BaseShadingPattern&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class RadialAxialShadingPattern extends BaseShadingPattern{constructor(t){super();this._type=t[1];this._bbox=t[2];this._colorStops=t[3];this._p0=t[4];this._p1=t[5];this._r0=t[6];this._r1=t[7];this.matrix=null}_createGradient(t){let e;"axial"===this._type?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const t of this._colorStops)e.addColorStop(t[0],t[1]);return e}getPattern(t,e,s,r){let o;if(r===a.STROKE||r===a.FILL){const a=e.current.getClippedPathBoundingBox(r,(0,i.getCurrentTransform)(t))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,h=e.cachedCanvases.getCanvas("pattern",l,c,!0),d=h.context;d.clearRect(0,0,d.canvas.width,d.canvas.height);d.beginPath();d.rect(0,0,d.canvas.width,d.canvas.height);d.translate(-a[0],-a[1]);s=n.Util.transform(s,[1,0,0,1,a[0],a[1]]);d.transform(...e.baseTransform);this.matrix&&d.transform(...this.matrix);applyBoundingBox(d,this._bbox);d.fillStyle=this._createGradient(d);d.fill();o=t.createPattern(h.canvas,"no-repeat");const u=new DOMMatrix(s);o.setTransform(u)}else{applyBoundingBox(t,this._bbox);o=this._createGradient(t)}return o}}function drawTriangle(t,e,s,n,i,a,r,o){const l=e.coords,c=e.colors,h=t.data,d=4*t.width;let u;if(l[s+1]>l[n+1]){u=s;s=n;n=u;u=a;a=r;r=u}if(l[n+1]>l[i+1]){u=n;n=i;i=u;u=r;r=o;o=u}if(l[s+1]>l[n+1]){u=s;s=n;n=u;u=a;a=r;r=u}const p=(l[s]+e.offsetX)*e.scaleX,g=(l[s+1]+e.offsetY)*e.scaleY,f=(l[n]+e.offsetX)*e.scaleX,m=(l[n+1]+e.offsetY)*e.scaleY,b=(l[i]+e.offsetX)*e.scaleX,A=(l[i+1]+e.offsetY)*e.scaleY;if(g>=A)return;const _=c[a],y=c[a+1],v=c[a+2],S=c[r],E=c[r+1],x=c[r+2],C=c[o],w=c[o+1],T=c[o+2],P=Math.round(g),F=Math.round(A);let k,M,R,D,I,O,L,N;for(let t=P;t<=F;t++){if(t<m){let e;e=t<g?0:(g-t)/(g-m);k=p-(p-f)*e;M=_-(_-S)*e;R=y-(y-E)*e;D=v-(v-x)*e}else{let e;e=t>A?1:m===A?0:(m-t)/(m-A);k=f-(f-b)*e;M=S-(S-C)*e;R=E-(E-w)*e;D=x-(x-T)*e}let e;e=t<g?0:t>A?1:(g-t)/(g-A);I=p-(p-b)*e;O=_-(_-C)*e;L=y-(y-w)*e;N=v-(v-T)*e;const s=Math.round(Math.min(k,I)),n=Math.round(Math.max(k,I));let i=d*t+4*s;for(let t=s;t<=n;t++){e=(k-t)/(k-I);e<0?e=0:e>1&&(e=1);h[i++]=M-(M-O)*e|0;h[i++]=R-(R-L)*e|0;h[i++]=D-(D-N)*e|0;h[i++]=255}}}function drawFigure(t,e,s){const n=e.coords,i=e.colors;let a,r;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(n.length/o)-1,c=o-1;for(a=0;a<l;a++){let e=a*o;for(let a=0;a<c;a++,e++){drawTriangle(t,s,n[e],n[e+1],n[e+o],i[e],i[e+1],i[e+o]);drawTriangle(t,s,n[e+o+1],n[e+1],n[e+o],i[e+o+1],i[e+1],i[e+o])}}break;case"triangles":for(a=0,r=n.length;a<r;a+=3)drawTriangle(t,s,n[a],n[a+1],n[a+2],i[a],i[a+1],i[a+2]);break;default:throw new Error("illegal figure")}}class MeshShadingPattern extends BaseShadingPattern{constructor(t){super();this._coords=t[2];this._colors=t[3];this._figures=t[4];this._bounds=t[5];this._bbox=t[7];this._background=t[8];this.matrix=null}_createMeshCanvas(t,e,s){const n=Math.floor(this._bounds[0]),i=Math.floor(this._bounds[1]),a=Math.ceil(this._bounds[2])-n,r=Math.ceil(this._bounds[3])-i,o=Math.min(Math.ceil(Math.abs(a*t[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(r*t[1]*1.1)),3e3),c=a/o,h=r/l,d={coords:this._coords,colors:this._colors,offsetX:-n,offsetY:-i,scaleX:1/c,scaleY:1/h},u=o+4,p=l+4,g=s.getCanvas("mesh",u,p,!1),f=g.context,m=f.createImageData(o,l);if(e){const t=m.data;for(let s=0,n=t.length;s<n;s+=4){t[s]=e[0];t[s+1]=e[1];t[s+2]=e[2];t[s+3]=255}}for(const t of this._figures)drawFigure(m,t,d);f.putImageData(m,2,2);return{canvas:g.canvas,offsetX:n-2*c,offsetY:i-2*h,scaleX:c,scaleY:h}}getPattern(t,e,s,r){applyBoundingBox(t,this._bbox);let o;if(r===a.SHADING)o=n.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(t));else{o=n.Util.singularValueDecompose2dScale(e.baseTransform);if(this.matrix){const t=n.Util.singularValueDecompose2dScale(this.matrix);o=[o[0]*t[0],o[1]*t[1]]}}const l=this._createMeshCanvas(o,r===a.SHADING?null:this._background,e.cachedCanvases);if(r!==a.SHADING){t.setTransform(...e.baseTransform);this.matrix&&t.transform(...this.matrix)}t.translate(l.offsetX,l.offsetY);t.scale(l.scaleX,l.scaleY);return t.createPattern(l.canvas,"no-repeat")}}class DummyShadingPattern extends BaseShadingPattern{getPattern(){return"hotpink"}}const r=1,o=2;class TilingPattern{static MAX_PATTERN_SIZE=3e3;constructor(t,e,s,n,i){this.operatorList=t[2];this.matrix=t[3]||[1,0,0,1,0,0];this.bbox=t[4];this.xstep=t[5];this.ystep=t[6];this.paintType=t[7];this.tilingType=t[8];this.color=e;this.ctx=s;this.canvasGraphicsFactory=n;this.baseTransform=i}createPatternCanvas(t){const e=this.operatorList,s=this.bbox,a=this.xstep,r=this.ystep,o=this.paintType,l=this.tilingType,c=this.color,h=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+l);const d=s[0],u=s[1],p=s[2],g=s[3],f=n.Util.singularValueDecompose2dScale(this.matrix),m=n.Util.singularValueDecompose2dScale(this.baseTransform),b=[f[0]*m[0],f[1]*m[1]],A=this.getSizeAndScale(a,this.ctx.canvas.width,b[0]),_=this.getSizeAndScale(r,this.ctx.canvas.height,b[1]),y=t.cachedCanvases.getCanvas("pattern",A.size,_.size,!0),v=y.context,S=h.createCanvasGraphics(v);S.groupLevel=t.groupLevel;this.setFillAndStrokeStyleToContext(S,o,c);let E=d,x=u,C=p,w=g;if(d<0){E=0;C+=Math.abs(d)}if(u<0){x=0;w+=Math.abs(u)}v.translate(-A.scale*E,-_.scale*x);S.transform(A.scale,0,0,_.scale,0,0);v.save();this.clipBbox(S,E,x,C,w);S.baseTransform=(0,i.getCurrentTransform)(S.ctx);S.executeOperatorList(e);S.endDrawing();return{canvas:y.canvas,scaleX:A.scale,scaleY:_.scale,offsetX:E,offsetY:x}}getSizeAndScale(t,e,s){t=Math.abs(t);const n=Math.max(TilingPattern.MAX_PATTERN_SIZE,e);let i=Math.ceil(t*s);i>=n?i=n:s=i/t;return{scale:s,size:i}}clipBbox(t,e,s,n,a){const r=n-e,o=a-s;t.ctx.rect(e,s,r,o);t.current.updateRectMinMax((0,i.getCurrentTransform)(t.ctx),[e,s,n,a]);t.clip();t.endPath()}setFillAndStrokeStyleToContext(t,e,s){const i=t.ctx,a=t.current;switch(e){case r:const t=this.ctx;i.fillStyle=t.fillStyle;i.strokeStyle=t.strokeStyle;a.fillColor=t.fillStyle;a.strokeColor=t.strokeStyle;break;case o:const l=n.Util.makeHexColor(s[0],s[1],s[2]);i.fillStyle=l;i.strokeStyle=l;a.fillColor=l;a.strokeColor=l;break;default:throw new n.FormatError(`Unsupported paint type: ${e}`)}}getPattern(t,e,s,i){let r=s;if(i!==a.SHADING){r=n.Util.transform(r,e.baseTransform);this.matrix&&(r=n.Util.transform(r,this.matrix))}const o=this.createPatternCanvas(e);let l=new DOMMatrix(r);l=l.translate(o.offsetX,o.offsetY);l=l.scale(1/o.scaleX,1/o.scaleY);const c=t.createPattern(o.canvas,"repeat");c.setTransform(l);return c}}e.TilingPattern=TilingPattern},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.convertBlackAndWhiteToRGBA=convertBlackAndWhiteToRGBA;e.convertToRGBA=function convertToRGBA(t){switch(t.kind){case n.ImageKind.GRAYSCALE_1BPP:return convertBlackAndWhiteToRGBA(t);case n.ImageKind.RGB_24BPP:return function convertRGBToRGBA({src:t,srcPos:e=0,dest:s,destPos:i=0,width:a,height:r}){let o=0;const l=t.length>>2,c=new Uint32Array(t.buffer,e,l);if(n.FeatureTest.isLittleEndian){for(;o<l-2;o+=3,i+=4){const t=c[o],e=c[o+1],n=c[o+2];s[i]=4278190080|t;s[i+1]=t>>>24|e<<8|4278190080;s[i+2]=e>>>16|n<<16|4278190080;s[i+3]=n>>>8|4278190080}for(let e=4*o,n=t.length;e<n;e+=3)s[i++]=t[e]|t[e+1]<<8|t[e+2]<<16|4278190080}else{for(;o<l-2;o+=3,i+=4){const t=c[o],e=c[o+1],n=c[o+2];s[i]=255|t;s[i+1]=t<<24|e>>>8|255;s[i+2]=e<<16|n>>>16|255;s[i+3]=n<<8|255}for(let e=4*o,n=t.length;e<n;e+=3)s[i++]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|255}return{srcPos:e,destPos:i}}(t)}return null};e.grayToRGBA=function grayToRGBA(t,e){if(n.FeatureTest.isLittleEndian)for(let s=0,n=t.length;s<n;s++)e[s]=65793*t[s]|4278190080;else for(let s=0,n=t.length;s<n;s++)e[s]=16843008*t[s]|255};var n=s(1);function convertBlackAndWhiteToRGBA({src:t,srcPos:e=0,dest:s,width:i,height:a,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const l=n.FeatureTest.isLittleEndian?4278190080:255,[c,h]=o?[r,l]:[l,r],d=i>>3,u=7&i,p=t.length;s=new Uint32Array(s.buffer);let g=0;for(let n=0;n<a;n++){for(const n=e+d;e<n;e++){const n=e<p?t[e]:255;s[g++]=128&n?h:c;s[g++]=64&n?h:c;s[g++]=32&n?h:c;s[g++]=16&n?h:c;s[g++]=8&n?h:c;s[g++]=4&n?h:c;s[g++]=2&n?h:c;s[g++]=1&n?h:c}if(0===u)continue;const n=e<p?t[e++]:255;for(let t=0;t<u;t++)s[g++]=n&1<<7-t?h:c}return{srcPos:e,destPos:g}}},(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.GlobalWorkerOptions=void 0;const s=Object.create(null);e.GlobalWorkerOptions=s;s.workerPort=null;s.workerSrc=""},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.MessageHandler=void 0;var n=s(1);const i=1,a=2,r=1,o=2,l=3,c=4,h=5,d=6,u=7,p=8;function wrapReason(t){t instanceof Error||"object"==typeof t&&null!==t||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.');switch(t.name){case"AbortException":return new n.AbortException(t.message);case"MissingPDFException":return new n.MissingPDFException(t.message);case"PasswordException":return new n.PasswordException(t.message,t.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(t.message,t.status);case"UnknownErrorException":return new n.UnknownErrorException(t.message,t.details);default:return new n.UnknownErrorException(t.message,t.toString())}}e.MessageHandler=class MessageHandler{constructor(t,e,s){this.sourceName=t;this.targetName=e;this.comObj=s;this.callbackId=1;this.streamId=1;this.streamSinks=Object.create(null);this.streamControllers=Object.create(null);this.callbackCapabilities=Object.create(null);this.actionHandler=Object.create(null);this._onComObjOnMessage=t=>{const e=t.data;if(e.targetName!==this.sourceName)return;if(e.stream){this.#Dt(e);return}if(e.callback){const t=e.callbackId,s=this.callbackCapabilities[t];if(!s)throw new Error(`Cannot resolve callback ${t}`);delete this.callbackCapabilities[t];if(e.callback===i)s.resolve(e.data);else{if(e.callback!==a)throw new Error("Unexpected callback case");s.reject(wrapReason(e.reason))}return}const n=this.actionHandler[e.action];if(!n)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const t=this.sourceName,r=e.sourceName;new Promise((function(t){t(n(e.data))})).then((function(n){s.postMessage({sourceName:t,targetName:r,callback:i,callbackId:e.callbackId,data:n})}),(function(n){s.postMessage({sourceName:t,targetName:r,callback:a,callbackId:e.callbackId,reason:wrapReason(n)})}))}else e.streamId?this.#It(e):n(e.data)};s.addEventListener("message",this._onComObjOnMessage)}on(t,e){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=e}send(t,e,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},s)}sendWithPromise(t,e,s){const i=this.callbackId++,a=new n.PromiseCapability;this.callbackCapabilities[i]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},s)}catch(t){a.reject(t)}return a.promise}sendWithStream(t,e,s,i){const a=this.streamId++,o=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:s=>{const r=new n.PromiseCapability;this.streamControllers[a]={controller:s,startCall:r,pullCall:null,cancelCall:null,isClosed:!1};c.postMessage({sourceName:o,targetName:l,action:t,streamId:a,data:e,desiredSize:s.desiredSize},i);return r.promise},pull:t=>{const e=new n.PromiseCapability;this.streamControllers[a].pullCall=e;c.postMessage({sourceName:o,targetName:l,stream:d,streamId:a,desiredSize:t.desiredSize});return e.promise},cancel:t=>{(0,n.assert)(t instanceof Error,"cancel must have a valid reason");const e=new n.PromiseCapability;this.streamControllers[a].cancelCall=e;this.streamControllers[a].isClosed=!0;c.postMessage({sourceName:o,targetName:l,stream:r,streamId:a,reason:wrapReason(t)});return e.promise}},s)}#It(t){const e=t.streamId,s=this.sourceName,i=t.sourceName,a=this.comObj,r=this,o=this.actionHandler[t.action],d={enqueue(t,r=1,o){if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=r;if(l>0&&this.desiredSize<=0){this.sinkCapability=new n.PromiseCapability;this.ready=this.sinkCapability.promise}a.postMessage({sourceName:s,targetName:i,stream:c,streamId:e,chunk:t},o)},close(){if(!this.isCancelled){this.isCancelled=!0;a.postMessage({sourceName:s,targetName:i,stream:l,streamId:e});delete r.streamSinks[e]}},error(t){(0,n.assert)(t instanceof Error,"error must have a valid reason");if(!this.isCancelled){this.isCancelled=!0;a.postMessage({sourceName:s,targetName:i,stream:h,streamId:e,reason:wrapReason(t)})}},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve();d.ready=d.sinkCapability.promise;this.streamSinks[e]=d;new Promise((function(e){e(o(t.data,d))})).then((function(){a.postMessage({sourceName:s,targetName:i,stream:p,streamId:e,success:!0})}),(function(t){a.postMessage({sourceName:s,targetName:i,stream:p,streamId:e,reason:wrapReason(t)})}))}#Dt(t){const e=t.streamId,s=this.sourceName,i=t.sourceName,a=this.comObj,g=this.streamControllers[e],f=this.streamSinks[e];switch(t.stream){case p:t.success?g.startCall.resolve():g.startCall.reject(wrapReason(t.reason));break;case u:t.success?g.pullCall.resolve():g.pullCall.reject(wrapReason(t.reason));break;case d:if(!f){a.postMessage({sourceName:s,targetName:i,stream:u,streamId:e,success:!0});break}f.desiredSize<=0&&t.desiredSize>0&&f.sinkCapability.resolve();f.desiredSize=t.desiredSize;new Promise((function(t){t(f.onPull?.())})).then((function(){a.postMessage({sourceName:s,targetName:i,stream:u,streamId:e,success:!0})}),(function(t){a.postMessage({sourceName:s,targetName:i,stream:u,streamId:e,reason:wrapReason(t)})}));break;case c:(0,n.assert)(g,"enqueue should have stream controller");if(g.isClosed)break;g.controller.enqueue(t.chunk);break;case l:(0,n.assert)(g,"close should have stream controller");if(g.isClosed)break;g.isClosed=!0;g.controller.close();this.#Ot(g,e);break;case h:(0,n.assert)(g,"error should have stream controller");g.controller.error(wrapReason(t.reason));this.#Ot(g,e);break;case o:t.success?g.cancelCall.resolve():g.cancelCall.reject(wrapReason(t.reason));this.#Ot(g,e);break;case r:if(!f)break;new Promise((function(e){e(f.onCancel?.(wrapReason(t.reason)))})).then((function(){a.postMessage({sourceName:s,targetName:i,stream:o,streamId:e,success:!0})}),(function(t){a.postMessage({sourceName:s,targetName:i,stream:o,streamId:e,reason:wrapReason(t)})}));f.sinkCapability.reject(wrapReason(t.reason));f.isCancelled=!0;delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#Ot(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]);delete this.streamControllers[e]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.Metadata=void 0;var n=s(1);e.Metadata=class Metadata{#Lt;#Nt;constructor({parsedData:t,rawData:e}){this.#Lt=t;this.#Nt=e}getRaw(){return this.#Nt}get(t){return this.#Lt.get(t)??null}getAll(){return(0,n.objectFromMap)(this.#Lt)}has(t){return this.#Lt.has(t)}}},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.OptionalContentConfig=void 0;var n=s(1),i=s(8);const a=Symbol("INTERNAL");class OptionalContentGroup{#Bt=!0;constructor(t,e){this.name=t;this.intent=e}get visible(){return this.#Bt}_setVisible(t,e){t!==a&&(0,n.unreachable)("Internal method `_setVisible` called.");this.#Bt=e}}e.OptionalContentConfig=class OptionalContentConfig{#jt=null;#Ut=new Map;#Ht=null;#qt=null;constructor(t){this.name=null;this.creator=null;if(null!==t){this.name=t.name;this.creator=t.creator;this.#qt=t.order;for(const e of t.groups)this.#Ut.set(e.id,new OptionalContentGroup(e.name,e.intent));if("OFF"===t.baseState)for(const t of this.#Ut.values())t._setVisible(a,!1);for(const e of t.on)this.#Ut.get(e)._setVisible(a,!0);for(const e of t.off)this.#Ut.get(e)._setVisible(a,!1);this.#Ht=this.getHash()}}#Wt(t){const e=t.length;if(e<2)return!0;const s=t[0];for(let i=1;i<e;i++){const e=t[i];let a;if(Array.isArray(e))a=this.#Wt(e);else{if(!this.#Ut.has(e)){(0,n.warn)(`Optional content group not found: ${e}`);return!0}a=this.#Ut.get(e).visible}switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return"And"===s}isVisible(t){if(0===this.#Ut.size)return!0;if(!t){(0,n.warn)("Optional content group not defined.");return!0}if("OCG"===t.type){if(!this.#Ut.has(t.id)){(0,n.warn)(`Optional content group not found: ${t.id}`);return!0}return this.#Ut.get(t.id).visible}if("OCMD"===t.type){if(t.expression)return this.#Wt(t.expression);if(!t.policy||"AnyOn"===t.policy){for(const e of t.ids){if(!this.#Ut.has(e)){(0,n.warn)(`Optional content group not found: ${e}`);return!0}if(this.#Ut.get(e).visible)return!0}return!1}if("AllOn"===t.policy){for(const e of t.ids){if(!this.#Ut.has(e)){(0,n.warn)(`Optional content group not found: ${e}`);return!0}if(!this.#Ut.get(e).visible)return!1}return!0}if("AnyOff"===t.policy){for(const e of t.ids){if(!this.#Ut.has(e)){(0,n.warn)(`Optional content group not found: ${e}`);return!0}if(!this.#Ut.get(e).visible)return!0}return!1}if("AllOff"===t.policy){for(const e of t.ids){if(!this.#Ut.has(e)){(0,n.warn)(`Optional content group not found: ${e}`);return!0}if(this.#Ut.get(e).visible)return!1}return!0}(0,n.warn)(`Unknown optional content policy ${t.policy}.`);return!0}(0,n.warn)(`Unknown group type ${t.type}.`);return!0}setVisibility(t,e=!0){if(this.#Ut.has(t)){this.#Ut.get(t)._setVisible(a,!!e);this.#jt=null}else(0,n.warn)(`Optional content group not found: ${t}`)}get hasInitialVisibility(){return this.getHash()===this.#Ht}getOrder(){return this.#Ut.size?this.#qt?this.#qt.slice():[...this.#Ut.keys()]:null}getGroups(){return this.#Ut.size>0?(0,n.objectFromMap)(this.#Ut):null}getGroup(t){return this.#Ut.get(t)||null}getHash(){if(null!==this.#jt)return this.#jt;const t=new i.MurmurHash3_64;for(const[e,s]of this.#Ut)t.update(`${e}:${s.visible}`);return this.#jt=t.hexdigest()}}},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.PDFDataTransportStream=void 0;var n=s(1),i=s(6);e.PDFDataTransportStream=class PDFDataTransportStream{constructor({length:t,initialData:e,progressiveDone:s=!1,contentDispositionFilename:i=null,disableRange:a=!1,disableStream:r=!1},o){(0,n.assert)(o,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');this._queuedChunks=[];this._progressiveDone=s;this._contentDispositionFilename=i;if(e?.length>0){const t=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;this._queuedChunks.push(t)}this._pdfDataRangeTransport=o;this._isStreamingSupported=!r;this._isRangeSupported=!a;this._contentLength=t;this._fullRequestReader=null;this._rangeReaders=[];this._pdfDataRangeTransport.addRangeListener(((t,e)=>{this._onReceiveData({begin:t,chunk:e})}));this._pdfDataRangeTransport.addProgressListener(((t,e)=>{this._onProgress({loaded:t,total:e})}));this._pdfDataRangeTransport.addProgressiveReadListener((t=>{this._onReceiveData({chunk:t})}));this._pdfDataRangeTransport.addProgressiveDoneListener((()=>{this._onProgressiveDone()}));this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:t,chunk:e}){const s=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(void 0===t)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const e=this._rangeReaders.some((function(e){if(e._begin!==t)return!1;e._enqueue(s);return!0}));(0,n.assert)(e,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){void 0===t.total?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone();this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;this._queuedChunks=null;return new PDFDataTransportStreamReader(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new PDFDataTransportStreamRangeReader(this,t,e);this._pdfDataRangeTransport.requestDataRange(t,e);this._rangeReaders.push(s);return s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}};class PDFDataTransportStreamReader{constructor(t,e,s=!1,n=null){this._stream=t;this._done=s||!1;this._filename=(0,i.isPdfFile)(n)?n:null;this._queuedChunks=e||[];this._loaded=0;for(const t of this._queuedChunks)this._loaded+=t.byteLength;this._requests=[];this._headersReady=Promise.resolve();t._fullRequestReader=this;this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunks.push(t);this._loaded+=t.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const t=new n.PromiseCapability;this._requests.push(t);return t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class PDFDataTransportStreamRangeReader{constructor(t,e,s){this._stream=t;this._begin=e;this._end=s;this._queuedChunk=null;this._requests=[];this._done=!1;this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0;this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;this._queuedChunk=null;return{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=new n.PromiseCapability;this._requests.push(t);return t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0;this._stream._removeRangeReader(this)}}},(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.XfaText=void 0;class XfaText{static textContent(t){const e=[],s={items:e,styles:Object.create(null)};!function walk(t){if(!t)return;let s=null;const n=t.name;if("#text"===n)s=t.value;else{if(!XfaText.shouldBuildText(n))return;t?.attributes?.textContent?s=t.attributes.textContent:t.value&&(s=t.value)}null!==s&&e.push({str:s});if(t.children)for(const e of t.children)walk(e)}(t);return s}static shouldBuildText(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}e.XfaText=XfaText},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=s(7);const fetchData=function(t){return new Promise(((e,s)=>{require("fs").readFile(t,((t,n)=>{!t&&n?e(new Uint8Array(n)):s(new Error(t))}))}))};class NodeFilterFactory extends n.BaseFilterFactory{}e.NodeFilterFactory=NodeFilterFactory;class NodeCanvasFactory extends n.BaseCanvasFactory{_createCanvas(t,e){return require("canvas").createCanvas(t,e)}}e.NodeCanvasFactory=NodeCanvasFactory;class NodeCMapReaderFactory extends n.BaseCMapReaderFactory{_fetchData(t,e){return fetchData(t).then((t=>({cMapData:t,compressionType:e})))}}e.NodeCMapReaderFactory=NodeCMapReaderFactory;class NodeStandardFontDataFactory extends n.BaseStandardFontDataFactory{_fetchData(t){return fetchData(t)}}e.NodeStandardFontDataFactory=NodeStandardFontDataFactory},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.PDFNodeStream=void 0;var n=s(1),i=s(22);const a=require("fs"),r=require("http"),o=require("https"),l=require("url"),c=/^file:\/\/\/[a-zA-Z]:\//;e.PDFNodeStream=class PDFNodeStream{constructor(t){this.source=t;this.url=function parseUrl(t){const e=l.parse(t);if("file:"===e.protocol||e.host)return e;if(/^[a-z]:[/\\]/i.test(t))return l.parse(`file:///${t}`);e.host||(e.protocol="file:");return e}(t.url);this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol;this.isFsUrl="file:"===this.url.protocol;this.httpHeaders=this.isHttp&&t.httpHeaders||{};this._fullRequestReader=null;this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once.");this._fullRequestReader=this.isFsUrl?new PDFNodeStreamFsFullReader(this):new PDFNodeStreamFullReader(this);return this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=this.isFsUrl?new PDFNodeStreamFsRangeReader(this,t,e):new PDFNodeStreamRangeReader(this,t,e);this._rangeRequestReaders.push(s);return s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}};class BaseFullReader{constructor(t){this._url=t.url;this._done=!1;this._storedError=null;this.onProgress=null;const e=t.source;this._contentLength=e.length;this._loaded=0;this._filename=null;this._disableRange=e.disableRange||!1;this._rangeChunkSize=e.rangeChunkSize;this._rangeChunkSize||this._disableRange||(this._disableRange=!0);this._isStreamingSupported=!e.disableStream;this._isRangeSupported=!e.disableRange;this._readableStream=null;this._readCapability=new n.PromiseCapability;this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;if(this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t){this._readCapability=new n.PromiseCapability;return this.read()}this._loaded+=t.length;this.onProgress?.({loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t;this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t;t.on("readable",(()=>{this._readCapability.resolve()}));t.on("end",(()=>{t.destroy();this._done=!0;this._readCapability.resolve()}));t.on("error",(t=>{this._error(t)}));!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled"));this._storedError&&this._readableStream.destroy(this._storedError)}}class BaseRangeReader{constructor(t){this._url=t.url;this._done=!1;this._storedError=null;this.onProgress=null;this._loaded=0;this._readableStream=null;this._readCapability=new n.PromiseCapability;const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;if(this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t){this._readCapability=new n.PromiseCapability;return this.read()}this._loaded+=t.length;this.onProgress?.({loaded:this._loaded});return{value:new Uint8Array(t).buffer,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t;this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t;t.on("readable",(()=>{this._readCapability.resolve()}));t.on("end",(()=>{t.destroy();this._done=!0;this._readCapability.resolve()}));t.on("error",(t=>{this._error(t)}));this._storedError&&this._readableStream.destroy(this._storedError)}}function createRequestOptions(t,e){return{protocol:t.protocol,auth:t.auth,host:t.hostname,port:t.port,path:t.path,method:"GET",headers:e}}class PDFNodeStreamFullReader extends BaseFullReader{constructor(t){super(t);const handleResponse=e=>{if(404===e.statusCode){const t=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=t;this._headersCapability.reject(t);return}this._headersCapability.resolve();this._setReadableStream(e);const getResponseHeader=t=>this._readableStream.headers[t.toLowerCase()],{allowRangeRequests:s,suggestedLength:a}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:getResponseHeader,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s;this._contentLength=a||this._contentLength;this._filename=(0,i.extractFilenameFromHeader)(getResponseHeader)};this._request=null;"http:"===this._url.protocol?this._request=r.request(createRequestOptions(this._url,t.httpHeaders),handleResponse):this._request=o.request(createRequestOptions(this._url,t.httpHeaders),handleResponse);this._request.on("error",(t=>{this._storedError=t;this._headersCapability.reject(t)}));this._request.end()}}class PDFNodeStreamRangeReader extends BaseRangeReader{constructor(t,e,s){super(t);this._httpHeaders={};for(const e in t.httpHeaders){const s=t.httpHeaders[e];void 0!==s&&(this._httpHeaders[e]=s)}this._httpHeaders.Range=`bytes=${e}-${s-1}`;const handleResponse=t=>{if(404!==t.statusCode)this._setReadableStream(t);else{const t=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=t}};this._request=null;"http:"===this._url.protocol?this._request=r.request(createRequestOptions(this._url,this._httpHeaders),handleResponse):this._request=o.request(createRequestOptions(this._url,this._httpHeaders),handleResponse);this._request.on("error",(t=>{this._storedError=t}));this._request.end()}}class PDFNodeStreamFsFullReader extends BaseFullReader{constructor(t){super(t);let e=decodeURIComponent(this._url.path);c.test(this._url.href)&&(e=e.replace(/^\//,""));a.lstat(e,((t,s)=>{if(t){"ENOENT"===t.code&&(t=new n.MissingPDFException(`Missing PDF "${e}".`));this._storedError=t;this._headersCapability.reject(t)}else{this._contentLength=s.size;this._setReadableStream(a.createReadStream(e));this._headersCapability.resolve()}}))}}class PDFNodeStreamFsRangeReader extends BaseRangeReader{constructor(t,e,s){super(t);let n=decodeURIComponent(this._url.path);c.test(this._url.href)&&(n=n.replace(/^\//,""));this._setReadableStream(a.createReadStream(n,{start:e,end:s-1}))}}},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.createResponseStatusError=function createResponseStatusError(t,e){if(404===t||0===t&&e.startsWith("file:"))return new n.MissingPDFException('Missing PDF "'+e+'".');return new n.UnexpectedResponseException(`Unexpected server response (${t}) while retrieving PDF "${e}".`,t)};e.extractFilenameFromHeader=function extractFilenameFromHeader(t){const e=t("Content-Disposition");if(e){let t=(0,i.getFilenameFromContentDispositionHeader)(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if((0,a.isPdfFile)(t))return t}return null};e.validateRangeRequestCapabilities=function validateRangeRequestCapabilities({getResponseHeader:t,isHttp:e,rangeChunkSize:s,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(t("Content-Length"),10);if(!Number.isInteger(a))return i;i.suggestedLength=a;if(a<=2*s)return i;if(n||!e)return i;if("bytes"!==t("Accept-Ranges"))return i;if("identity"!==(t("Content-Encoding")||"identity"))return i;i.allowRangeRequests=!0;return i};e.validateResponseStatus=function validateResponseStatus(t){return 200===t||206===t};var n=s(1),i=s(23),a=s(6)},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.getFilenameFromContentDispositionHeader=function getFilenameFromContentDispositionHeader(t){let e=!0,s=toParamRegExp("filename\\*","i").exec(t);if(s){s=s[1];let t=rfc2616unquote(s);t=unescape(t);t=rfc5987decode(t);t=rfc2047decode(t);return fixupEncoding(t)}s=function rfc2231getparam(t){const e=[];let s;const n=toParamRegExp("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(s=n.exec(t));){let[,t,n,i]=s;t=parseInt(t,10);if(t in e){if(0===t)break}else e[t]=[n,i]}const i=[];for(let t=0;t<e.length&&t in e;++t){let[s,n]=e[t];n=rfc2616unquote(n);if(s){n=unescape(n);0===t&&(n=rfc5987decode(n))}i.push(n)}return i.join("")}(t);if(s){return fixupEncoding(rfc2047decode(s))}s=toParamRegExp("filename","i").exec(t);if(s){s=s[1];let t=rfc2616unquote(s);t=rfc2047decode(t);return fixupEncoding(t)}function toParamRegExp(t,e){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',e)}function textdecode(t,s){if(t){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const i=new TextDecoder(t,{fatal:!0}),a=(0,n.stringToBytes)(s);s=i.decode(a);e=!1}catch{}}return s}function fixupEncoding(t){if(e&&/[\x80-\xff]/.test(t)){t=textdecode("utf-8",t);e&&(t=textdecode("iso-8859-1",t))}return t}function rfc2616unquote(t){if(t.startsWith('"')){const e=t.slice(1).split('\\"');for(let t=0;t<e.length;++t){const s=e[t].indexOf('"');if(-1!==s){e[t]=e[t].slice(0,s);e.length=t+1}e[t]=e[t].replaceAll(/\\(.)/g,"$1")}t=e.join('"')}return t}function rfc5987decode(t){const e=t.indexOf("'");if(-1===e)return t;return textdecode(t.slice(0,e),t.slice(e+1).replace(/^[^']*'/,""))}function rfc2047decode(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(t,e,s,n){if("q"===s||"Q"===s)return textdecode(e,n=(n=n.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt(e,16))})));try{n=atob(n)}catch{}return textdecode(e,n)}))}return""};var n=s(1)},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.PDFNetworkStream=void 0;var n=s(1),i=s(22);class NetworkManager{constructor(t,e={}){this.url=t;this.isHttp=/^https?:/i.test(t);this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null);this.withCredentials=e.withCredentials||!1;this.currXhrId=0;this.pendingRequests=Object.create(null)}requestRange(t,e,s){const n={begin:t,end:e};for(const t in s)n[t]=s[t];return this.request(n)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,s=this.currXhrId++,n=this.pendingRequests[s]={xhr:e};e.open("GET",this.url);e.withCredentials=this.withCredentials;for(const t in this.httpHeaders){const s=this.httpHeaders[t];void 0!==s&&e.setRequestHeader(t,s)}if(this.isHttp&&"begin"in t&&"end"in t){e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`);n.expectedStatus=206}else n.expectedStatus=200;e.responseType="arraybuffer";t.onError&&(e.onerror=function(s){t.onError(e.status)});e.onreadystatechange=this.onStateChange.bind(this,s);e.onprogress=this.onProgress.bind(this,s);n.onHeadersReceived=t.onHeadersReceived;n.onDone=t.onDone;n.onError=t.onError;n.onProgress=t.onProgress;e.send(null);return s}onProgress(t,e){const s=this.pendingRequests[t];s&&s.onProgress?.(e)}onStateChange(t,e){const s=this.pendingRequests[t];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived){s.onHeadersReceived();delete s.onHeadersReceived}if(4!==i.readyState)return;if(!(t in this.pendingRequests))return;delete this.pendingRequests[t];if(0===i.status&&this.isHttp){s.onError?.(i.status);return}const a=i.status||200;if(!(200===a&&206===s.expectedStatus)&&a!==s.expectedStatus){s.onError?.(i.status);return}const r=function getArrayBuffer(t){const e=t.response;return"string"!=typeof e?e:(0,n.stringToBytes)(e).buffer}(i);if(206===a){const t=i.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);s.onDone({begin:parseInt(e[1],10),chunk:r})}else r?s.onDone({begin:0,chunk:r}):s.onError?.(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t];e.abort()}}e.PDFNetworkStream=class PDFNetworkStream{constructor(t){this._source=t;this._manager=new NetworkManager(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials});this._rangeChunkSize=t.rangeChunkSize;this._fullRequestReader=null;this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once.");this._fullRequestReader=new PDFNetworkStreamFullRequestReader(this._manager,this._source);return this._fullRequestReader}getRangeReader(t,e){const s=new PDFNetworkStreamRangeRequestReader(this._manager,t,e);s.onClosed=this._onRangeRequestReaderClosed.bind(this);this._rangeRequestReaders.push(s);return s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}};class PDFNetworkStreamFullRequestReader{constructor(t,e){this._manager=t;const s={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url;this._fullRequestId=t.requestFull(s);this._headersReceivedCapability=new n.PromiseCapability;this._disableRange=e.disableRange||!1;this._contentLength=e.length;this._rangeChunkSize=e.rangeChunkSize;this._rangeChunkSize||this._disableRange||(this._disableRange=!0);this._isStreamingSupported=!1;this._isRangeSupported=!1;this._cachedChunks=[];this._requests=[];this._done=!1;this._storedError=void 0;this._filename=null;this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),getResponseHeader=t=>e.getResponseHeader(t),{allowRangeRequests:s,suggestedLength:n}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:getResponseHeader,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0);this._contentLength=n||this._contentLength;this._filename=(0,i.extractFilenameFromHeader)(getResponseHeader);this._isRangeSupported&&this._manager.abortRequest(t);this._headersReceivedCapability.resolve()}_onDone(t){if(t)if(this._requests.length>0){this._requests.shift().resolve({value:t.chunk,done:!1})}else this._cachedChunks.push(t.chunk);this._done=!0;if(!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=(0,i.createResponseStatusError)(t,this._url);this._headersReceivedCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0;this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const t=new n.PromiseCapability;this._requests.push(t);return t.promise}cancel(t){this._done=!0;this._headersReceivedCapability.reject(t);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0;this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId);this._fullRequestReader=null}}class PDFNetworkStreamRangeRequestReader{constructor(t,e,s){this._manager=t;const n={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url;this._requestId=t.requestRange(e,s,n);this._requests=[];this._queuedChunk=null;this._done=!1;this._storedError=void 0;this.onProgress=null;this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunk=e;this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0;this._close()}_onError(t){this._storedError=(0,i.createResponseStatusError)(t,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0;this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const t=this._queuedChunk;this._queuedChunk=null;return{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=new n.PromiseCapability;this._requests.push(t);return t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0;this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId);this._close()}}},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.PDFFetchStream=void 0;var n=s(1),i=s(22);function createFetchOptions(t,e,s){return{method:"GET",headers:t,signal:s.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function createHeaders(t){const e=new Headers;for(const s in t){const n=t[s];void 0!==n&&e.append(s,n)}return e}function getArrayBuffer(t){if(t instanceof Uint8Array)return t.buffer;if(t instanceof ArrayBuffer)return t;(0,n.warn)(`getArrayBuffer - unexpected data format: ${t}`);return new Uint8Array(t).buffer}e.PDFFetchStream=class PDFFetchStream{constructor(t){this.source=t;this.isHttp=/^https?:/i.test(t.url);this.httpHeaders=this.isHttp&&t.httpHeaders||{};this._fullRequestReader=null;this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once.");this._fullRequestReader=new PDFFetchStreamReader(this);return this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new PDFFetchStreamRangeReader(this,t,e);this._rangeRequestReaders.push(s);return s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}};class PDFFetchStreamReader{constructor(t){this._stream=t;this._reader=null;this._loaded=0;this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1;this._contentLength=e.length;this._headersCapability=new n.PromiseCapability;this._disableRange=e.disableRange||!1;this._rangeChunkSize=e.rangeChunkSize;this._rangeChunkSize||this._disableRange||(this._disableRange=!0);this._abortController=new AbortController;this._isStreamingSupported=!e.disableStream;this._isRangeSupported=!e.disableRange;this._headers=createHeaders(this._stream.httpHeaders);const s=e.url;fetch(s,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then((t=>{if(!(0,i.validateResponseStatus)(t.status))throw(0,i.createResponseStatusError)(t.status,s);this._reader=t.body.getReader();this._headersCapability.resolve();const getResponseHeader=e=>t.headers.get(e),{allowRangeRequests:e,suggestedLength:a}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:getResponseHeader,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=e;this._contentLength=a||this._contentLength;this._filename=(0,i.extractFilenameFromHeader)(getResponseHeader);!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))})).catch(this._headersCapability.reject);this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();if(e)return{value:t,done:e};this._loaded+=t.byteLength;this.onProgress?.({loaded:this._loaded,total:this._contentLength});return{value:getArrayBuffer(t),done:!1}}cancel(t){this._reader?.cancel(t);this._abortController.abort()}}class PDFFetchStreamRangeReader{constructor(t,e,s){this._stream=t;this._reader=null;this._loaded=0;const a=t.source;this._withCredentials=a.withCredentials||!1;this._readCapability=new n.PromiseCapability;this._isStreamingSupported=!a.disableStream;this._abortController=new AbortController;this._headers=createHeaders(this._stream.httpHeaders);this._headers.append("Range",`bytes=${e}-${s-1}`);const r=a.url;fetch(r,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then((t=>{if(!(0,i.validateResponseStatus)(t.status))throw(0,i.createResponseStatusError)(t.status,r);this._readCapability.resolve();this._reader=t.body.getReader()})).catch(this._readCapability.reject);this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();if(e)return{value:t,done:e};this._loaded+=t.byteLength;this.onProgress?.({loaded:this._loaded});return{value:getArrayBuffer(t),done:!1}}cancel(t){this._reader?.cancel(t);this._abortController.abort()}}},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.TextLayerRenderTask=void 0;e.renderTextLayer=function renderTextLayer(t){if(!t.textContentSource&&(t.textContent||t.textContentStream)){(0,i.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead.");t.textContentSource=t.textContent||t.textContentStream}const{container:e,viewport:s}=t,n=getComputedStyle(e),a=n.getPropertyValue("visibility"),r=parseFloat(n.getPropertyValue("--scale-factor"));"visible"===a&&(!r||Math.abs(r-s.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const o=new TextLayerRenderTask(t);o._render();return o};e.updateTextLayer=function updateTextLayer({container:t,viewport:e,textDivs:s,textDivProperties:n,isOffscreenCanvasSupported:a,mustRotate:r=!0,mustRescale:o=!0}){r&&(0,i.setLayerDimensions)(t,{rotation:e.rotation});if(o){const t=getCtx(0,a),i={prevFontSize:null,prevFontFamily:null,div:null,scale:e.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:t};for(const t of s){i.properties=n.get(t);i.div=t;layout(i)}}};var n=s(1),i=s(6);const a=30,r=.8,o=new Map;function getCtx(t,e){let s;if(e&&n.FeatureTest.isOffscreenCanvasSupported)s=new OffscreenCanvas(t,t).getContext("2d",{alpha:!1});else{const e=document.createElement("canvas");e.width=e.height=t;s=e.getContext("2d",{alpha:!1})}return s}function appendText(t,e,s){const i=document.createElement("span"),l={angle:0,canvasWidth:0,hasText:""!==e.str,hasEOL:e.hasEOL,fontSize:0};t._textDivs.push(i);const c=n.Util.transform(t._transform,e.transform);let h=Math.atan2(c[1],c[0]);const d=s[e.fontName];d.vertical&&(h+=Math.PI/2);const u=Math.hypot(c[2],c[3]),p=u*function getAscent(t,e){const s=o.get(t);if(s)return s;const n=getCtx(a,e);n.font=`${a}px ${t}`;const i=n.measureText("");let l=i.fontBoundingBoxAscent,c=Math.abs(i.fontBoundingBoxDescent);if(l){const e=l/(l+c);o.set(t,e);n.canvas.width=n.canvas.height=0;return e}n.strokeStyle="red";n.clearRect(0,0,a,a);n.strokeText("g",0,0);let h=n.getImageData(0,0,a,a).data;c=0;for(let t=h.length-1-3;t>=0;t-=4)if(h[t]>0){c=Math.ceil(t/4/a);break}n.clearRect(0,0,a,a);n.strokeText("A",0,a);h=n.getImageData(0,0,a,a).data;l=0;for(let t=0,e=h.length;t<e;t+=4)if(h[t]>0){l=a-Math.floor(t/4/a);break}n.canvas.width=n.canvas.height=0;if(l){const e=l/(l+c);o.set(t,e);return e}o.set(t,r);return r}(d.fontFamily,t._isOffscreenCanvasSupported);let g,f;if(0===h){g=c[4];f=c[5]-p}else{g=c[4]+p*Math.sin(h);f=c[5]-p*Math.cos(h)}const m="calc(var(--scale-factor)*",b=i.style;if(t._container===t._rootContainer){b.left=`${(100*g/t._pageWidth).toFixed(2)}%`;b.top=`${(100*f/t._pageHeight).toFixed(2)}%`}else{b.left=`${m}${g.toFixed(2)}px)`;b.top=`${m}${f.toFixed(2)}px)`}b.fontSize=`${m}${u.toFixed(2)}px)`;b.fontFamily=d.fontFamily;l.fontSize=u;i.setAttribute("role","presentation");i.textContent=e.str;i.dir=e.dir;t._fontInspectorEnabled&&(i.dataset.fontName=e.fontName);0!==h&&(l.angle=h*(180/Math.PI));let A=!1;if(e.str.length>1)A=!0;else if(" "!==e.str&&e.transform[0]!==e.transform[3]){const t=Math.abs(e.transform[0]),s=Math.abs(e.transform[3]);t!==s&&Math.max(t,s)/Math.min(t,s)>1.5&&(A=!0)}A&&(l.canvasWidth=d.vertical?e.height:e.width);t._textDivProperties.set(i,l);t._isReadableStream&&t._layoutText(i)}function layout(t){const{div:e,scale:s,properties:n,ctx:i,prevFontSize:a,prevFontFamily:r}=t,{style:o}=e;let l="";if(0!==n.canvasWidth&&n.hasText){const{fontFamily:c}=o,{canvasWidth:h,fontSize:d}=n;if(a!==d||r!==c){i.font=`${d*s}px ${c}`;t.prevFontSize=d;t.prevFontFamily=c}const{width:u}=i.measureText(e.textContent);u>0&&(l=`scaleX(${h*s/u})`)}0!==n.angle&&(l=`rotate(${n.angle}deg) ${l}`);l.length>0&&(o.transform=l)}class TextLayerRenderTask{constructor({textContentSource:t,container:e,viewport:s,textDivs:a,textDivProperties:r,textContentItemsStr:o,isOffscreenCanvasSupported:l}){this._textContentSource=t;this._isReadableStream=t instanceof ReadableStream;this._container=this._rootContainer=e;this._textDivs=a||[];this._textContentItemsStr=o||[];this._isOffscreenCanvasSupported=l;this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled;this._reader=null;this._textDivProperties=r||new WeakMap;this._canceled=!1;this._capability=new n.PromiseCapability;this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:s.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:getCtx(0,l)};const{pageWidth:c,pageHeight:h,pageX:d,pageY:u}=s.rawDims;this._transform=[1,0,0,-1,-d,u+h];this._pageWidth=c;this._pageHeight=h;(0,i.setLayerDimensions)(e,s);this._capability.promise.finally((()=>{this._layoutTextParams=null})).catch((()=>{}))}get promise(){return this._capability.promise}cancel(){this._canceled=!0;if(this._reader){this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch((()=>{}));this._reader=null}this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(t,e){for(const s of t)if(void 0!==s.str){this._textContentItemsStr.push(s.str);appendText(this,s,e)}else if("beginMarkedContentProps"===s.type||"beginMarkedContent"===s.type){const t=this._container;this._container=document.createElement("span");this._container.classList.add("markedContent");null!==s.id&&this._container.setAttribute("id",`${s.id}`);t.append(this._container)}else"endMarkedContent"===s.type&&(this._container=this._container.parentNode)}_layoutText(t){const e=this._layoutTextParams.properties=this._textDivProperties.get(t);this._layoutTextParams.div=t;layout(this._layoutTextParams);e.hasText&&this._container.append(t);if(e.hasEOL){const t=document.createElement("br");t.setAttribute("role","presentation");this._container.append(t)}}_render(){const t=new n.PromiseCapability;let e=Object.create(null);if(this._isReadableStream){const pump=()=>{this._reader.read().then((({value:s,done:n})=>{if(n)t.resolve();else{Object.assign(e,s.styles);this._processItems(s.items,e);pump()}}),t.reject)};this._reader=this._textContentSource.getReader();pump()}else{if(!this._textContentSource)throw new Error('No "textContentSource" parameter specified.');{const{items:e,styles:s}=this._textContentSource;this._processItems(e,s);t.resolve()}}t.promise.then((()=>{e=null;!function render(t){if(t._canceled)return;const e=t._textDivs,s=t._capability;if(e.length>1e5)s.resolve();else{if(!t._isReadableStream)for(const s of e)t._layoutText(s);s.resolve()}}(this)}),this._capability.reject)}}e.TextLayerRenderTask=TextLayerRenderTask},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.AnnotationEditorLayer=void 0;var n=s(1),i=s(4),a=s(5),r=s(28),o=s(33),l=s(6);class AnnotationEditorLayer{#Gt;#zt=!1;#Vt=null;#Xt=this.pointerup.bind(this);#$t=this.pointerdown.bind(this);#Kt=new Map;#Yt=!1;#Jt=!1;#Qt=!1;#Zt;static _initialized=!1;constructor(t){if(!AnnotationEditorLayer._initialized){AnnotationEditorLayer._initialized=!0;r.FreeTextEditor.initialize(t.l10n);o.InkEditor.initialize(t.l10n)}t.uiManager.registerEditorTypes([r.FreeTextEditor,o.InkEditor]);this.#Zt=t.uiManager;this.pageIndex=t.pageIndex;this.div=t.div;this.#Gt=t.accessibilityManager;this.#Vt=t.annotationLayer;this.viewport=t.viewport;this.#Zt.addLayer(this)}get isEmpty(){return 0===this.#Kt.size}updateToolbar(t){this.#Zt.updateToolbar(t)}updateMode(t=this.#Zt.getMode()){this.#te();if(t===n.AnnotationEditorType.INK){this.addInkEditorIfNeeded(!1);this.disableClick()}else this.enableClick();this.#Zt.unselectAll();if(t!==n.AnnotationEditorType.NONE){this.div.classList.toggle("freeTextEditing",t===n.AnnotationEditorType.FREETEXT);this.div.classList.toggle("inkEditing",t===n.AnnotationEditorType.INK);this.div.hidden=!1}}addInkEditorIfNeeded(t){if(!t&&this.#Zt.getMode()!==n.AnnotationEditorType.INK)return;if(!t)for(const t of this.#Kt.values())if(t.isEmpty()){t.setInBackground();return}this.#ee({offsetX:0,offsetY:0}).setInBackground()}setEditingState(t){this.#Zt.setEditingState(t)}addCommands(t){this.#Zt.addCommands(t)}enable(){this.div.style.pointerEvents="auto";const t=new Set;for(const e of this.#Kt.values()){e.enableEditing();e.annotationElementId&&t.add(e.annotationElementId)}if(!this.#Vt)return;const e=this.#Vt.getEditableAnnotations();for(const s of e){s.hide();if(this.#Zt.isDeletedAnnotationElement(s.data.id))continue;if(t.has(s.data.id))continue;const e=this.deserialize(s);if(e){this.addOrRebuild(e);e.enableEditing()}}}disable(){this.#Qt=!0;this.div.style.pointerEvents="none";const t=new Set;for(const e of this.#Kt.values()){e.disableEditing();if(e.annotationElementId&&null===e.serialize()){this.getEditableAnnotation(e.annotationElementId)?.show();e.remove()}else t.add(e.annotationElementId)}if(this.#Vt){const e=this.#Vt.getEditableAnnotations();for(const s of e){const{id:e}=s.data;t.has(e)||this.#Zt.isDeletedAnnotationElement(e)||s.show()}}this.#te();this.isEmpty&&(this.div.hidden=!0);this.#Qt=!1}getEditableAnnotation(t){return this.#Vt?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#Zt.getActive()!==t&&this.#Zt.setActiveEditor(t)}enableClick(){this.div.addEventListener("pointerdown",this.#$t);this.div.addEventListener("pointerup",this.#Xt)}disableClick(){this.div.removeEventListener("pointerdown",this.#$t);this.div.removeEventListener("pointerup",this.#Xt)}attach(t){this.#Kt.set(t.id,t);const{annotationElementId:e}=t;e&&this.#Zt.isDeletedAnnotationElement(e)&&this.#Zt.removeDeletedAnnotationElement(t)}detach(t){this.#Kt.delete(t.id);this.#Gt?.removePointerInTextLayer(t.contentDiv);!this.#Qt&&t.annotationElementId&&this.#Zt.addDeletedAnnotationElement(t)}remove(t){this.detach(t);this.#Zt.removeEditor(t);t.div.style.display="none";setTimeout((()=>{t.div.style.display="";t.div.remove();t.isAttachedToDOM=!1;document.activeElement===document.body&&this.#Zt.focusMainContainer()}),0);this.#Jt||this.addInkEditorIfNeeded(!1)}#se(t){if(t.parent!==this){if(t.annotationElementId){this.#Zt.addDeletedAnnotationElement(t.annotationElementId);i.AnnotationEditor.deleteAnnotationElement(t);t.annotationElementId=null}this.attach(t);t.parent?.detach(t);t.setParent(this);if(t.div&&t.isAttachedToDOM){t.div.remove();this.div.append(t.div)}}}add(t){this.#se(t);this.#Zt.addEditor(t);this.attach(t);if(!t.isAttachedToDOM){const e=t.render();this.div.append(e);t.isAttachedToDOM=!0}this.moveEditorInDOM(t);t.onceAdded();this.#Zt.addToAnnotationStorage(t)}moveEditorInDOM(t){this.#Gt?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?t.rebuild():this.add(t)}getNextId(){return this.#Zt.getId()}#ne(t){switch(this.#Zt.getMode()){case n.AnnotationEditorType.FREETEXT:return new r.FreeTextEditor(t);case n.AnnotationEditorType.INK:return new o.InkEditor(t)}return null}deserialize(t){switch(t.annotationType??t.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return r.FreeTextEditor.deserialize(t,this,this.#Zt);case n.AnnotationEditorType.INK:return o.InkEditor.deserialize(t,this,this.#Zt)}return null}#ee(t){const e=this.getNextId(),s=this.#ne({parent:this,id:e,x:t.offsetX,y:t.offsetY,uiManager:this.#Zt});s&&this.add(s);return s}setSelected(t){this.#Zt.setSelected(t)}toggleSelected(t){this.#Zt.toggleSelected(t)}isSelected(t){return this.#Zt.isSelected(t)}unselect(t){this.#Zt.unselect(t)}pointerup(t){const{isMac:e}=n.FeatureTest.platform;if(!(0!==t.button||t.ctrlKey&&e)&&t.target===this.div&&this.#Yt){this.#Yt=!1;this.#zt?this.#ee(t):this.#zt=!0}}pointerdown(t){const{isMac:e}=n.FeatureTest.platform;if(0!==t.button||t.ctrlKey&&e)return;if(t.target!==this.div)return;this.#Yt=!0;const s=this.#Zt.getActive();this.#zt=!s||s.isEmpty()}drop(t){const e=t.dataTransfer.getData("text/plain"),s=this.#Zt.getEditor(e);if(!s)return;t.preventDefault();t.dataTransfer.dropEffect="move";this.#se(s);const n=this.div.getBoundingClientRect(),i=t.clientX-n.x,a=t.clientY-n.y;s.translate(i-s.startX,a-s.startY);this.moveEditorInDOM(s);s.div.focus()}dragover(t){t.preventDefault()}destroy(){this.#Zt.getActive()?.parent===this&&this.#Zt.setActiveEditor(null);for(const t of this.#Kt.values()){this.#Gt?.removePointerInTextLayer(t.contentDiv);t.setParent(null);t.isAttachedToDOM=!1;t.div.remove()}this.div=null;this.#Kt.clear();this.#Zt.removeLayer(this)}#te(){this.#Jt=!0;for(const t of this.#Kt.values())t.isEmpty()&&t.remove();this.#Jt=!1}render({viewport:t}){this.viewport=t;(0,l.setLayerDimensions)(this.div,t);(0,a.bindEvents)(this,this.div,["dragover","drop"]);for(const t of this.#Zt.getEditors(this.pageIndex))this.add(t);this.updateMode()}update({viewport:t}){this.#Zt.commitOrRemove();this.viewport=t;(0,l.setLayerDimensions)(this.div,{rotation:t.rotation});this.updateMode()}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}}e.AnnotationEditorLayer=AnnotationEditorLayer},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.FreeTextEditor=void 0;var n=s(1),i=s(5),a=s(4),r=s(29);class FreeTextEditor extends a.AnnotationEditor{#ie=this.editorDivBlur.bind(this);#ae=this.editorDivFocus.bind(this);#re=this.editorDivInput.bind(this);#oe=this.editorDivKeydown.bind(this);#le;#ce="";#he=`${this.id}-editor`;#de;#ue=null;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){return(0,n.shadow)(this,"_keyboardManager",new i.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],FreeTextEditor.prototype.commitOrRemove,!0],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],FreeTextEditor.prototype.commitOrRemove]]))}static _type="freetext";constructor(t){super({...t,name:"freeTextEditor"});this.#le=t.color||FreeTextEditor._defaultColor||a.AnnotationEditor._defaultLineColor;this.#de=t.fontSize||FreeTextEditor._defaultFontSize}static initialize(t){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map((e=>[e,t.get(e)])));const e=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(e.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case n.AnnotationEditorParamsType.FREETEXT_SIZE:FreeTextEditor._defaultFontSize=e;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:FreeTextEditor._defaultColor=e}}updateParams(t,e){switch(t){case n.AnnotationEditorParamsType.FREETEXT_SIZE:this.#pe(e);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:this.#ge(e)}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,FreeTextEditor._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,FreeTextEditor._defaultColor||a.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,this.#de],[n.AnnotationEditorParamsType.FREETEXT_COLOR,this.#le]]}#pe(t){const setFontsize=t=>{this.editorDiv.style.fontSize=`calc(${t}px * var(--scale-factor))`;this.translate(0,-(t-this.#de)*this.parentScale);this.#de=t;this.#fe()},e=this.#de;this.addCommands({cmd:()=>{setFontsize(t)},undo:()=>{setFontsize(e)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#ge(t){const e=this.#le;this.addCommands({cmd:()=>{this.#le=this.editorDiv.style.color=t},undo:()=>{this.#le=this.editorDiv.style.color=e},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){const t=this.parentScale;return[-FreeTextEditor._internalPadding*t,-(FreeTextEditor._internalPadding+this.#de)*t]}rebuild(){super.rebuild();null!==this.div&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){if(!this.isInEditMode()){this.parent.setEditingState(!1);this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT);super.enableEditMode();this.overlayDiv.classList.remove("enabled");this.editorDiv.contentEditable=!0;this.div.draggable=!1;this.div.removeAttribute("aria-activedescendant");this.editorDiv.addEventListener("keydown",this.#oe);this.editorDiv.addEventListener("focus",this.#ae);this.editorDiv.addEventListener("blur",this.#ie);this.editorDiv.addEventListener("input",this.#re)}}disableEditMode(){if(this.isInEditMode()){this.parent.setEditingState(!0);super.disableEditMode();this.overlayDiv.classList.add("enabled");this.editorDiv.contentEditable=!1;this.div.setAttribute("aria-activedescendant",this.#he);this.div.draggable=!0;this.editorDiv.removeEventListener("keydown",this.#oe);this.editorDiv.removeEventListener("focus",this.#ae);this.editorDiv.removeEventListener("blur",this.#ie);this.editorDiv.removeEventListener("input",this.#re);this.div.focus({preventScroll:!0});this.isEditing=!1;this.parent.div.classList.add("freeTextEditing")}}focusin(t){super.focusin(t);t.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){if(this.width)this.#me();else{this.enableEditMode();this.editorDiv.focus()}}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1;this.parent.setEditingState(!0);this.parent.div.classList.add("freeTextEditing");super.remove()}#be(){const t=this.editorDiv.getElementsByTagName("div");if(0===t.length)return this.editorDiv.innerText;const e=[];for(const s of t)e.push(s.innerText.replace(/\r\n?|\n/,""));return e.join("\n")}#fe(){const[t,e]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:t,div:e}=this,n=e.style.display;e.style.display="hidden";t.div.append(this.div);s=e.getBoundingClientRect();e.remove();e.style.display=n}this.width=s.width/t;this.height=s.height/e}commit(){if(!this.isInEditMode())return;super.commit();this.disableEditMode();const t=this.#ce,e=this.#ce=this.#be().trimEnd();if(t===e)return;const setText=t=>{this.#ce=t;if(t){this.#Ae();this.rebuild();this.#fe()}else this.remove()};this.addCommands({cmd:()=>{setText(e)},undo:()=>{setText(t)},mustExec:!1});this.#fe()}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(t){this.enableEditMode();this.editorDiv.focus()}keydown(t){if(t.target===this.div&&"Enter"===t.key){this.enableEditMode();this.editorDiv.focus()}}editorDivKeydown(t){FreeTextEditor._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment");this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox");this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;if(this.width){t=this.x;e=this.y}super.render();this.editorDiv=document.createElement("div");this.editorDiv.className="internal";this.editorDiv.setAttribute("id",this.#he);this.enableEditing();FreeTextEditor._l10nPromise.get("editor_free_text2_aria_label").then((t=>this.editorDiv?.setAttribute("aria-label",t)));FreeTextEditor._l10nPromise.get("free_text2_default_content").then((t=>this.editorDiv?.setAttribute("default-content",t)));this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;s.fontSize=`calc(${this.#de}px * var(--scale-factor))`;s.color=this.#le;this.div.append(this.editorDiv);this.overlayDiv=document.createElement("div");this.overlayDiv.classList.add("overlay","enabled");this.div.append(this.overlayDiv);(0,i.bindEvents)(this,this.div,["dblclick","keydown"]);if(this.width){const[s,n]=this.parentDimensions;if(this.annotationElementId){const[i]=this.getInitialTranslation();this.setAt(t*s,e*n,i,i)}else this.setAt(t*s,e*n,this.width*s,this.height*n);this.#Ae();this.div.draggable=!0;this.editorDiv.contentEditable=!1}else{this.div.draggable=!1;this.editorDiv.contentEditable=!0}return this.div}#Ae(){this.editorDiv.replaceChildren();if(this.#ce)for(const t of this.#ce.split("\n")){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br"));this.editorDiv.append(e)}}get contentDiv(){return this.editorDiv}static deserialize(t,e,s){let i=null;if(t instanceof r.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:e,fontColor:s},rect:a,rotation:r,id:o},textContent:l,parent:{page:{pageNumber:c}}}=t;if(!l||0===l.length)return null;i=t={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(s),fontSize:e,value:l.join("\n"),pageIndex:c-1,rect:a,rotation:r,id:o,deleted:!1}}const a=super.deserialize(t,e,s);a.#de=t.fontSize;a.#le=n.Util.makeHexColor(...t.color);a.#ce=t.value;a.annotationElementId=t.id||null;a.#ue=i;return a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const e=FreeTextEditor._internalPadding*this.parentScale,s=this.getRect(e,e),i=a.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#le),r={annotationType:n.AnnotationEditorType.FREETEXT,color:i,fontSize:this.#de,value:this.#ce,pageIndex:this.pageIndex,rect:s,rotation:this.rotation};if(t)return r;if(this.annotationElementId&&!this.#_e(r))return null;r.id=this.annotationElementId;return r}#_e(t){const{value:e,fontSize:s,color:n,rect:i,pageIndex:a}=this.#ue;return t.value!==e||t.fontSize!==s||t.rect.some(((t,e)=>Math.abs(t-i[e])>=1))||t.color.some(((t,e)=>t!==n[e]))||t.pageIndex!==a}#me(t=!1){if(!this.annotationElementId)return;this.#fe();if(!t&&(0===this.width||0===this.height)){setTimeout((()=>this.#me(!0)),0);return}const e=FreeTextEditor._internalPadding*this.parentScale;this.#ue.rect=this.getRect(e,e)}}e.FreeTextEditor=FreeTextEditor},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=s(1),i=s(6),a=s(3),r=s(30),o=s(31);const l=1e3,c=new WeakSet;function getRectDims(t){return{width:t[2]-t[0],height:t[3]-t[1]}}class AnnotationElementFactory{static create(t){switch(t.data.annotationType){case n.AnnotationType.LINK:return new LinkAnnotationElement(t);case n.AnnotationType.TEXT:return new TextAnnotationElement(t);case n.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new TextWidgetAnnotationElement(t);case"Btn":return t.data.radioButton?new RadioButtonWidgetAnnotationElement(t):t.data.checkBox?new CheckboxWidgetAnnotationElement(t):new PushButtonWidgetAnnotationElement(t);case"Ch":return new ChoiceWidgetAnnotationElement(t);case"Sig":return new SignatureWidgetAnnotationElement(t)}return new WidgetAnnotationElement(t);case n.AnnotationType.POPUP:return new PopupAnnotationElement(t);case n.AnnotationType.FREETEXT:return new FreeTextAnnotationElement(t);case n.AnnotationType.LINE:return new LineAnnotationElement(t);case n.AnnotationType.SQUARE:return new SquareAnnotationElement(t);case n.AnnotationType.CIRCLE:return new CircleAnnotationElement(t);case n.AnnotationType.POLYLINE:return new PolylineAnnotationElement(t);case n.AnnotationType.CARET:return new CaretAnnotationElement(t);case n.AnnotationType.INK:return new InkAnnotationElement(t);case n.AnnotationType.POLYGON:return new PolygonAnnotationElement(t);case n.AnnotationType.HIGHLIGHT:return new HighlightAnnotationElement(t);case n.AnnotationType.UNDERLINE:return new UnderlineAnnotationElement(t);case n.AnnotationType.SQUIGGLY:return new SquigglyAnnotationElement(t);case n.AnnotationType.STRIKEOUT:return new StrikeOutAnnotationElement(t);case n.AnnotationType.STAMP:return new StampAnnotationElement(t);case n.AnnotationType.FILEATTACHMENT:return new FileAttachmentAnnotationElement(t);default:return new AnnotationElement(t)}}}class AnnotationElement{constructor(t,{isRenderable:e=!1,ignoreBorder:s=!1,createQuadrilaterals:n=!1}={}){this.isRenderable=e;this.data=t.data;this.layer=t.layer;this.linkService=t.linkService;this.downloadManager=t.downloadManager;this.imageResourcesPath=t.imageResourcesPath;this.renderForms=t.renderForms;this.svgFactory=t.svgFactory;this.annotationStorage=t.annotationStorage;this.enableScripting=t.enableScripting;this.hasJSActions=t.hasJSActions;this._fieldObjects=t.fieldObjects;this.parent=t.parent;e&&(this.container=this._createContainer(s));n&&(this.quadrilaterals=this._createQuadrilaterals(s))}_createContainer(t){const{data:e,parent:{page:s,viewport:i}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id);a.style.zIndex=this.parent.zIndex++;this.data.popupRef&&a.setAttribute("aria-haspopup","dialog");e.noRotate&&a.classList.add("norotate");const{pageWidth:r,pageHeight:o,pageX:l,pageY:c}=i.rawDims;if(!e.rect||this instanceof PopupAnnotationElement){const{rotation:t}=e;e.hasOwnCanvas||0===t||this.setRotation(t,a);return a}const{width:h,height:d}=getRectDims(e.rect),u=n.Util.normalizeRect([e.rect[0],s.view[3]-e.rect[1]+s.view[1],e.rect[2],s.view[3]-e.rect[3]+s.view[1]]);if(!t&&e.borderStyle.width>0){a.style.borderWidth=`${e.borderStyle.width}px`;const t=e.borderStyle.horizontalCornerRadius,s=e.borderStyle.verticalCornerRadius;if(t>0||s>0){const e=`calc(${t}px * var(--scale-factor)) / calc(${s}px * var(--scale-factor))`;a.style.borderRadius=e}else if(this instanceof RadioButtonWidgetAnnotationElement){const t=`calc(${h}px * var(--scale-factor)) / calc(${d}px * var(--scale-factor))`;a.style.borderRadius=t}switch(e.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:a.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:a.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:a.style.borderBottomStyle="solid"}const i=e.borderColor||null;i?a.style.borderColor=n.Util.makeHexColor(0|i[0],0|i[1],0|i[2]):a.style.borderWidth=0}a.style.left=100*(u[0]-l)/r+"%";a.style.top=100*(u[1]-c)/o+"%";const{rotation:p}=e;if(e.hasOwnCanvas||0===p){a.style.width=100*h/r+"%";a.style.height=100*d/o+"%"}else this.setRotation(p,a);return a}setRotation(t,e=this.container){const{pageWidth:s,pageHeight:n}=this.parent.viewport.rawDims,{width:i,height:a}=getRectDims(this.data.rect);let r,o;if(t%180==0){r=100*i/s;o=100*a/n}else{r=100*a/s;o=100*i/n}e.style.width=`${r}%`;e.style.height=`${o}%`;e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const setColor=(t,e,s)=>{const n=s.detail[t];s.target.style[e]=r.ColorConverters[`${n[0]}_HTML`](n.slice(1))};return(0,n.shadow)(this,"_commonActions",{display:t=>{const e=t.detail.display%2==1;this.container.style.visibility=e?"hidden":"visible";this.annotationStorage.setValue(this.data.id,{hidden:e,print:0===t.detail.display||3===t.detail.display})},print:t=>{this.annotationStorage.setValue(this.data.id,{print:t.detail.print})},hidden:t=>{this.container.style.visibility=t.detail.hidden?"hidden":"visible";this.annotationStorage.setValue(this.data.id,{hidden:t.detail.hidden})},focus:t=>{setTimeout((()=>t.target.focus({preventScroll:!1})),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.detail.readonly?t.target.setAttribute("readonly",""):t.target.removeAttribute("readonly")},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{setColor("bgColor","backgroundColor",t)},fillColor:t=>{setColor("fillColor","backgroundColor",t)},fgColor:t=>{setColor("fgColor","color",t)},textColor:t=>{setColor("textColor","color",t)},borderColor:t=>{setColor("borderColor","borderColor",t)},strokeColor:t=>{setColor("strokeColor","borderColor",t)},rotation:t=>{const e=t.detail.rotation;this.setRotation(e);this.annotationStorage.setValue(this.data.id,{rotation:e})}})}_dispatchEventFromSandbox(t,e){const s=this._commonActions;for(const n of Object.keys(e.detail)){const i=t[n]||s[n];i?.(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const s=this._commonActions;for(const[n,i]of Object.entries(e)){const a=s[n];if(a){a({detail:{[n]:i},target:t});delete e[n]}}}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const e=[],s=this.data.rect;let n=null;for(const s of this.data.quadPoints){this.data.rect=[s[2].x,s[2].y,s[1].x,s[1].y];e.push(this._createContainer(t));n||=this.data.rect}this.data.rect=s;this.firstQuadRect=n;return e}_createPopup(){const{container:t,data:e}=this;t.setAttribute("aria-haspopup","dialog");const s=new PopupAnnotationElement({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:this.firstQuadRect||e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(s.render())}_renderQuadrilaterals(t){for(const e of this.quadrilaterals)e.classList.add(t);return this.quadrilaterals}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:t,id:a,exportValues:r}of i){if(-1===t)continue;if(a===e)continue;const i="string"==typeof r?r:null,o=document.querySelector(`[data-element-id="${a}"]`);!o||c.has(o)?s.push({id:a,exportValue:i,domElement:o}):(0,n.warn)(`_getElementsByName - element not allowed: ${a}`)}return s}for(const n of document.getElementsByName(t)){const{exportValue:t}=n,i=n.getAttribute("data-element-id");i!==e&&(c.has(n)&&s.push({id:i,exportValue:t,domElement:n}))}return s}show(){this.container&&(this.container.hidden=!1);this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0);this.popup?.forceHide()}getElementsToTriggerPopup(){return this.quadrilaterals||this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}}class LinkAnnotationElement extends AnnotationElement{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0});this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let n=!1;if(t.url){e.addLinkAttributes(s,t.url,t.newWindow);n=!0}else if(t.action){this._bindNamedAction(s,t.action);n=!0}else if(t.attachment){this._bindAttachment(s,t.attachment);n=!0}else if(t.setOCGState){this.#ye(s,t.setOCGState);n=!0}else if(t.dest){this._bindLink(s,t.dest);n=!0}else{if(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions){this._bindJSAction(s,t);n=!0}if(t.resetForm){this._bindResetFormAction(s,t.resetForm);n=!0}else if(this.isTooltipOnly&&!n){this._bindLink(s,"");n=!0}}if(this.quadrilaterals)return this._renderQuadrilaterals("linkAnnotation").map(((t,e)=>{const n=0===e?s:s.cloneNode();t.append(n);return t}));this.container.classList.add("linkAnnotation");n&&this.container.append(s);return this.container}#ve(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e);t.onclick=()=>{e&&this.linkService.goToDestination(e);return!1};(e||""===e)&&this.#ve()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl("");t.onclick=()=>{this.linkService.executeNamedAction(e);return!1};this.#ve()}_bindAttachment(t,e){t.href=this.linkService.getAnchorUrl("");t.onclick=()=>{this.downloadManager?.openOrDownloadData(this.container,e.content,e.filename);return!1};this.#ve()}#ye(t,e){t.href=this.linkService.getAnchorUrl("");t.onclick=()=>{this.linkService.executeSetOCGState(e);return!1};this.#ve()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(e.actions)){const i=s.get(n);i&&(t[i]=()=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:n}});return!1})}t.onclick||(t.onclick=()=>!1);this.#ve()}_bindResetFormAction(t,e){const s=t.onclick;s||(t.href=this.linkService.getAnchorUrl(""));this.#ve();if(this._fieldObjects)t.onclick=()=>{s?.();const{fields:t,refs:i,include:a}=e,r=[];if(0!==t.length||0!==i.length){const e=new Set(i);for(const s of t){const t=this._fieldObjects[s]||[];for(const{id:s}of t)e.add(s)}for(const t of Object.values(this._fieldObjects))for(const s of t)e.has(s.id)===a&&r.push(s)}else for(const t of Object.values(this._fieldObjects))r.push(...t);const o=this.annotationStorage,l=[];for(const t of r){const{id:e}=t;l.push(e);switch(t.type){case"text":{const s=t.defaultValue||"";o.setValue(e,{value:s});break}case"checkbox":case"radiobutton":{const s=t.defaultValue===t.exportValues;o.setValue(e,{value:s});break}case"combobox":case"listbox":{const s=t.defaultValue||"";o.setValue(e,{value:s});break}default:continue}const s=document.querySelector(`[data-element-id="${e}"]`);s&&(c.has(s)?s.dispatchEvent(new Event("resetform")):(0,n.warn)(`_bindResetFormAction - element not allowed: ${e}`))}this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:l,name:"ResetForm"}});return!1};else{(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.');s||(t.onclick=()=>!1)}}}class TextAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str)})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg";t.alt="[{{type}} Annotation]";t.dataset.l10nId="text_annotation_type";t.dataset.l10nArgs=JSON.stringify({type:this.data.name});this.data.popupRef||this._createPopup();this.container.append(t);return this.container}}class WidgetAnnotationElement extends AnnotationElement{render(){this.data.alternativeText&&(this.container.title=this.data.alternativeText);return this.container}showElementAndHideCanvas(t){if(this.data.hasOwnCanvas){"CANVAS"===t.previousSibling?.nodeName&&(t.previousSibling.hidden=!0);t.hidden=!1}}_getKeyModifier(t){const{isWin:e,isMac:s}=n.FeatureTest.platform;return e&&t.ctrlKey||s&&t.metaKey}_setEventListener(t,e,s,n){e.includes("mouse")?t.addEventListener(e,(t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(t),shift:t.shiftKey,modifier:this._getKeyModifier(t)}})})):t.addEventListener(e,(t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(t)}})}))}_setEventListeners(t,e,s){for(const[n,i]of e)("Action"===i||this.data.actions?.[i])&&this._setEventListener(t,n,i,s)}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=null===e?"transparent":n.Util.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||9,a=t.style;let r;const roundToOneDecimal=t=>Math.round(10*t)/10;if(this.data.multiLine){const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2),e=t/(Math.round(t/(n.LINE_FACTOR*i))||1);r=Math.min(i,roundToOneDecimal(e/n.LINE_FACTOR))}else{const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2);r=Math.min(i,roundToOneDecimal(t/n.LINE_FACTOR))}a.fontSize=`calc(${r}px * var(--scale-factor))`;a.color=n.Util.makeHexColor(s[0],s[1],s[2]);null!==this.data.textAlignment&&(a.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required");t.setAttribute("aria-required",e)}}class TextWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,e,s,n){const i=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id)){a.domElement&&(a.domElement[e]=s);i.setValue(a.id,{[n]:s})}}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const n=t.getValue(e,{value:this.data.fieldValue});let i=n.value||"";const a=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;a&&i.length>a&&(i=i.slice(0,a));let r=n.formattedValue||this.data.textContent?.join("\n")||null;r&&this.data.comb&&(r=r.replaceAll(/\s+/g,""));const o={userValue:i,formattedValue:r,lastCommittedValue:null,commitKey:1};if(this.data.multiLine){s=document.createElement("textarea");s.textContent=r??i;this.data.doNotScroll&&(s.style.overflowY="hidden")}else{s=document.createElement("input");s.type="text";s.setAttribute("value",r??i);this.data.doNotScroll&&(s.style.overflowX="hidden")}this.data.hasOwnCanvas&&(s.hidden=!0);c.add(s);s.setAttribute("data-element-id",e);s.disabled=this.data.readOnly;s.name=this.data.baseFieldName||this.data.fieldName;s.tabIndex=l;this._setRequired(s,this.data.required);a&&(s.maxLength=a);s.addEventListener("input",(n=>{t.setValue(e,{value:n.target.value});this.setPropertyOnSiblings(s,"value",n.target.value,"value");o.formattedValue=null}));s.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue??"";s.value=o.userValue=e;o.formattedValue=null}));let blurListener=t=>{const{formattedValue:e}=o;null!=e&&(t.target.value=e);t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",(t=>{const{target:e}=t;o.userValue&&(e.value=o.userValue);o.lastCommittedValue=e.value;o.commitKey=1}));s.addEventListener("updatefromsandbox",(s=>{this.showElementAndHideCanvas(s.target);const n={value(s){o.userValue=s.detail.value??"";t.setValue(e,{value:o.userValue.toString()});s.target.value=o.userValue},formattedValue(s){const{formattedValue:n}=s.detail;o.formattedValue=n;null!=n&&s.target!==document.activeElement&&(s.target.value=n);t.setValue(e,{formattedValue:n})},selRange(t){t.target.setSelectionRange(...t.detail.selRange)},charLimit:s=>{const{charLimit:n}=s.detail,{target:i}=s;if(0===n){i.removeAttribute("maxLength");return}i.setAttribute("maxLength",n);let a=o.userValue;if(a&&!(a.length<=n)){a=a.slice(0,n);i.value=o.userValue=a;t.setValue(e,{value:a});this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:a,willCommit:!0,commitKey:1,selStart:i.selectionStart,selEnd:i.selectionEnd}})}}};this._dispatchEventFromSandbox(n,s)}));s.addEventListener("keydown",(t=>{o.commitKey=1;let s=-1;"Escape"===t.key?s=0:"Enter"!==t.key||this.data.multiLine?"Tab"===t.key&&(o.commitKey=3):s=2;if(-1===s)return;const{value:n}=t.target;if(o.lastCommittedValue!==n){o.lastCommittedValue=n;o.userValue=n;this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:n,willCommit:!0,commitKey:s,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}})}}));const n=blurListener;blurListener=null;s.addEventListener("blur",(t=>{if(!t.relatedTarget)return;const{value:s}=t.target;o.userValue=s;o.lastCommittedValue!==s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:s,willCommit:!0,commitKey:o.commitKey,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}});n(t)}));this.data.actions?.Keystroke&&s.addEventListener("beforeinput",(t=>{o.lastCommittedValue=null;const{data:s,target:n}=t,{value:i,selectionStart:a,selectionEnd:r}=n;let l=a,c=r;switch(t.inputType){case"deleteWordBackward":{const t=i.substring(0,a).match(/\w*[^\w]*$/);t&&(l-=t[0].length);break}case"deleteWordForward":{const t=i.substring(a).match(/^[^\w]*\w*/);t&&(c+=t[0].length);break}case"deleteContentBackward":a===r&&(l-=1);break;case"deleteContentForward":a===r&&(c+=1)}t.preventDefault();this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:i,change:s||"",willCommit:!1,selStart:l,selEnd:c}})}));this._setEventListeners(s,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.value))}blurListener&&s.addEventListener("blur",blurListener);if(this.data.comb){const t=(this.data.rect[2]-this.data.rect[0])/a;s.classList.add("comb");s.style.letterSpacing=`calc(${t}px * var(--scale-factor) - 1ch)`}}else{s=document.createElement("div");s.textContent=this.data.fieldValue;s.style.verticalAlign="middle";s.style.display="table-cell"}this._setTextStyle(s);this._setBackgroundColor(s);this._setDefaultPropertiesFromJS(s);this.container.append(s);return this.container}}class SignatureWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class CheckboxWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,s=e.id;let n=t.getValue(s,{value:e.exportValue===e.fieldValue}).value;if("string"==typeof n){n="Off"!==n;t.setValue(s,{value:n})}this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");c.add(i);i.setAttribute("data-element-id",s);i.disabled=e.readOnly;this._setRequired(i,this.data.required);i.type="checkbox";i.name=e.baseFieldName||e.fieldName;n&&i.setAttribute("checked",!0);i.setAttribute("exportValue",e.exportValue);i.tabIndex=l;i.addEventListener("change",(n=>{const{name:i,checked:a}=n.target;for(const n of this._getElementsByName(i,s)){const s=a&&n.exportValue===e.exportValue;n.domElement&&(n.domElement.checked=s);t.setValue(n.id,{value:s})}t.setValue(s,{value:a})}));i.addEventListener("resetform",(t=>{const s=e.defaultFieldValue||"Off";t.target.checked=s===e.exportValue}));if(this.enableScripting&&this.hasJSActions){i.addEventListener("updatefromsandbox",(e=>{const n={value(e){e.target.checked="Off"!==e.detail.value;t.setValue(s,{value:e.target.checked})}};this._dispatchEventFromSandbox(n,e)}));this._setEventListeners(i,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))}this._setBackgroundColor(i);this._setDefaultPropertiesFromJS(i);this.container.append(i);return this.container}}class RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,s=e.id;let n=t.getValue(s,{value:e.fieldValue===e.buttonValue}).value;if("string"==typeof n){n=n!==e.buttonValue;t.setValue(s,{value:n})}const i=document.createElement("input");c.add(i);i.setAttribute("data-element-id",s);i.disabled=e.readOnly;this._setRequired(i,this.data.required);i.type="radio";i.name=e.baseFieldName||e.fieldName;n&&i.setAttribute("checked",!0);i.tabIndex=l;i.addEventListener("change",(e=>{const{name:n,checked:i}=e.target;for(const e of this._getElementsByName(n,s))t.setValue(e.id,{value:!1});t.setValue(s,{value:i})}));i.addEventListener("resetform",(t=>{const s=e.defaultFieldValue;t.target.checked=null!=s&&s===e.buttonValue}));if(this.enableScripting&&this.hasJSActions){const n=e.buttonValue;i.addEventListener("updatefromsandbox",(e=>{const i={value:e=>{const i=n===e.detail.value;for(const n of this._getElementsByName(e.target.name)){const e=i&&n.id===s;n.domElement&&(n.domElement.checked=e);t.setValue(n.id,{value:e})}}};this._dispatchEventFromSandbox(i,e)}));this._setEventListeners(i,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))}this._setBackgroundColor(i);this._setDefaultPropertiesFromJS(i);this.container.append(i);return this.container}}class PushButtonWidgetAnnotationElement extends LinkAnnotationElement{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");this.data.alternativeText&&(t.title=this.data.alternativeText);const e=t.lastChild;if(this.enableScripting&&this.hasJSActions&&e){this._setDefaultPropertiesFromJS(e);e.addEventListener("updatefromsandbox",(t=>{this._dispatchEventFromSandbox({},t)}))}return t}}class ChoiceWidgetAnnotationElement extends WidgetAnnotationElement{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,s=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");c.add(n);n.setAttribute("data-element-id",e);n.disabled=this.data.readOnly;this._setRequired(n,this.data.required);n.name=this.data.baseFieldName||this.data.fieldName;n.tabIndex=l;let i=this.data.combo&&this.data.options.length>0;if(!this.data.combo){n.size=this.data.options.length;this.data.multiSelect&&(n.multiple=!0)}n.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue;for(const t of n.options)t.selected=t.value===e}));for(const t of this.data.options){const e=document.createElement("option");e.textContent=t.displayValue;e.value=t.exportValue;if(s.value.includes(t.exportValue)){e.setAttribute("selected",!0);i=!1}n.append(e)}let a=null;if(i){const t=document.createElement("option");t.value=" ";t.setAttribute("hidden",!0);t.setAttribute("selected",!0);n.prepend(t);a=()=>{t.remove();n.removeEventListener("input",a);a=null};n.addEventListener("input",a)}const getValue=t=>{const e=t?"value":"textContent",{options:s,multiple:i}=n;return i?Array.prototype.filter.call(s,(t=>t.selected)).map((t=>t[e])):-1===s.selectedIndex?null:s[s.selectedIndex][e]};let r=getValue(!1);const getItems=t=>{const e=t.target.options;return Array.prototype.map.call(e,(t=>({displayValue:t.textContent,exportValue:t.value})))};if(this.enableScripting&&this.hasJSActions){n.addEventListener("updatefromsandbox",(s=>{const i={value(s){a?.();const i=s.detail.value,o=new Set(Array.isArray(i)?i:[i]);for(const t of n.options)t.selected=o.has(t.value);t.setValue(e,{value:getValue(!0)});r=getValue(!1)},multipleSelection(t){n.multiple=!0},remove(s){const i=n.options,a=s.detail.remove;i[a].selected=!1;n.remove(a);if(i.length>0){-1===Array.prototype.findIndex.call(i,(t=>t.selected))&&(i[0].selected=!0)}t.setValue(e,{value:getValue(!0),items:getItems(s)});r=getValue(!1)},clear(s){for(;0!==n.length;)n.remove(0);t.setValue(e,{value:null,items:[]});r=getValue(!1)},insert(s){const{index:i,displayValue:a,exportValue:o}=s.detail.insert,l=n.children[i],c=document.createElement("option");c.textContent=a;c.value=o;l?l.before(c):n.append(c);t.setValue(e,{value:getValue(!0),items:getItems(s)});r=getValue(!1)},items(s){const{items:i}=s.detail;for(;0!==n.length;)n.remove(0);for(const t of i){const{displayValue:e,exportValue:s}=t,i=document.createElement("option");i.textContent=e;i.value=s;n.append(i)}n.options.length>0&&(n.options[0].selected=!0);t.setValue(e,{value:getValue(!0),items:getItems(s)});r=getValue(!1)},indices(s){const n=new Set(s.detail.indices);for(const t of s.target.options)t.selected=n.has(t.index);t.setValue(e,{value:getValue(!0)});r=getValue(!1)},editable(t){t.target.disabled=!t.detail.editable}};this._dispatchEventFromSandbox(i,s)}));n.addEventListener("input",(s=>{const n=getValue(!0);t.setValue(e,{value:n});s.preventDefault();this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:r,changeEx:n,willCommit:!1,commitKey:1,keyDown:!1}})}));this._setEventListeners(n,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],(t=>t.target.value))}else n.addEventListener("input",(function(s){t.setValue(e,{value:getValue(!0)})}));this.data.combo&&this._setTextStyle(n);this._setBackgroundColor(n);this._setDefaultPropertiesFromJS(n);this.container.append(n);return this.container}}class PopupAnnotationElement extends AnnotationElement{constructor(t){const{data:e,elements:s}=t;super(t,{isRenderable:!!(e.titleObj?.str||e.contentsObj?.str||e.richText?.str)});this.elements=s}render(){this.container.classList.add("popupAnnotation");const t=new PopupElement({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const s of this.elements){s.popup=t;e.push(s.data.id);s.addHighlightArea()}this.container.setAttribute("aria-controls",e.join(","));return this.container}}class PopupElement{#Se=null;#Ee=this.#xe.bind(this);#Ce=this.#we.bind(this);#Te=this.#Pe.bind(this);#le=null;#st=null;#Fe=null;#ke=null;#Me=null;#Re=null;#De=!1;#Ie=null;#Oe=null;#Le=null;#Ne=null;#Be=!1;constructor({container:t,color:e,elements:s,titleObj:n,modificationDate:a,contentsObj:r,richText:o,parent:l,rect:c,parentRect:h,open:d}){this.#st=t;this.#Ne=n;this.#Fe=r;this.#Le=o;this.#Me=l;this.#le=e;this.#Oe=c;this.#Re=h;this.#ke=s;const u=i.PDFDateString.toDateObject(a);u&&(this.#Se=l.l10n.get("annotation_date_string",{date:u.toLocaleDateString(),time:u.toLocaleTimeString()}));this.trigger=s.flatMap((t=>t.getElementsToTriggerPopup()));for(const t of this.trigger){t.addEventListener("click",this.#Te);t.addEventListener("mouseenter",this.#Ce);t.addEventListener("mouseleave",this.#Ee)}this.#st.hidden=!0;d&&this.#Pe()}render(){if(this.#Ie)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:s,pageX:i,pageY:a}}}=this.#Me,r=this.#Ie=document.createElement("div");r.className="popup";if(this.#le){const t=r.style.outlineColor=n.Util.makeHexColor(...this.#le);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))r.style.backgroundColor=`color-mix(in srgb, ${t} 30%, white)`;else{const t=.7;r.style.backgroundColor=n.Util.makeHexColor(...this.#le.map((e=>Math.floor(t*(255-e)+e))))}}const l=document.createElement("span");l.className="header";const c=document.createElement("h1");l.append(c);({dir:c.dir,str:c.textContent}=this.#Ne);r.append(l);if(this.#Se){const t=document.createElement("span");t.classList.add("popupDate");this.#Se.then((e=>{t.textContent=e}));l.append(t)}const h=this.#Fe,d=this.#Le;if(!d?.str||h?.str&&h.str!==d.str){const t=this._formatContents(h);r.append(t)}else{o.XfaLayer.render({xfaHtml:d.html,intent:"richText",div:r});r.lastChild.classList.add("richText","popupContent")}let u=!!this.#Re,p=u?this.#Re:this.#Oe;for(const t of this.#ke)if(!p||null!==n.Util.intersect(t.data.rect,p)){p=t.data.rect;u=!0;break}const g=n.Util.normalizeRect([p[0],t[3]-p[1]+t[1],p[2],t[3]-p[3]+t[1]]),f=u?p[2]-p[0]+5:0,m=g[0]+f,b=g[1],{style:A}=this.#st;A.left=100*(m-i)/e+"%";A.top=100*(b-a)/s+"%";this.#st.append(r)}_formatContents({str:t,dir:e}){const s=document.createElement("p");s.classList.add("popupContent");s.dir=e;const n=t.split(/(?:\r\n?|\n)/);for(let t=0,e=n.length;t<e;++t){const i=n[t];s.append(document.createTextNode(i));t<e-1&&s.append(document.createElement("br"))}return s}#Pe(){this.#De=!this.#De;if(this.#De){this.#we();this.#st.addEventListener("click",this.#Te)}else{this.#xe();this.#st.removeEventListener("click",this.#Te)}}#we(){this.#Ie||this.render();if(this.isVisible)this.#De&&this.#st.classList.add("focused");else{this.#st.hidden=!1;this.#st.style.zIndex=parseInt(this.#st.style.zIndex)+1e3}}#xe(){this.#st.classList.remove("focused");if(!this.#De){this.#st.hidden=!0;this.#st.style.zIndex=parseInt(this.#st.style.zIndex)-1e3}}forceHide(){this.#Be=this.isVisible;this.#Be&&(this.#st.hidden=!0)}maybeShow(){if(this.#Be){this.#Be=!1;this.#st.hidden=!1}}get isVisible(){return!1===this.#st.hidden}}class FreeTextAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0});this.textContent=t.data.textContent;this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){this.container.classList.add("freeTextAnnotation");if(this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent");t.setAttribute("role","comment");for(const e of this.textContent){const s=document.createElement("span");s.textContent=e;t.append(s)}this.container.append(t)}this.data.popupRef||this._createPopup();return this.container}}e.FreeTextAnnotationElement=FreeTextAnnotationElement;class LineAnnotationElement extends AnnotationElement{#je=null;constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:s}=getRectDims(t.rect),n=this.svgFactory.create(e,s,!0),i=this.#je=this.svgFactory.createElement("svg:line");i.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]);i.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]);i.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]);i.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]);i.setAttribute("stroke-width",t.borderStyle.width||1);i.setAttribute("stroke","transparent");i.setAttribute("fill","transparent");n.append(i);this.container.append(n);t.popupRef||this._createPopup();return this.container}getElementsToTriggerPopup(){return this.#je}addHighlightArea(){this.container.classList.add("highlightArea")}}class SquareAnnotationElement extends AnnotationElement{#Ue=null;constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:s}=getRectDims(t.rect),n=this.svgFactory.create(e,s,!0),i=t.borderStyle.width,a=this.#Ue=this.svgFactory.createElement("svg:rect");a.setAttribute("x",i/2);a.setAttribute("y",i/2);a.setAttribute("width",e-i);a.setAttribute("height",s-i);a.setAttribute("stroke-width",i||1);a.setAttribute("stroke","transparent");a.setAttribute("fill","transparent");n.append(a);this.container.append(n);t.popupRef||this._createPopup();return this.container}getElementsToTriggerPopup(){return this.#Ue}addHighlightArea(){this.container.classList.add("highlightArea")}}class CircleAnnotationElement extends AnnotationElement{#He=null;constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:s}=getRectDims(t.rect),n=this.svgFactory.create(e,s,!0),i=t.borderStyle.width,a=this.#He=this.svgFactory.createElement("svg:ellipse");a.setAttribute("cx",e/2);a.setAttribute("cy",s/2);a.setAttribute("rx",e/2-i/2);a.setAttribute("ry",s/2-i/2);a.setAttribute("stroke-width",i||1);a.setAttribute("stroke","transparent");a.setAttribute("fill","transparent");n.append(a);this.container.append(n);t.popupRef||this._createPopup();return this.container}getElementsToTriggerPopup(){return this.#He}addHighlightArea(){this.container.classList.add("highlightArea")}}class PolylineAnnotationElement extends AnnotationElement{#qe=null;constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0});this.containerClassName="polylineAnnotation";this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:e,height:s}=getRectDims(t.rect),n=this.svgFactory.create(e,s,!0);let i=[];for(const e of t.vertices){const s=e.x-t.rect[0],n=t.rect[3]-e.y;i.push(s+","+n)}i=i.join(" ");const a=this.#qe=this.svgFactory.createElement(this.svgElementName);a.setAttribute("points",i);a.setAttribute("stroke-width",t.borderStyle.width||1);a.setAttribute("stroke","transparent");a.setAttribute("fill","transparent");n.append(a);this.container.append(n);t.popupRef||this._createPopup(a,t);return this.container}getElementsToTriggerPopup(){return this.#qe}addHighlightArea(){this.container.classList.add("highlightArea")}}class PolygonAnnotationElement extends PolylineAnnotationElement{constructor(t){super(t);this.containerClassName="polygonAnnotation";this.svgElementName="svg:polygon"}}class CaretAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.classList.add("caretAnnotation");this.data.popupRef||this._createPopup();return this.container}}class InkAnnotationElement extends AnnotationElement{#We=[];constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0});this.containerClassName="inkAnnotation";this.svgElementName="svg:polyline";this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:e,height:s}=getRectDims(t.rect),n=this.svgFactory.create(e,s,!0);for(const e of t.inkLists){let s=[];for(const n of e){const e=n.x-t.rect[0],i=t.rect[3]-n.y;s.push(`${e},${i}`)}s=s.join(" ");const i=this.svgFactory.createElement(this.svgElementName);this.#We.push(i);i.setAttribute("points",s);i.setAttribute("stroke-width",t.borderStyle.width||1);i.setAttribute("stroke","transparent");i.setAttribute("fill","transparent");t.popupRef||this._createPopup(i,t);n.append(i)}this.container.append(n);return this.container}getElementsToTriggerPopup(){return this.#We}addHighlightArea(){this.container.classList.add("highlightArea")}}e.InkAnnotationElement=InkAnnotationElement;class HighlightAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){this.data.popupRef||this._createPopup();if(this.quadrilaterals)return this._renderQuadrilaterals("highlightAnnotation");this.container.classList.add("highlightAnnotation");return this.container}}class UnderlineAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){this.data.popupRef||this._createPopup();if(this.quadrilaterals)return this._renderQuadrilaterals("underlineAnnotation");this.container.classList.add("underlineAnnotation");return this.container}}class SquigglyAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){this.data.popupRef||this._createPopup();if(this.quadrilaterals)return this._renderQuadrilaterals("squigglyAnnotation");this.container.classList.add("squigglyAnnotation");return this.container}}class StrikeOutAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){this.data.popupRef||this._createPopup();if(this.quadrilaterals)return this._renderQuadrilaterals("strikeoutAnnotation");this.container.classList.add("strikeoutAnnotation");return this.container}}class StampAnnotationElement extends AnnotationElement{constructor(t){super(t,{isRenderable:!!(t.data.popupRef||t.data.titleObj?.str||t.data.contentsObj?.str||t.data.richText?.str),ignoreBorder:!0})}render(){this.container.classList.add("stampAnnotation");this.data.popupRef||this._createPopup();return this.container}}class FileAttachmentAnnotationElement extends AnnotationElement{#Ge=null;constructor(t){super(t,{isRenderable:!0});const{filename:e,content:s}=this.data.file;this.filename=(0,i.getFilenameFromUrl)(e,!0);this.content=s;this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:e,content:s})}render(){this.container.classList.add("fileAttachmentAnnotation");let t;if(this.data.hasAppearance)t=document.createElement("div");else{t=document.createElement("img");t.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`}t.classList.add("popupTriggerArea");t.addEventListener("dblclick",this._download.bind(this));this.#Ge=t;!this.data.popupRef&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup();this.container.append(t);return this.container}getElementsToTriggerPopup(){return this.#Ge}addHighlightArea(){this.container.classList.add("highlightArea")}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}e.AnnotationLayer=class AnnotationLayer{#Gt=null;#ze=null;#Ve=new Map;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,l10n:i,page:a,viewport:r}){this.div=t;this.#Gt=e;this.#ze=n;this.l10n=i;this.page=a;this.viewport=r;this.zIndex=0;const{NullL10n:o}=s(32);this.l10n||=o}#Xe(t,e){const s=t.firstChild||t;s.id=`${i.AnnotationPrefix}${e}`;this.div.append(t);this.#Gt?.moveElementInDOM(this.div,t,s,!1)}async render(t){const{annotations:e}=t,s=this.div;(0,i.setLayerDimensions)(s,this.viewport);const r=new Map,o={data:null,layer:s,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new i.DOMSVGFactory,annotationStorage:t.annotationStorage||new a.AnnotationStorage,enableScripting:!0===t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const t of e){if(t.noHTML)continue;const e=t.annotationType===n.AnnotationType.POPUP;if(e){const e=r.get(t.id);if(!e)continue;o.elements=e}else{const{width:e,height:s}=getRectDims(t.rect);if(e<=0||s<=0)continue}o.data=t;const s=AnnotationElementFactory.create(o);if(!s.isRenderable)continue;if(!e&&t.popupRef){const e=r.get(t.popupRef);e?e.push(s):r.set(t.popupRef,[s])}s.annotationEditorType>0&&this.#Ve.set(s.data.id,s);const i=s.render();t.hidden&&(i.style.visibility="hidden");if(Array.isArray(i))for(const e of i)this.#Xe(e,t.id);else this.#Xe(i,t.id)}this.#$e();await this.l10n.translate(s)}update({viewport:t}){const e=this.div;this.viewport=t;(0,i.setLayerDimensions)(e,{rotation:t.rotation});this.#$e();e.hidden=!1}#$e(){if(!this.#ze)return;const t=this.div;for(const[e,s]of this.#ze){const n=t.querySelector(`[data-annotation-id="${e}"]`);if(!n)continue;const{firstChild:i}=n;i?"CANVAS"===i.nodeName?i.replaceWith(s):i.before(s):n.append(s)}this.#ze.clear()}getEditableAnnotations(){return Array.from(this.#Ve.values())}getEditableAnnotation(t){return this.#Ve.get(t)}}},(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.ColorConverters=void 0;function makeColorComp(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}e.ColorConverters=class ColorConverters{static CMYK_G([t,e,s,n]){return["G",1-Math.min(1,.3*t+.59*s+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_HTML([t]){const e=makeColorComp(t);return`#${e}${e}${e}`}static RGB_G([t,e,s]){return["G",.3*t+.59*e+.11*s]}static RGB_HTML([t,e,s]){return`#${makeColorComp(t)}${makeColorComp(e)}${makeColorComp(s)}`}static T_HTML(){return"#00000000"}static CMYK_RGB([t,e,s,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,s+n),1-Math.min(1,e+n)]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,s]){const n=1-t,i=1-e,a=1-s;return["CMYK",n,i,a,Math.min(n,i,a)]}}},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.XfaLayer=void 0;var n=s(19);e.XfaLayer=class XfaLayer{static setupStorage(t,e,s,n,i){const a=n.getValue(e,{value:null});switch(s.name){case"textarea":null!==a.value&&(t.textContent=a.value);if("print"===i)break;t.addEventListener("input",(t=>{n.setValue(e,{value:t.target.value})}));break;case"input":if("radio"===s.attributes.type||"checkbox"===s.attributes.type){a.value===s.attributes.xfaOn?t.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&t.removeAttribute("checked");if("print"===i)break;t.addEventListener("change",(t=>{n.setValue(e,{value:t.target.checked?t.target.getAttribute("xfaOn"):t.target.getAttribute("xfaOff")})}))}else{null!==a.value&&t.setAttribute("value",a.value);if("print"===i)break;t.addEventListener("input",(t=>{n.setValue(e,{value:t.target.value})}))}break;case"select":if(null!==a.value)for(const t of s.children)t.attributes.value===a.value&&(t.attributes.selected=!0);t.addEventListener("input",(t=>{const s=t.target.options,i=-1===s.selectedIndex?"":s[s.selectedIndex].value;n.setValue(e,{value:i})}))}}static setAttributes({html:t,element:e,storage:s=null,intent:n,linkService:i}){const{attributes:a}=e,r=t instanceof HTMLAnchorElement;"radio"===a.type&&(a.name=`${a.name}-${n}`);for(const[e,s]of Object.entries(a))if(null!=s)switch(e){case"class":s.length&&t.setAttribute(e,s.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",s);break;case"style":Object.assign(t.style,s);break;case"textContent":t.textContent=s;break;default:(!r||"href"!==e&&"newWindow"!==e)&&t.setAttribute(e,s)}r&&i.addLinkAttributes(t,a.href,a.newWindow);s&&a.dataId&&this.setupStorage(t,a.dataId,e,s)}static render(t){const e=t.annotationStorage,s=t.linkService,i=t.xfaHtml,a=t.intent||"display",r=document.createElement(i.name);i.attributes&&this.setAttributes({html:r,element:i,intent:a,linkService:s});const o=[[i,-1,r]],l=t.div;l.append(r);if(t.viewport){const e=`matrix(${t.viewport.transform.join(",")})`;l.style.transform=e}"richText"!==a&&l.setAttribute("class","xfaLayer xfaFont");const c=[];for(;o.length>0;){const[t,i,r]=o.at(-1);if(i+1===t.children.length){o.pop();continue}const l=t.children[++o.at(-1)[1]];if(null===l)continue;const{name:h}=l;if("#text"===h){const t=document.createTextNode(l.value);c.push(t);r.append(t);continue}let d;d=l?.attributes?.xmlns?document.createElementNS(l.attributes.xmlns,h):document.createElement(h);r.append(d);l.attributes&&this.setAttributes({html:d,element:l,storage:e,intent:a,linkService:s});if(l.children&&l.children.length>0)o.push([l,-1,d]);else if(l.value){const t=document.createTextNode(l.value);n.XfaText.shouldBuildText(h)&&c.push(t);d.append(t)}}for(const t of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))t.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e;t.div.hidden=!1}}},(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.NullL10n=void 0;e.getL10nFallback=getL10nFallback;const s={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",print_progress_percent:"{{progress}}%"};function getL10nFallback(t,e){switch(t){case"find_match_count":t=`find_match_count[${1===e.total?"one":"other"}]`;break;case"find_match_count_limit":t=`find_match_count_limit[${1===e.limit?"one":"other"}]`}return s[t]||""}const n={getLanguage:async()=>"en-us",getDirection:async()=>"ltr",get:async(t,e=null,s=getL10nFallback(t,e))=>function formatL10nValue(t,e){return e?t.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,((t,s)=>s in e?e[s]:"{{"+s+"}}")):t}(s,e),async translate(t){}};e.NullL10n=n},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.InkEditor=void 0;var n=s(1),i=s(4),a=s(29),r=s(5);const o=16;class InkEditor extends i.AnnotationEditor{#Ke=0;#Ye=0;#Je=0;#Qe=this.canvasContextMenu.bind(this);#Ze=this.canvasPointermove.bind(this);#ts=this.canvasPointerleave.bind(this);#es=this.canvasPointerup.bind(this);#ss=this.canvasPointerdown.bind(this);#ns=new Path2D;#is=!1;#as=!1;#rs=!1;#os=null;#ls=0;#cs=0;#hs=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(t){super({...t,name:"inkEditor"});this.color=t.color||null;this.thickness=t.thickness||null;this.opacity=t.opacity||null;this.paths=[];this.bezierPath2D=[];this.allRawPaths=[];this.currentPath=[];this.scaleFactor=1;this.translationX=this.translationY=0;this.x=0;this.y=0}static initialize(t){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map((e=>[e,t.get(e)])))}static updateDefaultParams(t,e){switch(t){case n.AnnotationEditorParamsType.INK_THICKNESS:InkEditor._defaultThickness=e;break;case n.AnnotationEditorParamsType.INK_COLOR:InkEditor._defaultColor=e;break;case n.AnnotationEditorParamsType.INK_OPACITY:InkEditor._defaultOpacity=e/100}}updateParams(t,e){switch(t){case n.AnnotationEditorParamsType.INK_THICKNESS:this.#ds(e);break;case n.AnnotationEditorParamsType.INK_COLOR:this.#ge(e);break;case n.AnnotationEditorParamsType.INK_OPACITY:this.#us(e)}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,InkEditor._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,InkEditor._defaultColor||i.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*InkEditor._defaultOpacity)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||InkEditor._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||InkEditor._defaultColor||i.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??InkEditor._defaultOpacity))]]}#ds(t){const e=this.thickness;this.addCommands({cmd:()=>{this.thickness=t;this.#ps()},undo:()=>{this.thickness=e;this.#ps()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#ge(t){const e=this.color;this.addCommands({cmd:()=>{this.color=t;this.#gs()},undo:()=>{this.color=e;this.#gs()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#us(t){t/=100;const e=this.opacity;this.addCommands({cmd:()=>{this.opacity=t;this.#gs()},undo:()=>{this.opacity=e;this.#gs()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild();if(null!==this.div){if(!this.canvas){this.#fs();this.#ms()}if(!this.isAttachedToDOM){this.parent.add(this);this.#bs()}this.#ps()}}remove(){if(null!==this.canvas){this.isEmpty()||this.commit();this.canvas.width=this.canvas.height=0;this.canvas.remove();this.canvas=null;this.#os.disconnect();this.#os=null;super.remove()}}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&null===t&&this._uiManager.addShouldRescale(this);super.setParent(t)}onScaleChanging(){const[t,e]=this.parentDimensions,s=this.width*t,n=this.height*e;this.setDimensions(s,n)}enableEditMode(){if(!this.#is&&null!==this.canvas){super.enableEditMode();this.div.draggable=!1;this.canvas.addEventListener("pointerdown",this.#ss)}}disableEditMode(){if(this.isInEditMode()&&null!==this.canvas){super.disableEditMode();this.div.draggable=!this.isEmpty();this.div.classList.remove("editing");this.canvas.removeEventListener("pointerdown",this.#ss)}}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#As(){const{parentRotation:t,parentDimensions:[e,s]}=this;switch(t){case 90:return[0,s,s,e];case 180:return[e,s,e,s];case 270:return[e,0,s,e];default:return[0,0,e,s]}}#_s(){const{ctx:t,color:e,opacity:s,thickness:n,parentScale:i,scaleFactor:a}=this;t.lineWidth=n*i/a;t.lineCap="round";t.lineJoin="round";t.miterLimit=10;t.strokeStyle=`${e}${(0,r.opacityToHex)(s)}`}#ys(t,e){this.canvas.addEventListener("contextmenu",this.#Qe);this.canvas.addEventListener("pointerleave",this.#ts);this.canvas.addEventListener("pointermove",this.#Ze);this.canvas.addEventListener("pointerup",this.#es);this.canvas.removeEventListener("pointerdown",this.#ss);this.isEditing=!0;if(!this.#rs){this.#rs=!0;this.#bs();this.thickness||=InkEditor._defaultThickness;this.color||=InkEditor._defaultColor||i.AnnotationEditor._defaultLineColor;this.opacity??=InkEditor._defaultOpacity}this.currentPath.push([t,e]);this.#as=!1;this.#_s();this.#hs=()=>{this.#vs();this.#hs&&window.requestAnimationFrame(this.#hs)};window.requestAnimationFrame(this.#hs)}#Ss(t,e){const[s,n]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===s&&e===n)return;const i=this.currentPath;let a=this.#ns;i.push([t,e]);this.#as=!0;if(i.length<=2){a.moveTo(...i[0]);a.lineTo(t,e)}else{if(3===i.length){this.#ns=a=new Path2D;a.moveTo(...i[0])}this.#Es(a,...i.at(-3),...i.at(-2),t,e)}}#xs(){if(0===this.currentPath.length)return;const t=this.currentPath.at(-1);this.#ns.lineTo(...t)}#Cs(t,e){this.#hs=null;t=Math.min(Math.max(t,0),this.canvas.width);e=Math.min(Math.max(e,0),this.canvas.height);this.#Ss(t,e);this.#xs();let s;if(1!==this.currentPath.length)s=this.#ws();else{const n=[t,e];s=[[n,n.slice(),n.slice(),n]]}const n=this.#ns,i=this.currentPath;this.currentPath=[];this.#ns=new Path2D;this.addCommands({cmd:()=>{this.allRawPaths.push(i);this.paths.push(s);this.bezierPath2D.push(n);this.rebuild()},undo:()=>{this.allRawPaths.pop();this.paths.pop();this.bezierPath2D.pop();if(0===this.paths.length)this.remove();else{if(!this.canvas){this.#fs();this.#ms()}this.#ps()}},mustExec:!0})}#vs(){if(!this.#as)return;this.#as=!1;const t=Math.ceil(this.thickness*this.parentScale),e=this.currentPath.slice(-3),s=e.map((t=>t[0])),n=e.map((t=>t[1])),{ctx:i}=(Math.min(...s),Math.max(...s),Math.min(...n),Math.max(...n),this);i.save();i.clearRect(0,0,this.canvas.width,this.canvas.height);for(const t of this.bezierPath2D)i.stroke(t);i.stroke(this.#ns);i.restore()}#Es(t,e,s,n,i,a,r){const o=(e+n)/2,l=(s+i)/2,c=(n+a)/2,h=(i+r)/2;t.bezierCurveTo(o+2*(n-o)/3,l+2*(i-l)/3,c+2*(n-c)/3,h+2*(i-h)/3,c,h)}#ws(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const e=[];let s,[n,i]=t[0];for(s=1;s<t.length-2;s++){const[a,r]=t[s],[o,l]=t[s+1],c=(a+o)/2,h=(r+l)/2,d=[n+2*(a-n)/3,i+2*(r-i)/3],u=[c+2*(a-c)/3,h+2*(r-h)/3];e.push([[n,i],d,u,[c,h]]);[n,i]=[c,h]}const[a,r]=t[s],[o,l]=t[s+1],c=[n+2*(a-n)/3,i+2*(r-i)/3],h=[o+2*(a-o)/3,l+2*(r-l)/3];e.push([[n,i],c,h,[o,l]]);return e}#gs(){if(this.isEmpty()){this.#Ts();return}this.#_s();const{canvas:t,ctx:e}=this;e.setTransform(1,0,0,1,0,0);e.clearRect(0,0,t.width,t.height);this.#Ts();for(const t of this.bezierPath2D)e.stroke(t)}commit(){if(!this.#is){super.commit();this.isEditing=!1;this.disableEditMode();this.setInForeground();this.#is=!0;this.div.classList.add("disabled");this.#ps(!0);this.parent.addInkEditorIfNeeded(!0);this.parent.moveEditorInDOM(this);this.div.focus({preventScroll:!0})}}focusin(t){super.focusin(t);this.enableEditMode()}canvasPointerdown(t){if(0===t.button&&this.isInEditMode()&&!this.#is){this.setInForeground();t.preventDefault();"mouse"!==t.type&&this.div.focus();this.#ys(t.offsetX,t.offsetY)}}canvasContextMenu(t){t.preventDefault()}canvasPointermove(t){t.preventDefault();this.#Ss(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault();this.#Ps(t)}canvasPointerleave(t){this.#Ps(t)}#Ps(t){this.canvas.removeEventListener("pointerleave",this.#ts);this.canvas.removeEventListener("pointermove",this.#Ze);this.canvas.removeEventListener("pointerup",this.#es);this.canvas.addEventListener("pointerdown",this.#ss);setTimeout((()=>{this.canvas.removeEventListener("contextmenu",this.#Qe)}),10);this.#Cs(t.offsetX,t.offsetY);this.addToAnnotationStorage();this.setInBackground()}#fs(){this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=0;this.canvas.className="inkEditorCanvas";InkEditor._l10nPromise.get("editor_ink_canvas_aria_label").then((t=>this.canvas?.setAttribute("aria-label",t)));this.div.append(this.canvas);this.ctx=this.canvas.getContext("2d")}#ms(){this.#os=new ResizeObserver((t=>{const e=t[0].contentRect;e.width&&e.height&&this.setDimensions(e.width,e.height)}));this.#os.observe(this.div)}render(){if(this.div)return this.div;let t,e;if(this.width){t=this.x;e=this.y}super.render();InkEditor._l10nPromise.get("editor_ink2_aria_label").then((t=>this.div?.setAttribute("aria-label",t)));const[s,n,i,a]=this.#As();this.setAt(s,n,0,0);this.setDims(i,a);this.#fs();if(this.width){const[s,n]=this.parentDimensions;this.setAt(t*s,e*n,this.width*s,this.height*n);this.#rs=!0;this.#bs();this.setDims(this.width*s,this.height*n);this.#gs();this.#Fs();this.div.classList.add("disabled")}else{this.div.classList.add("editing");this.enableEditMode()}this.#ms();return this.div}#bs(){if(!this.#rs)return;const[t,e]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t);this.canvas.height=Math.ceil(this.height*e);this.#Ts()}setDimensions(t,e){const s=Math.round(t),n=Math.round(e);if(this.#ls===s&&this.#cs===n)return;this.#ls=s;this.#cs=n;this.canvas.style.visibility="hidden";if(this.#Ke&&Math.abs(this.#Ke-t/e)>.01){e=Math.ceil(t/this.#Ke);this.setDims(t,e)}const[i,a]=this.parentDimensions;this.width=t/i;this.height=e/a;this.#is&&this.#ks(t,e);this.#bs();this.#gs();this.canvas.style.visibility="visible";this.fixDims()}#ks(t,e){const s=this.#Ms(),n=(t-s)/this.#Je,i=(e-s)/this.#Ye;this.scaleFactor=Math.min(n,i)}#Ts(){const t=this.#Ms()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#Rs(t){const e=new Path2D;for(let s=0,n=t.length;s<n;s++){const[n,i,a,r]=t[s];0===s&&e.moveTo(...n);e.bezierCurveTo(i[0],i[1],a[0],a[1],r[0],r[1])}return e}static#Ds(t,e,s){const[n,i,a,r]=e;switch(s){case 0:for(let e=0,s=t.length;e<s;e+=2){t[e]+=n;t[e+1]=r-t[e+1]}break;case 90:for(let e=0,s=t.length;e<s;e+=2){const s=t[e];t[e]=t[e+1]+n;t[e+1]=s+i}break;case 180:for(let e=0,s=t.length;e<s;e+=2){t[e]=a-t[e];t[e+1]+=i}break;case 270:for(let e=0,s=t.length;e<s;e+=2){const s=t[e];t[e]=a-t[e+1];t[e+1]=r-s}break;default:throw new Error("Invalid rotation")}return t}static#Is(t,e,s){const[n,i,a,r]=e;switch(s){case 0:for(let e=0,s=t.length;e<s;e+=2){t[e]-=n;t[e+1]=r-t[e+1]}break;case 90:for(let e=0,s=t.length;e<s;e+=2){const s=t[e];t[e]=t[e+1]-i;t[e+1]=s-n}break;case 180:for(let e=0,s=t.length;e<s;e+=2){t[e]=a-t[e];t[e+1]-=i}break;case 270:for(let e=0,s=t.length;e<s;e+=2){const s=t[e];t[e]=r-t[e+1];t[e+1]=a-s}break;default:throw new Error("Invalid rotation")}return t}#Os(t,e,s,n){const i=[],a=this.thickness/2,r=t*e+a,o=t*s+a;for(const e of this.paths){const s=[],a=[];for(let n=0,i=e.length;n<i;n++){const[l,c,h,d]=e[n],u=t*l[0]+r,p=t*l[1]+o,g=t*c[0]+r,f=t*c[1]+o,m=t*h[0]+r,b=t*h[1]+o,A=t*d[0]+r,_=t*d[1]+o;if(0===n){s.push(u,p);a.push(u,p)}s.push(g,f,m,b,A,_);a.push(g,f);n===i-1&&a.push(A,_)}i.push({bezier:InkEditor.#Ds(s,n,this.rotation),points:InkEditor.#Ds(a,n,this.rotation)})}return i}#Ls(){let t=1/0,e=-1/0,s=1/0,i=-1/0;for(const a of this.paths)for(const[r,o,l,c]of a){const a=n.Util.bezierBoundingBox(...r,...o,...l,...c);t=Math.min(t,a[0]);s=Math.min(s,a[1]);e=Math.max(e,a[2]);i=Math.max(i,a[3])}return[t,s,e,i]}#Ms(){return this.#is?Math.ceil(this.thickness*this.parentScale):0}#ps(t=!1){if(this.isEmpty())return;if(!this.#is){this.#gs();return}const e=this.#Ls(),s=this.#Ms();this.#Je=Math.max(o,e[2]-e[0]);this.#Ye=Math.max(o,e[3]-e[1]);const n=Math.ceil(s+this.#Je*this.scaleFactor),i=Math.ceil(s+this.#Ye*this.scaleFactor),[a,r]=this.parentDimensions;this.width=n/a;this.height=i/r;this.#Ke=n/i;this.#Fs();const l=this.translationX,c=this.translationY;this.translationX=-e[0];this.translationY=-e[1];this.#bs();this.#gs();this.#ls=n;this.#cs=i;this.setDims(n,i);const h=t?s/this.scaleFactor/2:0;this.translate(l-this.translationX-h,c-this.translationY-h)}#Fs(){const{style:t}=this.div;if(this.#Ke>=1){t.minHeight="16px";t.minWidth=`${Math.round(this.#Ke*o)}px`}else{t.minWidth="16px";t.minHeight=`${Math.round(o/this.#Ke)}px`}}static deserialize(t,e,s){if(t instanceof a.InkAnnotationElement)return null;const i=super.deserialize(t,e,s);i.thickness=t.thickness;i.color=n.Util.makeHexColor(...t.color);i.opacity=t.opacity;const[r,l]=i.pageDimensions,c=i.width*r,h=i.height*l,d=i.parentScale,u=t.thickness/2;i.#Ke=c/h;i.#is=!0;i.#ls=Math.round(c);i.#cs=Math.round(h);const{paths:p,rect:g,rotation:f}=t;for(let{bezier:t}of p){t=InkEditor.#Is(t,g,f);const e=[];i.paths.push(e);let s=d*(t[0]-u),n=d*(t[1]-u);for(let i=2,a=t.length;i<a;i+=6){const a=d*(t[i]-u),r=d*(t[i+1]-u),o=d*(t[i+2]-u),l=d*(t[i+3]-u),c=d*(t[i+4]-u),h=d*(t[i+5]-u);e.push([[s,n],[a,r],[o,l],[c,h]]);s=c;n=h}const a=this.#Rs(e);i.bezierPath2D.push(a)}const m=i.#Ls();i.#Je=Math.max(o,m[2]-m[0]);i.#Ye=Math.max(o,m[3]-m[1]);i.#ks(c,h);return i}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),e=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:e,thickness:this.thickness,opacity:this.opacity,paths:this.#Os(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation}}}e.InkEditor=InkEditor},(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});e.SVGGraphics=void 0;var n=s(6),i=s(1),a=s(10);const r="normal",o="normal",l="#000000",c=["butt","round","square"],h=["miter","round","bevel"],createObjectURL=function(t,e="",s=!1){if(URL.createObjectURL&&"undefined"!=typeof Blob&&!s)return URL.createObjectURL(new Blob([t],{type:e}));const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let i=`data:${e};base64,`;for(let e=0,s=t.length;e<s;e+=3){const a=255&t[e],r=255&t[e+1],o=255&t[e+2];i+=n[a>>2]+n[(3&a)<<4|r>>4]+n[e+1<s?(15&r)<<2|o>>6:64]+n[e+2<s?63&o:64]}return i},d=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),e=new Int32Array(256);for(let t=0;t<256;t++){let s=t;for(let t=0;t<8;t++)s=1&s?3988292384^s>>1&2147483647:s>>1&2147483647;e[t]=s}function writePngChunk(t,s,n,i){let a=i;const r=s.length;n[a]=r>>24&255;n[a+1]=r>>16&255;n[a+2]=r>>8&255;n[a+3]=255&r;a+=4;n[a]=255&t.charCodeAt(0);n[a+1]=255&t.charCodeAt(1);n[a+2]=255&t.charCodeAt(2);n[a+3]=255&t.charCodeAt(3);a+=4;n.set(s,a);a+=s.length;const o=function crc32(t,s,n){let i=-1;for(let a=s;a<n;a++){const s=255&(i^t[a]);i=i>>>8^e[s]}return-1^i}(n,i+4,a);n[a]=o>>24&255;n[a+1]=o>>16&255;n[a+2]=o>>8&255;n[a+3]=255&o}function deflateSyncUncompressed(t){let e=t.length;const s=65535,n=Math.ceil(e/s),i=new Uint8Array(2+e+5*n+4);let a=0;i[a++]=120;i[a++]=156;let r=0;for(;e>s;){i[a++]=0;i[a++]=255;i[a++]=255;i[a++]=0;i[a++]=0;i.set(t.subarray(r,r+s),a);a+=s;r+=s;e-=s}i[a++]=1;i[a++]=255&e;i[a++]=e>>8&255;i[a++]=255&~e;i[a++]=(65535&~e)>>8&255;i.set(t.subarray(r),a);a+=t.length-r;const o=function adler32(t,e,s){let n=1,i=0;for(let a=e;a<s;++a){n=(n+(255&t[a]))%65521;i=(i+n)%65521}return i<<16|n}(t,0,t.length);i[a++]=o>>24&255;i[a++]=o>>16&255;i[a++]=o>>8&255;i[a++]=255&o;return i}function encode(e,s,n,r){const o=e.width,l=e.height;let c,h,d;const u=e.data;switch(s){case i.ImageKind.GRAYSCALE_1BPP:h=0;c=1;d=o+7>>3;break;case i.ImageKind.RGB_24BPP:h=2;c=8;d=3*o;break;case i.ImageKind.RGBA_32BPP:h=6;c=8;d=4*o;break;default:throw new Error("invalid format")}const p=new Uint8Array((1+d)*l);let g=0,f=0;for(let t=0;t<l;++t){p[g++]=0;p.set(u.subarray(f,f+d),g);f+=d;g+=d}if(s===i.ImageKind.GRAYSCALE_1BPP&&r){g=0;for(let t=0;t<l;t++){g++;for(let t=0;t<d;t++)p[g++]^=255}}const m=new Uint8Array([o>>24&255,o>>16&255,o>>8&255,255&o,l>>24&255,l>>16&255,l>>8&255,255&l,c,h,0,0,0]),b=function deflateSync(t){if(!a.isNodeJS)return deflateSyncUncompressed(t);try{let e;e=parseInt(process.versions.node)>=8?t:Buffer.from(t);const s=require("zlib").deflateSync(e,{level:9});return s instanceof Uint8Array?s:new Uint8Array(s)}catch(t){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+t)}return deflateSyncUncompressed(t)}(p),A=t.length+36+m.length+b.length,_=new Uint8Array(A);let y=0;_.set(t,y);y+=t.length;writePngChunk("IHDR",m,_,y);y+=12+m.length;writePngChunk("IDATA",b,_,y);y+=12+b.length;writePngChunk("IEND",new Uint8Array(0),_,y);return createObjectURL(_,"image/png",n)}return function convertImgDataToPng(t,e,s){return encode(t,void 0===t.kind?i.ImageKind.GRAYSCALE_1BPP:t.kind,e,s)}}();class SVGExtraState{constructor(){this.fontSizeScale=1;this.fontWeight=o;this.fontSize=0;this.textMatrix=i.IDENTITY_MATRIX;this.fontMatrix=i.FONT_IDENTITY_MATRIX;this.leading=0;this.textRenderingMode=i.TextRenderingMode.FILL;this.textMatrixScale=1;this.x=0;this.y=0;this.lineX=0;this.lineY=0;this.charSpacing=0;this.wordSpacing=0;this.textHScale=1;this.textRise=0;this.fillColor=l;this.strokeColor="#000000";this.fillAlpha=1;this.strokeAlpha=1;this.lineWidth=1;this.lineJoin="";this.lineCap="";this.miterLimit=0;this.dashArray=[];this.dashPhase=0;this.dependencies=[];this.activeClipUrl=null;this.clipGroup=null;this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(t,e){this.x=t;this.y=e}}function pf(t){if(Number.isInteger(t))return t.toString();const e=t.toFixed(10);let s=e.length-1;if("0"!==e[s])return e;do{s--}while("0"===e[s]);return e.substring(0,"."===e[s]?s:s+1)}function pm(t){if(0===t[4]&&0===t[5]){if(0===t[1]&&0===t[2])return 1===t[0]&&1===t[3]?"":`scale(${pf(t[0])} ${pf(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){return`rotate(${pf(180*Math.acos(t[0])/Math.PI)})`}}else if(1===t[0]&&0===t[1]&&0===t[2]&&1===t[3])return`translate(${pf(t[4])} ${pf(t[5])})`;return`matrix(${pf(t[0])} ${pf(t[1])} ${pf(t[2])} ${pf(t[3])} ${pf(t[4])} ${pf(t[5])})`}let u=0,p=0,g=0;e.SVGGraphics=class SVGGraphics{constructor(t,e,s=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future.");this.svgFactory=new n.DOMSVGFactory;this.current=new SVGExtraState;this.transformMatrix=i.IDENTITY_MATRIX;this.transformStack=[];this.extraStack=[];this.commonObjs=t;this.objs=e;this.pendingClip=null;this.pendingEOFill=!1;this.embedFonts=!1;this.embeddedFonts=Object.create(null);this.cssStyle=null;this.forceDataSchema=!!s;this._operatorIdMapping=[];for(const t in i.OPS)this._operatorIdMapping[i.OPS[t]]=t}getObject(t,e=null){return"string"==typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t);this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop();this.current=this.extraStack.pop();this.pendingClip=null;this.tgrp=null}group(t){this.save();this.executeOpTree(t);this.restore()}loadDependencies(t){const e=t.fnArray,s=t.argsArray;for(let t=0,n=e.length;t<n;t++)if(e[t]===i.OPS.dependency)for(const e of s[t]){const t=e.startsWith("g_")?this.commonObjs:this.objs,s=new Promise((s=>{t.get(e,s)}));this.current.dependencies.push(s)}return Promise.all(this.current.dependencies)}transform(t,e,s,n,a,r){const o=[t,e,s,n,a,r];this.transformMatrix=i.Util.transform(this.transformMatrix,o);this.tgrp=null}getSVG(t,e){this.viewport=e;const s=this._initialize(e);return this.loadDependencies(t).then((()=>{this.transformMatrix=i.IDENTITY_MATRIX;this.executeOpTree(this.convertOpList(t));return s}))}convertOpList(t){const e=this._operatorIdMapping,s=t.argsArray,n=t.fnArray,i=[];for(let t=0,a=n.length;t<a;t++){const a=n[t];i.push({fnId:a,fn:e[a],args:s[t]})}return function opListToTree(t){let e=[];const s=[];for(const n of t)if("save"!==n.fn)"restore"===n.fn?e=s.pop():e.push(n);else{e.push({fnId:92,fn:"group",items:[]});s.push(e);e=e.at(-1).items}return e}(i)}executeOpTree(t){for(const e of t){const t=e.fn,s=e.fnId,n=e.args;switch(0|s){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(n);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(n[0],n[1]);break;case i.OPS.setFont:this.setFont(n);break;case i.OPS.showText:case i.OPS.showSpacedText:this.showText(n[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(n[0],n[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(n[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(n[0]);break;case i.OPS.setHScale:this.setHScale(n[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(n[0],n[1],n[2],n[3],n[4],n[5]);break;case i.OPS.setTextRise:this.setTextRise(n[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(n[0]);break;case i.OPS.setLineWidth:this.setLineWidth(n[0]);break;case i.OPS.setLineJoin:this.setLineJoin(n[0]);break;case i.OPS.setLineCap:this.setLineCap(n[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(n[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(n[0],n[1],n[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(n[0],n[1],n[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(n);break;case i.OPS.setFillColorN:this.setFillColorN(n);break;case i.OPS.shadingFill:this.shadingFill(n[0]);break;case i.OPS.setDash:this.setDash(n[0],n[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(n[0]);break;case i.OPS.setFlatness:this.setFlatness(n[0]);break;case i.OPS.setGState:this.setGState(n[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(n[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(n[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(n[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(n[0],n[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(n[0],n[1],n[2],n[3],n[4],n[5]);break;case i.OPS.constructPath:this.constructPath(n[0],n[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(e.items);break;default:(0,i.warn)(`Unimplemented operator ${t}`)}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,e,s,n,i,a){const r=this.current;r.textMatrix=r.lineMatrix=[t,e,s,n,i,a];r.textMatrixScale=Math.hypot(t,e);r.x=r.lineX=0;r.y=r.lineY=0;r.xcoords=[];r.ycoords=[];r.tspan=this.svgFactory.createElement("svg:tspan");r.tspan.setAttributeNS(null,"font-family",r.fontFamily);r.tspan.setAttributeNS(null,"font-size",`${pf(r.fontSize)}px`);r.tspan.setAttributeNS(null,"y",pf(-r.y));r.txtElement=this.svgFactory.createElement("svg:text");r.txtElement.append(r.tspan)}beginText(){const t=this.current;t.x=t.lineX=0;t.y=t.lineY=0;t.textMatrix=i.IDENTITY_MATRIX;t.lineMatrix=i.IDENTITY_MATRIX;t.textMatrixScale=1;t.tspan=this.svgFactory.createElement("svg:tspan");t.txtElement=this.svgFactory.createElement("svg:text");t.txtgrp=this.svgFactory.createElement("svg:g");t.xcoords=[];t.ycoords=[]}moveText(t,e){const s=this.current;s.x=s.lineX+=t;s.y=s.lineY+=e;s.xcoords=[];s.ycoords=[];s.tspan=this.svgFactory.createElement("svg:tspan");s.tspan.setAttributeNS(null,"font-family",s.fontFamily);s.tspan.setAttributeNS(null,"font-size",`${pf(s.fontSize)}px`);s.tspan.setAttributeNS(null,"y",pf(-s.y))}showText(t){const e=this.current,s=e.font,n=e.fontSize;if(0===n)return;const a=e.fontSizeScale,c=e.charSpacing,h=e.wordSpacing,d=e.fontDirection,u=e.textHScale*d,p=s.vertical,g=p?1:-1,f=s.defaultVMetrics,m=n*e.fontMatrix[0];let b=0;for(const i of t){if(null===i){b+=d*h;continue}if("number"==typeof i){b+=g*i*n/1e3;continue}const t=(i.isSpace?h:0)+c,r=i.fontChar;let o,l,u,A=i.width;if(p){let t;const e=i.vmetric||f;t=i.vmetric?e[1]:.5*A;t=-t*m;const s=e[2]*m;A=e?-e[0]:A;o=t/a;l=(b+s)/a}else{o=b/a;l=0}if(i.isInFont||s.missingFile){e.xcoords.push(e.x+o);p&&e.ycoords.push(-e.y+l);e.tspan.textContent+=r}u=p?A*m-t*d:A*m+t*d;b+=u}e.tspan.setAttributeNS(null,"x",e.xcoords.map(pf).join(" "));p?e.tspan.setAttributeNS(null,"y",e.ycoords.map(pf).join(" ")):e.tspan.setAttributeNS(null,"y",pf(-e.y));p?e.y-=b:e.x+=b*u;e.tspan.setAttributeNS(null,"font-family",e.fontFamily);e.tspan.setAttributeNS(null,"font-size",`${pf(e.fontSize)}px`);e.fontStyle!==r&&e.tspan.setAttributeNS(null,"font-style",e.fontStyle);e.fontWeight!==o&&e.tspan.setAttributeNS(null,"font-weight",e.fontWeight);const A=e.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(A===i.TextRenderingMode.FILL||A===i.TextRenderingMode.FILL_STROKE){e.fillColor!==l&&e.tspan.setAttributeNS(null,"fill",e.fillColor);e.fillAlpha<1&&e.tspan.setAttributeNS(null,"fill-opacity",e.fillAlpha)}else e.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?e.tspan.setAttributeNS(null,"fill","transparent"):e.tspan.setAttributeNS(null,"fill","none");if(A===i.TextRenderingMode.STROKE||A===i.TextRenderingMode.FILL_STROKE){const t=1/(e.textMatrixScale||1);this._setStrokeAttributes(e.tspan,t)}let _=e.textMatrix;if(0!==e.textRise){_=_.slice();_[5]+=e.textRise}e.txtElement.setAttributeNS(null,"transform",`${pm(_)} scale(${pf(u)}, -1)`);e.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve");e.txtElement.append(e.tspan);e.txtgrp.append(e.txtElement);this._ensureTransformGroup().append(e.txtElement)}setLeadingMoveText(t,e){this.setLeading(-e);this.moveText(t,e)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');if(!this.cssStyle){this.cssStyle=this.svgFactory.createElement("svg:style");this.cssStyle.setAttributeNS(null,"type","text/css");this.defs.append(this.cssStyle)}const e=createObjectURL(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${e}); }\n`}setFont(t){const e=this.current,s=this.commonObjs.get(t[0]);let n=t[1];e.font=s;if(this.embedFonts&&!s.missingFile&&!this.embeddedFonts[s.loadedName]){this.addFontStyle(s);this.embeddedFonts[s.loadedName]=s}e.fontMatrix=s.fontMatrix||i.FONT_IDENTITY_MATRIX;let a="normal";s.black?a="900":s.bold&&(a="bold");const r=s.italic?"italic":"normal";if(n<0){n=-n;e.fontDirection=-1}else e.fontDirection=1;e.fontSize=n;e.fontFamily=s.loadedName;e.fontWeight=a;e.fontStyle=r;e.tspan=this.svgFactory.createElement("svg:tspan");e.tspan.setAttributeNS(null,"y",pf(-e.y));e.xcoords=[];e.ycoords=[]}endText(){const t=this.current;if(t.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&t.txtElement?.hasChildNodes()){t.element=t.txtElement;this.clip("nonzero");this.endPath()}}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=c[t]}setLineJoin(t){this.current.lineJoin=h[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,e,s){this.current.strokeColor=i.Util.makeHexColor(t,e,s)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,e,s){this.current.fillColor=i.Util.makeHexColor(t,e,s);this.current.tspan=this.svgFactory.createElement("svg:tspan");this.current.xcoords=[];this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const{width:e,height:s}=this.viewport,n=i.Util.inverseTransform(this.transformMatrix),[a,r,o,l]=i.Util.getAxialAlignedBoundingBox([0,0,e,s],n),c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",a);c.setAttributeNS(null,"y",r);c.setAttributeNS(null,"width",o-a);c.setAttributeNS(null,"height",l-r);c.setAttributeNS(null,"fill",this._makeShadingPattern(t));this.current.fillAlpha<1&&c.setAttributeNS(null,"fill-opacity",this.current.fillAlpha);this._ensureTransformGroup().append(c)}_makeColorN_Pattern(t){return"TilingPattern"===t[0]?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const e=t[1],s=t[2],n=t[3]||i.IDENTITY_MATRIX,[a,r,o,l]=t[4],c=t[5],h=t[6],d=t[7],u="shading"+g++,[p,f,m,b]=i.Util.normalizeRect([...i.Util.applyTransform([a,r],n),...i.Util.applyTransform([o,l],n)]),[A,_]=i.Util.singularValueDecompose2dScale(n),y=c*A,v=h*_,S=this.svgFactory.createElement("svg:pattern");S.setAttributeNS(null,"id",u);S.setAttributeNS(null,"patternUnits","userSpaceOnUse");S.setAttributeNS(null,"width",y);S.setAttributeNS(null,"height",v);S.setAttributeNS(null,"x",`${p}`);S.setAttributeNS(null,"y",`${f}`);const E=this.svg,x=this.transformMatrix,C=this.current.fillColor,w=this.current.strokeColor,T=this.svgFactory.create(m-p,b-f);this.svg=T;this.transformMatrix=n;if(2===d){const t=i.Util.makeHexColor(...e);this.current.fillColor=t;this.current.strokeColor=t}this.executeOpTree(this.convertOpList(s));this.svg=E;this.transformMatrix=x;this.current.fillColor=C;this.current.strokeColor=w;S.append(T.childNodes[0]);this.defs.append(S);return`url(#${u})`}_makeShadingPattern(t){"string"==typeof t&&(t=this.objs.get(t));switch(t[0]){case"RadialAxial":const e="shading"+g++,s=t[3];let n;switch(t[1]){case"axial":const s=t[4],i=t[5];n=this.svgFactory.createElement("svg:linearGradient");n.setAttributeNS(null,"id",e);n.setAttributeNS(null,"gradientUnits","userSpaceOnUse");n.setAttributeNS(null,"x1",s[0]);n.setAttributeNS(null,"y1",s[1]);n.setAttributeNS(null,"x2",i[0]);n.setAttributeNS(null,"y2",i[1]);break;case"radial":const a=t[4],r=t[5],o=t[6],l=t[7];n=this.svgFactory.createElement("svg:radialGradient");n.setAttributeNS(null,"id",e);n.setAttributeNS(null,"gradientUnits","userSpaceOnUse");n.setAttributeNS(null,"cx",r[0]);n.setAttributeNS(null,"cy",r[1]);n.setAttributeNS(null,"r",l);n.setAttributeNS(null,"fx",a[0]);n.setAttributeNS(null,"fy",a[1]);n.setAttributeNS(null,"fr",o);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const t of s){const e=this.svgFactory.createElement("svg:stop");e.setAttributeNS(null,"offset",t[0]);e.setAttributeNS(null,"stop-color",t[1]);n.append(e)}this.defs.append(n);return`url(#${e})`;case"Mesh":(0,i.warn)("Unimplemented pattern Mesh");return null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,e){this.current.dashArray=t;this.current.dashPhase=e}constructPath(t,e){const s=this.current;let n=s.x,a=s.y,r=[],o=0;for(const s of t)switch(0|s){case i.OPS.rectangle:n=e[o++];a=e[o++];const t=n+e[o++],s=a+e[o++];r.push("M",pf(n),pf(a),"L",pf(t),pf(a),"L",pf(t),pf(s),"L",pf(n),pf(s),"Z");break;case i.OPS.moveTo:n=e[o++];a=e[o++];r.push("M",pf(n),pf(a));break;case i.OPS.lineTo:n=e[o++];a=e[o++];r.push("L",pf(n),pf(a));break;case i.OPS.curveTo:n=e[o+4];a=e[o+5];r.push("C",pf(e[o]),pf(e[o+1]),pf(e[o+2]),pf(e[o+3]),pf(n),pf(a));o+=6;break;case i.OPS.curveTo2:r.push("C",pf(n),pf(a),pf(e[o]),pf(e[o+1]),pf(e[o+2]),pf(e[o+3]));n=e[o+2];a=e[o+3];o+=4;break;case i.OPS.curveTo3:n=e[o+2];a=e[o+3];r.push("C",pf(e[o]),pf(e[o+1]),pf(n),pf(a),pf(n),pf(a));o+=4;break;case i.OPS.closePath:r.push("Z")}r=r.join(" ");if(s.path&&t.length>0&&t[0]!==i.OPS.rectangle&&t[0]!==i.OPS.moveTo)r=s.path.getAttributeNS(null,"d")+r;else{s.path=this.svgFactory.createElement("svg:path");this._ensureTransformGroup().append(s.path)}s.path.setAttributeNS(null,"d",r);s.path.setAttributeNS(null,"fill","none");s.element=s.path;s.setCurrentPoint(n,a)}endPath(){const t=this.current;t.path=null;if(!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const e="clippath"+u++,s=this.svgFactory.createElement("svg:clipPath");s.setAttributeNS(null,"id",e);s.setAttributeNS(null,"transform",pm(this.transformMatrix));const n=t.element.cloneNode(!0);"evenodd"===this.pendingClip?n.setAttributeNS(null,"clip-rule","evenodd"):n.setAttributeNS(null,"clip-rule","nonzero");this.pendingClip=null;s.append(n);this.defs.append(s);if(t.activeClipUrl){t.clipGroup=null;for(const t of this.extraStack)t.clipGroup=null;s.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${e})`;this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const e=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",e)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,s]of t)switch(e){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s);break;case"CA":this.setStrokeAlpha(s);break;case"ca":this.setFillAlpha(s);break;default:(0,i.warn)(`Unimplemented graphic state operator ${e}`)}}fill(){const t=this.current;if(t.element){t.element.setAttributeNS(null,"fill",t.fillColor);t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha);this.endPath()}}stroke(){const t=this.current;if(t.element){this._setStrokeAttributes(t.element);t.element.setAttributeNS(null,"fill","none");this.endPath()}}_setStrokeAttributes(t,e=1){const s=this.current;let n=s.dashArray;1!==e&&n.length>0&&(n=n.map((function(t){return e*t})));t.setAttributeNS(null,"stroke",s.strokeColor);t.setAttributeNS(null,"stroke-opacity",s.strokeAlpha);t.setAttributeNS(null,"stroke-miterlimit",pf(s.miterLimit));t.setAttributeNS(null,"stroke-linecap",s.lineCap);t.setAttributeNS(null,"stroke-linejoin",s.lineJoin);t.setAttributeNS(null,"stroke-width",pf(e*s.lineWidth)+"px");t.setAttributeNS(null,"stroke-dasharray",n.map(pf).join(" "));t.setAttributeNS(null,"stroke-dashoffset",pf(e*s.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd");this.fill()}fillStroke(){this.stroke();this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd");this.fillStroke()}closeStroke(){this.closePath();this.stroke()}closeFillStroke(){this.closePath();this.fillStroke()}closeEOFillStroke(){this.closePath();this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0");t.setAttributeNS(null,"y","0");t.setAttributeNS(null,"width","1px");t.setAttributeNS(null,"height","1px");t.setAttributeNS(null,"fill",this.current.fillColor);this._ensureTransformGroup().append(t)}paintImageXObject(t){const e=this.getObject(t);e?this.paintInlineImageXObject(e):(0,i.warn)(`Dependent image with object ID ${t} is not ready yet`)}paintInlineImageXObject(t,e){const s=t.width,n=t.height,i=d(t,this.forceDataSchema,!!e),a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0");a.setAttributeNS(null,"y","0");a.setAttributeNS(null,"width",pf(s));a.setAttributeNS(null,"height",pf(n));this.current.element=a;this.clip("nonzero");const r=this.svgFactory.createElement("svg:image");r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);r.setAttributeNS(null,"x","0");r.setAttributeNS(null,"y",pf(-n));r.setAttributeNS(null,"width",pf(s)+"px");r.setAttributeNS(null,"height",pf(n)+"px");r.setAttributeNS(null,"transform",`scale(${pf(1/s)} ${pf(-1/n)})`);e?e.append(r):this._ensureTransformGroup().append(r)}paintImageMaskXObject(t){const e=this.getObject(t.data,t);if(e.bitmap){(0,i.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const s=this.current,n=e.width,a=e.height,r=s.fillColor;s.maskId="mask"+p++;const o=this.svgFactory.createElement("svg:mask");o.setAttributeNS(null,"id",s.maskId);const l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0");l.setAttributeNS(null,"y","0");l.setAttributeNS(null,"width",pf(n));l.setAttributeNS(null,"height",pf(a));l.setAttributeNS(null,"fill",r);l.setAttributeNS(null,"mask",`url(#${s.maskId})`);this.defs.append(o);this._ensureTransformGroup().append(l);this.paintInlineImageXObject(e,o)}paintFormXObjectBegin(t,e){Array.isArray(t)&&6===t.length&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]);if(e){const t=e[2]-e[0],s=e[3]-e[1],n=this.svgFactory.createElement("svg:rect");n.setAttributeNS(null,"x",e[0]);n.setAttributeNS(null,"y",e[1]);n.setAttributeNS(null,"width",pf(t));n.setAttributeNS(null,"height",pf(s));this.current.element=n;this.clip("nonzero");this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const e=this.svgFactory.create(t.width,t.height),s=this.svgFactory.createElement("svg:defs");e.append(s);this.defs=s;const n=this.svgFactory.createElement("svg:g");n.setAttributeNS(null,"transform",pm(t.transform));e.append(n);this.svg=n;return e}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl);this.svg.append(t);this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){if(!this.tgrp){this.tgrp=this.svgFactory.createElement("svg:g");this.tgrp.setAttributeNS(null,"transform",pm(this.transformMatrix));this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)}return this.tgrp}}}],__webpack_module_cache__={};function __w_pdfjs_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var s=__webpack_module_cache__[t]={exports:{}};__webpack_modules__[t](s,s.exports,__w_pdfjs_require__);return s.exports}var __webpack_exports__={};(()=>{var t=__webpack_exports__;Object.defineProperty(t,"__esModule",{value:!0});Object.defineProperty(t,"AbortException",{enumerable:!0,get:function(){return e.AbortException}});Object.defineProperty(t,"AnnotationEditorLayer",{enumerable:!0,get:function(){return a.AnnotationEditorLayer}});Object.defineProperty(t,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}});Object.defineProperty(t,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}});Object.defineProperty(t,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return r.AnnotationEditorUIManager}});Object.defineProperty(t,"AnnotationLayer",{enumerable:!0,get:function(){return o.AnnotationLayer}});Object.defineProperty(t,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}});Object.defineProperty(t,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}});Object.defineProperty(t,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}});Object.defineProperty(t,"GlobalWorkerOptions",{enumerable:!0,get:function(){return l.GlobalWorkerOptions}});Object.defineProperty(t,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}});Object.defineProperty(t,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}});Object.defineProperty(t,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}});Object.defineProperty(t,"OPS",{enumerable:!0,get:function(){return e.OPS}});Object.defineProperty(t,"PDFDataRangeTransport",{enumerable:!0,get:function(){return s.PDFDataRangeTransport}});Object.defineProperty(t,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}});Object.defineProperty(t,"PDFWorker",{enumerable:!0,get:function(){return s.PDFWorker}});Object.defineProperty(t,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}});Object.defineProperty(t,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}});Object.defineProperty(t,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}});Object.defineProperty(t,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}});Object.defineProperty(t,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}});t.SVGGraphics=void 0;Object.defineProperty(t,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}});Object.defineProperty(t,"Util",{enumerable:!0,get:function(){return e.Util}});Object.defineProperty(t,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}});Object.defineProperty(t,"XfaLayer",{enumerable:!0,get:function(){return c.XfaLayer}});Object.defineProperty(t,"build",{enumerable:!0,get:function(){return s.build}});Object.defineProperty(t,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}});Object.defineProperty(t,"getDocument",{enumerable:!0,get:function(){return s.getDocument}});Object.defineProperty(t,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}});Object.defineProperty(t,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}});Object.defineProperty(t,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}});Object.defineProperty(t,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}});Object.defineProperty(t,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}});Object.defineProperty(t,"loadScript",{enumerable:!0,get:function(){return n.loadScript}});Object.defineProperty(t,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}});Object.defineProperty(t,"renderTextLayer",{enumerable:!0,get:function(){return i.renderTextLayer}});Object.defineProperty(t,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}});Object.defineProperty(t,"shadow",{enumerable:!0,get:function(){return e.shadow}});Object.defineProperty(t,"updateTextLayer",{enumerable:!0,get:function(){return i.updateTextLayer}});Object.defineProperty(t,"version",{enumerable:!0,get:function(){return s.version}});var e=__w_pdfjs_require__(1),s=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),i=__w_pdfjs_require__(26),a=__w_pdfjs_require__(27),r=__w_pdfjs_require__(5),o=__w_pdfjs_require__(29),l=__w_pdfjs_require__(14),c=__w_pdfjs_require__(31);const h=__w_pdfjs_require__(34).SVGGraphics;t.SVGGraphics=h})();return __webpack_exports__})()));
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("pdfjs-dist/web/pdf_viewer",[],t):"object"==typeof exports?exports["pdfjs-dist/web/pdf_viewer"]=t():e["pdfjs-dist/web/pdf_viewer"]=e.pdfjsViewer=t()}(globalThis,()=>(()=>{"use strict";var i=[,(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFindController=t.FindState=void 0;var h=i(2),s=i(3),r=i(4);const a={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},E=(t.FindState=a,{"":"-","":"'","":"'","":"'","":"'","":'"',"":'"',"":'"',"":'"',"":"1/4","":"1/2","":"3/4"}),d=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let n;const o=/\p{M}+/gu,c=/([.*+?^${}()|[\]\\])|(\p{P})|(\s+)|(\p{M})|(\p{L})/gu,l=/([^\p{M}])\p{M}*$/u,u=/^\p{M}*([^\p{M}])/u,S=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,w=new Map,L=new Map;let M=null,C=null;function g(e){const g=[];let i;for(;null!==(i=S.exec(e));){let t=i["index"];for(const r of i[0]){let e=w.get(r);e||(e=r.normalize("NFD").length,w.set(r,e)),g.push([e,t++])}}let t;var n;t=0===g.length&&M?M:0<g.length&&C?C:(n=`([${Object.keys(E).join("")}])|([${(0,s.getNormalizeWithNFKC)()}])|((?:|)\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[-])\\n)|(\\n)`,0===g.length?M=new RegExp(n+"|(\\u0000)","gum"):C=new RegExp(n+"|([\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f])","gum"));const p=[];for(;null!==(i=o.exec(e));)p.push([i[0].length,i.index]);let a=e.normalize("NFD");const f=[[0,0]];let v=0,m=0,_=0,P=0,y=0,b=!1;return a=a.replace(t,(e,i,n,t,a,r,s,o,l,h)=>{if(h-=P,i){var i=E[i],d=i.length;for(let e=1;e<d;e++)f.push([h-_+e,_-e]);return _-=d-1,i}if(n){let e=L.get(n);e||(e=n.normalize("NFKC"),L.set(n,e));var c=e.length;for(let e=1;e<c;e++)f.push([h-_+e,_-e]);return _-=c-1,e}if(t)return b=!0,h+y===p[v]?.[1]?++v:(f.push([h-1-_+1,_-1]),--_,P+=1),f.push([h-_+1,_]),P+=1,y+=1,t.charAt(0);if(a){i=a.endsWith("\n"),n=i?a.length-2:a.length;b=!0;let t=n;h+y===p[v]?.[1]&&(t-=p[v][0],++v);for(let e=1;e<=t;e++)f.push([h-1-_+e,_-e]);return _-=t,P+=t,i?(h+=n-1,f.push([h-_+1,1+_]),_+=1,P+=1,y+=1,a.slice(0,n)):a}if(r)return t=r.length-2,f.push([h-_+t,1+_]),_+=1,P+=1,y+=1,r.slice(0,-2);if(s)return i=s.length-1,f.push([h-_+i,_]),P+=1,y+=1,s.slice(0,-1);if(o)return f.push([h-_+1,_-1]),--_,P+=1,y+=1," ";if(h+y===g[m]?.[1]){var u=g[m][0]-1;++m;for(let e=1;e<=u;e++)f.push([h-(_-e),_-e]);_-=u,P+=u}return l}),f.push([a.length,_]),[a,f,b]}t.PDFFindController=class{#state=null;#updateMatchesCountOnProgress=!0;#visitedPagesCount=0;constructor({linkService:e,eventBus:t,updateMatchesCountOnProgress:i=!0}){this._linkService=e,this._eventBus=t,this.#updateMatchesCountOnProgress=i,this.onIsPageVisible=null,this.#reset(),t._on("find",this.#onFind.bind(this)),t._on("findbarclose",this.#onFindBarClose.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#state}setDocument(e){this._pdfDocument&&this.#reset(),e&&(this._pdfDocument=e,this._firstPageCapability.resolve())}#onFind(e){if(e){!1===e.phraseSearch&&(console.error("The `phraseSearch`-parameter was removed, please provide an Array of strings in the `query`-parameter instead."),"string"==typeof e.query)&&(e.query=e.query.match(/\S+/g));const i=this._pdfDocument,n=e["type"];null!==this.#state&&!this.#shouldDirtyMatch(e)||(this._dirtyMatch=!0),this.#state=e,"highlightallchange"!==n&&this.#updateUIState(a.PENDING),this._firstPageCapability.promise.then(()=>{var e,t;!this._pdfDocument||i&&this._pdfDocument!==i||(this.#extractText(),e=!this._highlightMatches,t=!!this._findTimeout,this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),n?this._dirtyMatch?this.#nextMatch():"again"===n?(this.#nextMatch(),e&&this.#state.highlightAll&&this.#updateAllPages()):"highlightallchange"===n?(t?this.#nextMatch():this._highlightMatches=!0,this.#updateAllPages()):this.#nextMatch():this._findTimeout=setTimeout(()=>{this.#nextMatch(),this._findTimeout=null},250))})}}scrollMatchIntoView({element:e=null,selectedLeft:t=0,pageIndex:i=-1,matchIndex:n=-1}){this._scrollMatches&&e&&-1!==n&&n===this._selected.matchIdx&&-1!==i&&i===this._selected.pageIdx&&(this._scrollMatches=!1,h.scrollIntoView)(e,{top:-50,left:t+-400},!0)}#reset(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#visitedPagesCount=0,this.#state=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=new r.PromiseCapability}get#query(){var e=this.#state["query"];return"string"==typeof e?(e!==this._rawQuery&&(this._rawQuery=e,[this._normalizedQuery]=g(e)),this._normalizedQuery):(e||[]).filter(e=>!!e).map(e=>g(e)[0])}#shouldDirtyMatch(e){var t=e.query,i=this.#state.query,n=typeof t,a=typeof i;if(n==a){if("string"==n){if(t!==i)return!0}else if(JSON.stringify(t)!==JSON.stringify(i))return!0;switch(e.type){case"again":var r=this._selected.pageIdx+1,s=this._linkService;return 1<=r&&r<=s.pagesCount&&r!==s.page&&!(this.onIsPageVisible?.(r)??!0);case"highlightallchange":return!1}}return!0}#isEntireWord(e,t,i){let n=e.slice(0,t).match(l);if(n){var a=e.charCodeAt(t),r=n[1].charCodeAt(0);if((0,s.getCharacterType)(a)===(0,s.getCharacterType)(r))return!1}if(n=e.slice(t+i).match(u)){a=e.charCodeAt(t+i-1),r=n[1].charCodeAt(0);if((0,s.getCharacterType)(a)===(0,s.getCharacterType)(r))return!1}return!0}#calculateRegExpMatch(e,t,i,n){var a=this._pageMatches[i]=[],r=this._pageMatchesLength[i]=[];if(e)for(var s,o,l=this._pageDiffs[i];null!==(s=e.exec(n));)t&&!this.#isEntireWord(n,s.index,s[0].length)||([s,o]=function(e,t,i){if(!e)return[t,i];const n=t,a=t+i-1;let r=(0,h.binarySearchFirstItem)(e,e=>e[0]>=n),s=(e[r][0]>n&&--r,(0,h.binarySearchFirstItem)(e,e=>e[0]>=a,r));return e[s][0]>a&&--s,[t=n+e[r][1],a+e[s][1]+1-t]}(l,s.index,s[0].length),o&&(a.push(s),r.push(o)))}#convertToRegExpString(e,s){const o=this.#state["matchDiacritics"];let l=!1;return(e=e.replaceAll(c,(e,t,i,n,a,r)=>t?`[ ]*\\${t}[ ]*`:i?`[ ]*${i}[ ]*`:n?"[ ]+":o?a||r:a?d.has(a.charCodeAt(0))?a:"":s?(l=!0,r+"\\p{M}*"):r)).endsWith("[ ]*")&&(e=e.slice(0,e.length-"[ ]*".length)),o&&s&&(n||=String.fromCharCode(...d),l=!0,e=`${e}(?=[${n}]|[^\\p{M}]|$)`),[l,e]}#calculateMatch(e){let t=this.#query;if(0!==t.length){var{caseSensitive:n,entireWord:a}=this.#state,r=this._pageContents[e];const s=this._hasDiacritics[e];let i=!1;"string"==typeof t?[i,t]=this.#convertToRegExpString(t,s):t=t.sort().reverse().map(e=>{var[e,t]=this.#convertToRegExpString(e,s);return i||=e,`(${t})`}).join("|");n="g"+(i?"u":"")+(n?"":"i"),n=(t=t?new RegExp(t,n):null,this.#calculateRegExpMatch(t,a,e,r),this.#state.highlightAll&&this.#updatePage(e),this._resumePageIdx===e&&(this._resumePageIdx=null,this.#nextPageMatch()),this._pageMatches[e].length);this._matchesCountTotal+=n,this.#updateMatchesCountOnProgress?0<n&&this.#updateUIResultsCount():++this.#visitedPagesCount===this._linkService.pagesCount&&this.#updateUIResultsCount()}}#extractText(){if(!(0<this._extractTextPromises.length)){let t=Promise.resolve();const i={disableNormalization:!0};for(let n=0,e=this._linkService.pagesCount;n<e;n++){const a=new r.PromiseCapability;this._extractTextPromises[n]=a.promise,t=t.then(()=>this._pdfDocument.getPage(n+1).then(e=>e.getTextContent(i)).then(e=>{var t=[];for(const i of e.items)t.push(i.str),i.hasEOL&&t.push("\n");[this._pageContents[n],this._pageDiffs[n],this._hasDiacritics[n]]=g(t.join("")),a.resolve()},e=>{console.error("Unable to get text content for page "+(n+1),e),this._pageContents[n]="",this._pageDiffs[n]=null,this._hasDiacritics[n]=!1,a.resolve()}))}}}#updatePage(e){this._scrollMatches&&this._selected.pageIdx===e&&(this._linkService.page=e+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:e})}#updateAllPages(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#nextMatch(){var e=this.#state.findPrevious,t=this._linkService.page-1,i=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=t,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#visitedPagesCount=0,this._matchesCountTotal=0,this.#updateAllPages();for(let e=0;e<i;e++)this._pendingFindMatches.has(e)||(this._pendingFindMatches.add(e),this._extractTextPromises[e].then(()=>{this._pendingFindMatches.delete(e),this.#calculateMatch(e)}))}if(0===this.#query.length)this.#updateUIState(a.FOUND);else if(!this._resumePageIdx){t=this._offset;if(this._pagesToSearch=i,null!==t.matchIdx){var n=this._pageMatches[t.pageIdx].length;if(!e&&t.matchIdx+1<n||e&&0<t.matchIdx)return t.matchIdx=e?t.matchIdx-1:t.matchIdx+1,void this.#updateMatch(!0);this.#advanceOffsetPage(e)}this.#nextPageMatch()}}#matchesReady(e){var t=this._offset,e=e.length,i=this.#state.findPrevious;return e?(t.matchIdx=i?e-1:0,this.#updateMatch(!0),!0):(this.#advanceOffsetPage(i),!!(t.wrapped&&(t.matchIdx=null,this._pagesToSearch<0))&&(this.#updateMatch(!1),!0))}#nextPageMatch(){null!==this._resumePageIdx&&console.error("There can only be one pending page.");let e=null;do{var t=this._offset.pageIdx;if(!(e=this._pageMatches[t])){this._resumePageIdx=t;break}}while(!this.#matchesReady(e))}#advanceOffsetPage(e){var t=this._offset,i=this._linkService.pagesCount;t.pageIdx=e?t.pageIdx-1:t.pageIdx+1,t.matchIdx=null,this._pagesToSearch--,(t.pageIdx>=i||t.pageIdx<0)&&(t.pageIdx=e?i-1:0,t.wrapped=!0)}#updateMatch(e=!1){let t=a.NOT_FOUND;var i=this._offset.wrapped;this._offset.wrapped=!1,e&&(e=this._selected.pageIdx,this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,t=i?a.WRAPPED:a.FOUND,-1!==e)&&e!==this._selected.pageIdx&&this.#updatePage(e),this.#updateUIState(t,this.#state.findPrevious),-1!==this._selected.pageIdx&&(this._scrollMatches=!0,this.#updatePage(this._selected.pageIdx))}#onFindBarClose(e){const t=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||t&&this._pdfDocument!==t||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#updateUIState(a.FOUND),this._highlightMatches=!1,this.#updateAllPages())})}#requestMatchesCount(){var{pageIdx:t,matchIdx:e}=this._selected;let i=0,n=this._matchesCountTotal;if(-1!==e){for(let e=0;e<t;e++)i+=this._pageMatches[e]?.length||0;i+=e+1}return{current:i=i<1||i>n?n=0:i,total:n}}#updateUIResultsCount(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#requestMatchesCount()})}#updateUIState(e,t=!1){(this.#updateMatchesCountOnProgress||this.#visitedPagesCount===this._linkService.pagesCount&&e!==a.PENDING)&&this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:e,previous:t,matchesCount:this.#requestMatchesCount(),rawQuery:this.#state?.query??null})}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.animationStarted=t.VERTICAL_PADDING=t.UNKNOWN_SCALE=t.TextLayerMode=t.SpreadMode=t.SidebarView=t.ScrollMode=t.SCROLLBAR_PADDING=t.RenderingStates=t.ProgressBar=t.PresentationModeState=t.OutputScale=t.MIN_SCALE=t.MAX_SCALE=t.MAX_AUTO_SCALE=t.DEFAULT_SCALE_VALUE=t.DEFAULT_SCALE_DELTA=t.DEFAULT_SCALE=t.CursorTool=t.AutoPrintRegExp=void 0,t.apiPageLayoutToViewerModes=function(e){let t=n.VERTICAL,i=a.NONE;switch(e){case"SinglePage":t=n.PAGE;break;case"OneColumn":break;case"TwoPageLeft":t=n.PAGE;case"TwoColumnLeft":i=a.ODD;break;case"TwoPageRight":t=n.PAGE;case"TwoColumnRight":i=a.EVEN}return{scrollMode:t,spreadMode:i}},t.apiPageModeToSidebarView=function(e){switch(e){case"UseNone":return i.NONE;case"UseThumbs":return i.THUMBS;case"UseOutlines":return i.OUTLINE;case"UseAttachments":return i.ATTACHMENTS;case"UseOC":return i.LAYERS}return i.NONE},t.approximateFraction=function(e){if(Math.floor(e)===e)return[e,1];var t=1/e;{if(8<t)return[1,8];if(Math.floor(t)===t)return[1,t]}var i=1<e?t:e;let n=0,a=1,r=1,s=1;for(;;){var o=n+r,l=a+s;if(8<l)break;i<=o/l?(r=o,s=l):(n=o,a=l)}let h;h=i-n/a<r/s-i?i===e?[n,a]:[a,n]:i===e?[r,s]:[s,r];return h},t.backtrackBeforeAllVisibleElements=S,t.binarySearchFirstItem=E,t.docStyle=void 0,t.getActiveOrFocusedElement=function(){let e=document,t=e.activeElement||e.querySelector(":focus");for(;t?.shadowRoot;)e=t.shadowRoot,t=e.activeElement||e.querySelector(":focus");return t},t.getPageSizeInches=function({view:e,userUnit:t,rotate:i}){var[e,n,a,r]=e,i=i%180!=0,a=(a-e)/72*t,e=(r-n)/72*t;return{width:i?e:a,height:i?a:e}},t.getVisibleElements=function({scrollEl:e,views:t,sortByVisibility:i=!1,horizontal:n=!1,rtl:a=!1}){const r=e.scrollTop,s=r+e.clientHeight,o=e.scrollLeft,l=o+e.clientWidth;var h=[],d=new Set,c=t.length;let u=E(t,n?function(e){var t=(e=e.div).offsetLeft+e.clientLeft,e=t+e.clientWidth;return a?t<l:e>o}:function(e){return(e=e.div).offsetTop+e.clientTop+e.clientHeight>r});0<u&&u<c&&!n&&(u=S(u,t,r));let g=n?l:-1;for(let e=u;e<c;e++){var p=t[e],f=p.div,v=f.offsetLeft+f.clientLeft,m=f.offsetTop+f.clientTop,_=f.clientWidth,f=f.clientHeight,P=v+_,y=m+f;if(-1===g)s<=y&&(g=y);else if((n?v:m)>g)break;y<=r||s<=m||P<=o||v>=l||(y=Math.max(0,r-m)+Math.max(0,y-s),P=Math.max(0,o-v)+Math.max(0,P-l),h.push({id:p.id,x:v,y:m,view:p,percent:(f-y)/f*(v=(_-P)/_)*100|0,widthPercent:100*v|0}),d.add(p.id))}var e=h[0],b=h.at(-1);i&&h.sort(function(e,t){var i=e.percent-t.percent;return.001<Math.abs(i)?-i:e.id-t.id});return{first:e,last:b,views:h,ids:d}},t.isPortraitOrientation=function(e){return e.width<=e.height},t.isValidRotation=function(e){return Number.isInteger(e)&&e%90==0},t.isValidScrollMode=function(e){return Number.isInteger(e)&&Object.values(n).includes(e)&&e!==n.UNKNOWN},t.isValidSpreadMode=function(e){return Number.isInteger(e)&&Object.values(a).includes(e)&&e!==a.UNKNOWN},t.noContextMenuHandler=function(e){e.preventDefault()},t.normalizeWheelEventDelta=function(e){var t=e.deltaMode;let i=s(e);t===WheelEvent.DOM_DELTA_PIXEL?i/=900:t===WheelEvent.DOM_DELTA_LINE&&(i/=30);return i},t.normalizeWheelEventDirection=s,t.parseQueryString=function(e){var t=new Map;for(var[i,n]of new URLSearchParams(e))t.set(i.toLowerCase(),n);return t},t.removeNullCharacters=function(e,t=!1){if("string"!=typeof e)return console.error("The argument must be a string."),e;t&&(e=e.replaceAll(r," "));return e.replaceAll("\0","")},t.roundToDivide=function(e,t){var i=e%t;return 0==i?e:Math.round(e-i+t)},t.scrollIntoView=function(i,n,a=!1){let r=i.offsetParent;if(r){let e=i.offsetTop+i.clientTop,t=i.offsetLeft+i.clientLeft;for(;r.clientHeight===r.scrollHeight&&r.clientWidth===r.scrollWidth||a&&(r.classList.contains("markedContent")||"hidden"===getComputedStyle(r).overflow);)if(e+=r.offsetTop,t+=r.offsetLeft,!(r=r.offsetParent))return;n&&(void 0!==n.top&&(e+=n.top),void 0!==n.left)&&(t+=n.left,r.scrollLeft=t),r.scrollTop=e}else console.error("offsetParent is not set -- cannot scroll")},t.toggleCheckedBtn=function(e,t,i=null){e.classList.toggle("toggled",t),e.setAttribute("aria-checked",t),i?.classList.toggle("hidden",!t)},t.toggleExpandedBtn=function(e,t,i=null){e.classList.toggle("toggled",t),e.setAttribute("aria-expanded",t),i?.classList.toggle("hidden",!t)},t.watchScroll=function(i,n){function e(e){r=r||window.requestAnimationFrame(function(){r=null;var e=i.scrollLeft,t=a.lastX,t=(e!==t&&(a.right=t<e),a.lastX=e,i.scrollTop),e=a.lastY;t!==e&&(a.down=e<t),a.lastY=t,n(a)})}const a={right:!0,down:!0,lastX:i.scrollLeft,lastY:i.scrollTop,_eventHandler:e};let r=null;return i.addEventListener("scroll",e,!0),a};t.DEFAULT_SCALE_VALUE="auto",t.DEFAULT_SCALE=1,t.DEFAULT_SCALE_DELTA=1.1,t.MIN_SCALE=.1,t.MAX_SCALE=10,t.UNKNOWN_SCALE=0,t.MAX_AUTO_SCALE=1.25,t.SCROLLBAR_PADDING=40,t.VERTICAL_PADDING=5,t.RenderingStates={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};t.PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};const i={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};t.SidebarView=i;t.TextLayerMode={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2};const n={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},a=(t.ScrollMode=n,{UNKNOWN:-1,NONE:0,ODD:1,EVEN:2});t.SpreadMode=a;t.CursorTool={SELECT:0,HAND:1,ZOOM:2};t.AutoPrintRegExp=/\bprint\s*\(/;t.OutputScale=class{constructor(){var e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return 1!==this.sx||1!==this.sy}};const r=/[\x01-\x1F]/g;function E(e,t,i=0){let n=i,a=e.length-1;if(a<0||!t(e[a]))return e.length;if(!t(e[n]))for(;n<a;){var r=n+a>>1;t(e[r])?a=r:n=1+r}return n}function S(n,a,e){if(!(n<2)){let t=a[n].div,i=t.offsetTop+t.clientTop;i>=e&&(t=a[n-1].div,i=t.offsetTop+t.clientTop);for(let e=n-2;0<=e&&!((t=a[e].div).offsetTop+t.clientTop+t.clientHeight<=i);--e)n=e}return n}function s(e){let t=Math.hypot(e.deltaX,e.deltaY);e=Math.atan2(e.deltaY,e.deltaX);return t=-.25*Math.PI<e&&e<.75*Math.PI?-t:t}var o=new Promise(function(e){window.requestAnimationFrame(e)}),o=(t.animationStarted=o,document.documentElement.style);t.docStyle=o;t.ProgressBar=class{#classList=null;#disableAutoFetchTimeout=null;#percent=0;#style=null;#visible=!0;constructor(e){this.#classList=e.classList,this.#style=e.style}get percent(){return this.#percent}set percent(e){var t,i;this.#percent=(t=0,i=100,Math.min(Math.max(e,t),i)),isNaN(e)?this.#classList.add("indeterminate"):(this.#classList.remove("indeterminate"),this.#style.setProperty("--progressBar-percent",this.#percent+"%"))}setWidth(e){e&&0<(e=e.parentNode.offsetWidth-e.offsetWidth)&&this.#style.setProperty("--progressBar-end-offset",e+"px")}setDisableAutoFetch(e=5e3){isNaN(this.#percent)||(this.#disableAutoFetchTimeout&&clearTimeout(this.#disableAutoFetchTimeout),this.show(),this.#disableAutoFetchTimeout=setTimeout(()=>{this.#disableAutoFetchTimeout=null,this.hide()},e))}hide(){this.#visible&&(this.#visible=!1,this.#classList.add("hidden"))}show(){this.#visible||(this.#visible=!0,this.#classList.remove("hidden"))}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterType=void 0,t.getCharacterType=function(e){if(e<11904){if(0==(65408&e))return function(e){return 32===e||9===e||13===e||10===e}(e)?i.SPACE:function(e){return 97<=e&&e<=122||65<=e&&e<=90}(e)||function(e){return 48<=e&&e<=57}(e)||95===e?i.ALPHA_LETTER:i.PUNCT;if(3584==(65408&e))return i.THAI_LETTER;if(160===e)return i.SPACE}else{if(function(e){return 13312<=e&&e<=40959||63744<=e&&e<=64255}(e))return i.HAN_LETTER;if(function(e){return 12448<=e&&e<=12543}(e))return i.KATAKANA_LETTER;if(function(e){return 12352<=e&&e<=12447}(e))return i.HIRAGANA_LETTER;if(function(e){return 65376<=e&&e<=65439}(e))return i.HALFWIDTH_KATAKANA_LETTER}return i.ALPHA_LETTER},t.getNormalizeWithNFKC=function(){return n||="---------------------------------------------------------------------------------------------------"};const i={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};t.CharacterType=i;let n},e=>{let t;t="undefined"!=typeof window&&window["pdfjs-dist/build/pdf"]?window["pdfjs-dist/build/pdf"]:require("../build/pdf.js"),e.exports=t},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleLinkService=t.PDFLinkService=t.LinkTarget=void 0;var o=i(2);const s={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};function n(e,{url:t,target:i,rel:n,enabled:a=!0}={}){if(!t||"string"!=typeof t)throw new Error('A valid "url" parameter must provided.');t=(0,o.removeNullCharacters)(t);a?e.href=e.title=t:(e.href="",e.title="Disabled: "+t,e.onclick=()=>!1);let r="";switch(i){case s.NONE:break;case s.SELF:r="_self";break;case s.BLANK:r="_blank";break;case s.PARENT:r="_parent";break;case s.TOP:r="_top"}e.target=r,e.rel="string"==typeof n?n:"noopener noreferrer nofollow"}t.LinkTarget=s;class l{#pagesRefCache=new Map;constructor({eventBus:e,externalLinkTarget:t=null,externalLinkRel:i=null,ignoreDestinationZoom:n=!1}={}){this.eventBus=e,this.externalLinkTarget=t,this.externalLinkRel=i,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=n,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(e,t=null){this.baseUrl=t,this.pdfDocument=e,this.#pagesRefCache.clear()}setViewer(e){this.pdfViewer=e}setHistory(e){this.pdfHistory=e}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(e){this.pdfViewer.currentPageNumber=e}get rotation(){return this.pdfViewer.pagesRotation}set rotation(e){this.pdfViewer.pagesRotation=e}get isInPresentationMode(){return this.pdfViewer.isInPresentationMode}#goToDestinationHelper(t,i=null,n){const a=n[0];let e;if("object"==typeof a&&null!==a){if(!(e=this._cachedPageNumber(a)))return void this.pdfDocument.getPageIndex(a).then(e=>{this.cachePageRef(e+1,a),this.#goToDestinationHelper(t,i,n)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${a}" is not `+`a valid page reference, for dest="${t}".`)})}else{if(!Number.isInteger(a))return void console.error(`PDFLinkService.#goToDestinationHelper: "${a}" is not `+`a valid destination reference, for dest="${t}".`);e=a+1}!e||e<1||e>this.pagesCount?console.error(`PDFLinkService.#goToDestinationHelper: "${e}" is not `+`a valid page number, for dest="${t}".`):(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:i,explicitDest:n,pageNumber:e})),this.pdfViewer.scrollPageIntoView({pageNumber:e,destArray:n,ignoreDestinationZoom:this._ignoreDestinationZoom}))}async goToDestination(i){if(this.pdfDocument){let e,t;t="string"==typeof i?(e=i,await this.pdfDocument.getDestination(i)):(e=null,await i),Array.isArray(t)?this.#goToDestinationHelper(i,e,t):console.error(`PDFLinkService.goToDestination: "${t}" is not `+`a valid destination array, for dest="${i}".`)}}goToPage(e){var t;this.pdfDocument&&(t="string"==typeof e&&this.pdfViewer.pageLabelToPageNumber(e)||0|e,Number.isInteger(t)&&0<t&&t<=this.pagesCount?(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(t)),this.pdfViewer.scrollPageIntoView({pageNumber:t})):console.error(`PDFLinkService.goToPage: "${e}" is not a valid page.`))}addLinkAttributes(e,t,i=!1){n(e,{url:t,target:i?s.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(e){if("string"==typeof e){if(0<e.length)return this.getAnchorUrl("#"+escape(e))}else if(Array.isArray(e)){e=JSON.stringify(e);if(0<e.length)return this.getAnchorUrl("#"+escape(e))}return this.getAnchorUrl("")}getAnchorUrl(e){return this.baseUrl?this.baseUrl+e:e}setHash(i){if(this.pdfDocument){let e,t;if(i.includes("=")){var n,a,r,s=(0,o.parseQueryString)(i);s.has("search")&&(a=s.get("search").replaceAll('"',""),n="true"===s.get("phrase"),this.eventBus.dispatch("findfromurlhash",{source:this,query:n?a:a.match(/\S+/g)})),s.has("page")&&(e=0|s.get("page")||1),s.has("zoom")&&(a=(n=s.get("zoom").split(","))[0],r=parseFloat(a),a.includes("Fit")?"Fit"===a||"FitB"===a?t=[null,{name:a}]:"FitH"===a||"FitBH"===a||"FitV"===a||"FitBV"===a?t=[null,{name:a},1<n.length?0|n[1]:null]:"FitR"===a?5!==n.length?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):t=[null,{name:a},0|n[1],0|n[2],0|n[3],0|n[4]]:console.error(`PDFLinkService.setHash: "${a}" is not a valid zoom value.`):t=[null,{name:"XYZ"},1<n.length?0|n[1]:null,2<n.length?0|n[2]:null,r?r/100:a]),t?this.pdfViewer.scrollPageIntoView({pageNumber:e||this.page,destArray:t,allowNegativeOffset:!0}):e&&(this.page=e),s.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:s.get("pagemode")}),s.has("nameddest")&&this.goToDestination(s.get("nameddest"))}else{t=unescape(i);try{t=JSON.parse(t),Array.isArray(t)||(t=t.toString())}catch{}"string"==typeof t||l.#isValidExplicitDestination(t)?this.goToDestination(t):console.error(`PDFLinkService.setHash: "${unescape(i)}" is not a valid destination.`)}}}executeNamedAction(e){switch(e){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1}this.eventBus.dispatch("namedaction",{source:this,action:e})}async executeSetOCGState(t){var e=this.pdfDocument,i=await this.pdfViewer.optionalContentConfigPromise;if(e===this.pdfDocument){let e;for(const a of t.state){switch(a){case"ON":case"OFF":case"Toggle":e=a;continue}switch(e){case"ON":i.setVisibility(a,!0);break;case"OFF":i.setVisibility(a,!1);break;case"Toggle":var n=i.getGroup(a);n&&i.setVisibility(a,!n.visible)}}this.pdfViewer.optionalContentConfigPromise=Promise.resolve(i)}}cachePageRef(e,t){t&&(t=0===t.gen?t.num+"R":t.num+"R"+t.gen,this.#pagesRefCache.set(t,e))}_cachedPageNumber(e){return e&&(e=0===e.gen?e.num+"R":e.num+"R"+e.gen,this.#pagesRefCache.get(e))||null}static#isValidExplicitDestination(t){if(!Array.isArray(t))return!1;var i=t.length;if(i<2)return!1;var e=t[0];if(!("object"==typeof e&&Number.isInteger(e.num)&&Number.isInteger(e.gen)||Number.isInteger(e)&&0<=e))return!1;e=t[1];if("object"!=typeof e||"string"!=typeof e.name)return!1;let n=!0;switch(e.name){case"XYZ":if(5!==i)return!1;break;case"Fit":case"FitB":return 2===i;case"FitH":case"FitBH":case"FitV":case"FitBV":if(3!==i)return!1;break;case"FitR":if(6!==i)return!1;n=!1;break;default:return!1}for(let e=2;e<i;e++){var a=t[e];if(!("number"==typeof a||n&&null===a))return!1}return!0}}t.PDFLinkService=l;t.SimpleLinkService=class{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(e){}get rotation(){return 0}set rotation(e){}get isInPresentationMode(){return!1}async goToDestination(e){}goToPage(e){}addLinkAttributes(e,t,i=0){n(e,{url:t,enabled:this.externalLinkEnabled})}getDestinationHash(e){return"#"}getAnchorUrl(e){return"#"}setHash(e){}executeNamedAction(e){}executeSetOCGState(e){}cachePageRef(e,t){}}},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayerBuilder=void 0;var r=i(4),g=i(7),s=i(2);t.AnnotationLayerBuilder=class{#onPresentationModeChanged=null;constructor({pageDiv:e,pdfPage:t,linkService:i,downloadManager:n,annotationStorage:a=null,imageResourcesPath:r="",renderForms:s=!0,l10n:o=g.NullL10n,enableScripting:l=!1,hasJSActionsPromise:h=null,fieldObjectsPromise:d=null,annotationCanvasMap:c=null,accessibilityManager:u=null}){this.pageDiv=e,this.pdfPage=t,this.linkService=i,this.downloadManager=n,this.imageResourcesPath=r,this.renderForms=s,this.l10n=o,this.annotationStorage=a,this.enableScripting=l,this._hasJSActionsPromise=h||Promise.resolve(!1),this._fieldObjectsPromise=d||Promise.resolve(null),this._annotationCanvasMap=c,this._accessibilityManager=u,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=i.eventBus}async render(e,t="display"){if(this.div)return this._cancelled||!this.annotationLayer?void 0:void this.annotationLayer.update({viewport:e.clone({dontFlip:!0})});var i,[t,n,a]=await Promise.all([this.pdfPage.getAnnotations({intent:t}),this._hasJSActionsPromise,this._fieldObjectsPromise]);this._cancelled||((i=this.div=document.createElement("div")).className="annotationLayer",this.pageDiv.append(i),0===t.length?this.hide():(this.annotationLayer=new r.AnnotationLayer({div:i,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,l10n:this.l10n,page:this.pdfPage,viewport:e.clone({dontFlip:!0})}),await this.annotationLayer.render({annotations:t,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:n,fieldObjects:a}),this.linkService.isInPresentationMode&&this.#updatePresentationModeState(s.PresentationModeState.FULLSCREEN),this.#onPresentationModeChanged||(this.#onPresentationModeChanged=e=>{this.#updatePresentationModeState(e.state)},this._eventBus?._on("presentationmodechanged",this.#onPresentationModeChanged))))}cancel(){this._cancelled=!0,this.#onPresentationModeChanged&&(this._eventBus?._off("presentationmodechanged",this.#onPresentationModeChanged),this.#onPresentationModeChanged=null)}hide(){this.div&&(this.div.hidden=!0)}#updatePresentationModeState(t){if(this.div){let e=!1;switch(t){case s.PresentationModeState.FULLSCREEN:e=!0;break;case s.PresentationModeState.NORMAL:break;default:return}for(const i of this.div.childNodes)i.hasAttribute("data-internal-link")||(i.inert=e)}}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=a;const i={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};function a(e,t){switch(e){case"find_match_count":e=`find_match_count[${1===t.total?"one":"other"}]`;break;case"find_match_count_limit":e=`find_match_count_limit[${1===t.limit?"one":"other"}]`}return i[e]||""}i.print_progress_percent="{{progress}}%",t.NullL10n={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(e,t=null,i=a(e,t)){return i=i,(n=t)?i.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(e,t)=>t in n?n[t]:"{{"+t+"}}"):i;var n},async translate(e){}}},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadManager=void 0;var a=i(4);function r(e,t){var i=document.createElement("a");if(!i.click)throw new Error('DownloadManager: "a.click()" is not supported.');i.href=e,i.target="_parent","download"in i&&(i.download=t),(document.body||document.documentElement).append(i),i.click(),i.remove()}t.DownloadManager=class{#openBlobUrls=new WeakMap;downloadUrl(e,t,i){(0,a.createValidAbsoluteUrl)(e,"http://example.com")?r(e+"#pdfjs.action=download",t):console.error("downloadUrl - not a valid URL: "+e)}downloadData(e,t,i){r(URL.createObjectURL(new Blob([e],{type:i})),t)}openOrDownloadData(e,t,i){var n=(0,a.isPdfFile)(i);return this.downloadData(t,i,n?"application/pdf":""),!1}download(e,t,i,n){r(URL.createObjectURL(e),i)}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WaitOnType=t.EventBus=t.AutomationEventBus=void 0,t.waitOnEventOrTimeout=function({target:s,name:o,delay:l=0}){return new Promise(function(t,e){if("object"!=typeof s||!o||"string"!=typeof o||!(Number.isInteger(l)&&0<=l))throw new Error("waitOnEventOrTimeout - invalid parameters.");function i(e){s instanceof d?s._off(o,n):s.removeEventListener(o,n),r&&clearTimeout(r),t(e)}const n=i.bind(null,h.EVENT);s instanceof d?s._on(o,n):s.addEventListener(o,n);var a=i.bind(null,h.TIMEOUT);const r=setTimeout(a,l)})};const h={EVENT:"event",TIMEOUT:"timeout"};t.WaitOnType=h;class d{#listeners=Object.create(null);on(e,t,i=null){this._on(e,t,{external:!0,once:i?.once})}off(e,t,i=null){this._off(e,t,{external:!0,once:i?.once})}dispatch(t,i){var n=this.#listeners[t];if(n&&0!==n.length){let e;for(var{listener:a,external:r,once:s}of n.slice(0))s&&this._off(t,a),r?(e||=[]).push(a):a(i);if(e){for(const o of e)o(i);e=null}}}_on(e,t,i=null){(this.#listeners[e]||=[]).push({listener:t,external:!0===i?.external,once:!0===i?.once})}_off(e,i,t=0){var n=this.#listeners[e];if(n)for(let e=0,t=n.length;e<t;e++)if(n[e].listener===i)return void n.splice(e,1)}}class i extends(t.EventBus=d){dispatch(e,t){throw new Error("Not implemented: AutomationEventBus.dispatch")}}t.AutomationEventBus=i},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GenericL10n=void 0,i(11);var n=i(7);const r={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};t.GenericL10n=class{constructor(n){const a=document["webL10n"];this._lang=n,this._ready=new Promise((e,t)=>{var i;a.setLanguage((i=n,r[i?.toLowerCase()]||i),()=>{e(a)})})}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(e,t=null,i=(0,n.getL10nFallback)(e,t)){return(await this._ready).get(e,t,i)}async translate(e){return(await this._ready).translate(e)}}},()=>{function P(e,t,i){t=t||function(e){},i=i||function(){};var n=new XMLHttpRequest;n.open("GET",e,a),n.overrideMimeType&&n.overrideMimeType("text/plain; charset=utf-8"),n.onreadystatechange=function(){4==n.readyState&&(200==n.status||0===n.status?t(n.responseText):i())},n.onerror=i,n.ontimeout=i;try{n.send(null)}catch(e){i()}}function u(e,m,a,t){var _=e.replace(/[^\/]*$/,"")||"./";function i(e,t){var c={},i=/^\s*|\s*$/,u=/^\s*#|^\s*$/,g=/^\s*\[(.*)\]\s*$/,p=/^\s*@import\s+url\((.*)\)\s*$/i,f=/^([^=\s]*)\s*=\s*(.+)$/;function v(e,a,r){var s=e.replace(i,"").split(/[\r\n]+/),o="*",l=m.split("-",1)[0],h=!1,d="";!function e(){for(;;){if(!s.length)return void r();var t,i,n=s.shift();if(!u.test(n)){if(a){if(d=g.exec(n)){o=d[1].toLowerCase(),h="*"!==o&&o!==m&&o!==l;continue}if(h)continue;if(d=p.exec(n))return t=_+d[1],i=e,void P(t,function(e){v(e,!1,i)},function(){console.warn(t+" not found."),i()})}(n=n.match(f))&&3==n.length&&(c[n[1]]=(n=n[2]).lastIndexOf("\\")<0?n:n.replace(/\\\\/g,"\\").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'"))}}}()}v(e,!0,function(){t(c)})}P(e,function(e){f+=e,i(e,function(e){for(var t in e){var i,n=t.lastIndexOf("."),n=0<n?(i=t.substring(0,n),t.substring(n+1)):(i=t,d);p[i]||(p[i]={}),p[i][n]=e[t]}a&&a()})},t)}function i(e,t){e=e&&e.toLowerCase(),t=t||function(){},p={},v=f="",v=e;var i=g.querySelectorAll('link[type="application/l10n"]'),n=i.length;if(0===n){var a=(o=g.querySelector('script[type="application/l10n"]'))?JSON.parse(o.innerHTML):null;if(a&&a.locales&&a.default_locale){if(console.log("using the embedded JSON directory, early way out"),!(p=a.locales[e])){var r,s=a.default_locale.toLowerCase();for(r in a.locales){if((r=r.toLowerCase())===e){p=a.locales[e];break}r===s&&(p=a.locales[s])}}t()}else console.log("no resource to load, early way out");_="complete"}else for(var o,l=0,h=function(){n<=++l&&(t(),_="complete")},d=0;d<n;d++)new c(i[d]).load(e,h);function c(e){var i=e.href;this.load=function(e,t){u(i,e,t,function(){console.warn(i+" not found."),console.warn('"'+e+'" resource not found'),v="",t()})}}}function h(e,t,i){var n=p[e];if(!n){if(console.warn("#"+e+" is undefined."),!i)return null;n=i}var a,r,s,o,l,h,d,c,u={};for(a in n){var g=n[a];r=g,s=t,o=e,l=a,c=d=h=void 0,(c=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/.exec(r))&&c.length&&(h=c[1],c=c[2],s&&c in s?d=s[c]:c in p&&(d=p[c]),h in m)&&(s=m[h],r=s(r,d,o,l)),g=function(e,i,n){return e.replace(/\{\{\s*(.+?)\s*\}\}/g,function(e,t){return i&&t in i?i[t]:t in p?p[t]:(console.log("argument {{"+t+"}} for #"+n+" is undefined."),e)})}(r,t,e),u[a]=g}return u}function r(e){var t=function(e){if(!e)return{};var t=e.getAttribute("data-l10n-id"),e=e.getAttribute("data-l10n-args"),i={};if(e)try{i=JSON.parse(e)}catch(e){console.warn("could not parse arguments for #"+t)}return{id:t,args:i}}(e);if(t.id){var i=h(t.id,t.args);if(i){if(i[d]){if(0===function(e){if(e.children)return e.children.length;if(void 0!==e.childElementCount)return e.childElementCount;for(var t=0,i=0;i<e.childNodes.length;i++)t+=1===e.nodeType?1:0;return t}(e))e[d]=i[d];else{for(var n,a=e.childNodes,r=!1,s=0,o=a.length;s<o;s++)3===a[s].nodeType&&/\S/.test(a[s].nodeValue)&&(r?a[s].nodeValue="":(a[s].nodeValue=i[d],r=!0));r||(n=g.createTextNode(i[d]),e.prepend(n))}delete i[d]}for(var l in i)e[l]=i[l]}else console.warn("#"+t.id+" is undefined.")}}var e,g,p,f,d,v,m,_,a;document.webL10n=(e=window,g=document,p={},d="textContent",_="loading",a=!(v=f=""),(m={}).plural=function(e,t,i,n){var a,r,s,t=parseFloat(t);return isNaN(t)||n==d&&(m._pluralRules||(m._pluralRules=(s={0:function(e){return"other"},1:function(e){return l(e%100,3,10)?"few":0===e?"zero":l(e%100,11,99)?"many":2==e?"two":1==e?"one":"other"},2:function(e){return 0!==e&&e%10==0?"many":2==e?"two":1==e?"one":"other"},3:function(e){return 1==e?"one":"other"},4:function(e){return l(e,0,1)?"one":"other"},5:function(e){return l(e,0,2)&&2!=e?"one":"other"},6:function(e){return 0===e?"zero":e%10==1&&e%100!=11?"one":"other"},7:function(e){return 2==e?"two":1==e?"one":"other"},8:function(e){return l(e,3,6)?"few":l(e,7,10)?"many":2==e?"two":1==e?"one":"other"},9:function(e){return 0===e||1!=e&&l(e%100,1,19)?"few":1==e?"one":"other"},10:function(e){return l(e%10,2,9)&&!l(e%100,11,19)?"few":e%10!=1||l(e%100,11,19)?"other":"one"},11:function(e){return l(e%10,2,4)&&!l(e%100,12,14)?"few":e%10==0||l(e%10,5,9)||l(e%100,11,14)?"many":e%10==1&&e%100!=11?"one":"other"},12:function(e){return l(e,2,4)?"few":1==e?"one":"other"},13:function(e){return l(e%10,2,4)&&!l(e%100,12,14)?"few":1!=e&&l(e%10,0,1)||l(e%10,5,9)||l(e%100,12,14)?"many":1==e?"one":"other"},14:function(e){return l(e%100,3,4)?"few":e%100==2?"two":e%100==1?"one":"other"},15:function(e){return 0===e||l(e%100,2,10)?"few":l(e%100,11,19)?"many":1==e?"one":"other"},16:function(e){return e%10==1&&11!=e?"one":"other"},17:function(e){return 3==e?"few":0===e?"zero":6==e?"many":2==e?"two":1==e?"one":"other"},18:function(e){return 0===e?"zero":l(e,0,2)&&0!==e&&2!=e?"one":"other"},19:function(e){return l(e,2,10)?"few":l(e,0,1)?"one":"other"},20:function(e){return!l(e%10,3,4)&&e%10!=9||l(e%100,10,19)||l(e%100,70,79)||l(e%100,90,99)?e%1e6==0&&0!==e?"many":e%10!=2||o(e%100,[12,72,92])?e%10!=1||o(e%100,[11,71,91])?"other":"one":"two":"few"},21:function(e){return 0===e?"zero":1==e?"one":"other"},22:function(e){return l(e,0,1)||l(e,11,99)?"one":"other"},23:function(e){return l(e%10,1,2)||e%20==0?"one":"other"},24:function(e){return l(e,3,10)||l(e,13,19)?"few":o(e,[2,12])?"two":o(e,[1,11])?"one":"other"}},(r={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3}[(a=v).replace(/-.*$/,"")])in s?s[r]:(console.warn("plural form unknown for ["+a+"]"),function(){return"other"}))),s="["+m._pluralRules(t)+"]",0===t&&i+"[zero]"in p?e=p[i+"[zero]"][n]:1==t&&i+"[one]"in p?e=p[i+"[one]"][n]:2==t&&i+"[two]"in p?e=p[i+"[two]"][n]:i+s in p?e=p[i+s][n]:i+"[other]"in p&&(e=p[i+"[other]"][n])),e;function o(e,t){return-1!==t.indexOf(e)}function l(e,t,i){return t<=e&&e<=i}},{get:function(e,t,i){var n,a=e.lastIndexOf("."),r=d,a=(0<a&&(r=e.substring(a+1),e=e.substring(0,a)),i&&((n={})[r]=i),h(e,t,n));return a&&r in a?a[r]:"{{"+e+"}}"},getData:function(){return p},getText:function(){return f},getLanguage:function(){return v},setLanguage:function(e,t){i(e,function(){t&&t()})},getDirection:function(){var e=v.split("-",1)[0];return 0<=["ar","he","fa","ps","ur"].indexOf(e)?"rtl":"ltr"},translate:function(e){e=e||g.documentElement;for(var t,i=(t=e)?t.querySelectorAll("*[data-l10n-id]"):[],n=i.length,a=0;a<n;a++)r(i[a]);r(e)},getReadyState:function(){return _},ready:function(t){t&&("complete"==_||"interactive"==_?e.setTimeout(function(){t()}):g.addEventListener&&g.addEventListener("localized",function e(){g.removeEventListener("localized",e),t()}))}})},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFHistory=void 0,t.isDestArraysEqual=o,t.isDestHashesEqual=a;var r=i(2),n=i(9);function s(){return document.location.hash}function a(e,t){return"string"==typeof e&&"string"==typeof t&&(e===t||(0,r.parseQueryString)(e).get("nameddest")===t)}function o(i,n){if(!Array.isArray(i)||!Array.isArray(n))return!1;if(i.length!==n.length)return!1;for(let e=0,t=i.length;e<t;e++)if(!function e(t,i){if(typeof t==typeof i&&!Array.isArray(t)&&!Array.isArray(i)){if(null===t||"object"!=typeof t||null===i)return t===i||Number.isNaN(t)&&Number.isNaN(i);if(Object.keys(t).length===Object.keys(i).length){for(const n in t)if(!e(t[n],i[n]))return;return 1}}}(i[e],n[e]))return!1;return!0}t.PDFHistory=class{constructor({linkService:e,eventBus:t}){this.linkService=e,this.eventBus=t,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",e=>{this._isPagesLoaded=!!e.pagesCount},{once:!0})})}initialize({fingerprint:e,resetHistory:t=!1,updateUrl:i=!1}){if(e&&"string"==typeof e){this._initialized&&this.reset();var n,a,r=""!==this._fingerprint&&this._fingerprint!==e,e=(this._fingerprint=e,this._updateUrl=!0===i,this._initialized=!0,this._bindEvents(),window.history.state);if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=s(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(e,!0)||t)return{hash:i,page:n,rotation:a}=this._parseCurrentHash(!0),!i||r||t?void this._pushOrReplaceState(null,!0):void this._pushOrReplaceState({hash:i,page:n,rotation:a},!0);r=e.destination;this._updateInternalState(r,e.uid,!0),void 0!==r.rotation&&(this._initialRotation=r.rotation),r.dest?(this._initialBookmark=JSON.stringify(r.dest),this._destination.page=null):r.hash?this._initialBookmark=r.hash:r.page&&(this._initialBookmark="page="+r.page)}else console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.')}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:t=null,explicitDest:i,pageNumber:n}){if(this._initialized)if(t&&"string"!=typeof t)console.error("PDFHistory.push: "+`"${t}" is not a valid namedDest parameter.`);else if(Array.isArray(i))if(this._isValidPage(n)||null===n&&!this._destination){t=t||JSON.stringify(i);if(t){let e=!1;if(this._destination&&(a(this._destination.hash,t)||o(this._destination.dest,i))){if(this._destination.page)return;e=!0}this._popStateInProgress&&!e||(this._pushOrReplaceState({dest:i,hash:t,page:n,rotation:this.linkService.rotation},e),this._popStateInProgress)||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))}}else console.error("PDFHistory.push: "+`"${n}" is not a valid pageNumber parameter.`);else console.error("PDFHistory.push: "+`"${i}" is not a valid explicitDest parameter.`)}pushPage(e){this._initialized&&(this._isValidPage(e)?this._destination?.page===e||this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:"page="+e,page:e,rotation:this.linkService.rotation}),this._popStateInProgress)||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})):console.error(`PDFHistory.pushPage: "${e}" is not a valid page number.`))}pushCurrentPosition(){this._initialized&&!this._popStateInProgress&&this._tryPushCurrentPosition()}back(){var e;this._initialized&&!this._popStateInProgress&&(e=window.history.state,this._isValidState(e))&&0<e.uid&&window.history.back()}forward(){var e;this._initialized&&!this._popStateInProgress&&(e=window.history.state,this._isValidState(e))&&e.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||0<this._blockHashChange)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(e,t=!1){var i,t=t||!this._destination,n={fingerprint:this._fingerprint,uid:t?this._uid:this._uid+1,destination:e};this._updateInternalState(e,n.uid);let a;this._updateUrl&&e?.hash&&((i=document.location.href.split("#")[0]).startsWith("file://")||(a=i+"#"+e.hash)),t?window.history.replaceState(n,"",a):window.history.pushState(n,"",a)}_tryPushCurrentPosition(e=!1){if(this._position){let t=this._position;if(e&&((t=Object.assign(Object.create(null),this._position)).temporary=!0),this._destination){if(this._destination.temporary)this._pushOrReplaceState(t,!0);else if(this._destination.hash!==t.hash&&(this._destination.page||!(this._numPositionUpdates<=50))){let e=!1;if(this._destination.page>=t.first&&this._destination.page<=t.page){if(void 0!==this._destination.dest||!this._destination.first)return;e=!0}this._pushOrReplaceState(t,e)}}else this._pushOrReplaceState(t)}}_isValidPage(e){return Number.isInteger(e)&&0<e&&e<=this.linkService.pagesCount}_isValidState(e,t=!1){if(!e)return!1;if(e.fingerprint!==this._fingerprint){if(!t)return!1;if("string"!=typeof e.fingerprint||e.fingerprint.length!==this._fingerprint.length)return!1;var[t]=performance.getEntriesByType("navigation");if("reload"!==t?.type)return!1}return!(!Number.isInteger(e.uid)||e.uid<0)&&null!==e.destination&&"object"==typeof e.destination}_updateInternalState(e,t,i=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),i&&e?.temporary&&delete e.temporary,this._destination=e,this._uid=t,this._maxUid=Math.max(this._maxUid,t),this._numPositionUpdates=0}_parseCurrentHash(e=!1){var t=unescape(s()).substring(1),i=(0,r.parseQueryString)(t),n=i.get("nameddest")||"";let a=0|i.get("page");return{hash:t,page:a=!this._isValidPage(a)||e&&0<n.length?null:a,rotation:this.linkService.rotation}}_updateViewarea({location:e}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:e.pdfOpenParams.substring(1),page:this.linkService.page,first:e.pageNumber,rotation:e.rotation},this._popStateInProgress||(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},1e3))}_popState({state:e}){var t=s(),i=this._currentHash!==t;this._currentHash=t,e?this._isValidState(e)&&(this._popStateInProgress=!0,i&&(this._blockHashChange++,(0,n.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:1e3}).then(()=>{this._blockHashChange--})),t=e.destination,this._updateInternalState(t,e.uid,!0),(0,r.isValidRotation)(t.rotation)&&(this.linkService.rotation=t.rotation),t.dest?this.linkService.goToDestination(t.dest):t.hash?this.linkService.setHash(t.hash):t.page&&(this.linkService.page=t.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})):(this._uid++,{hash:i,page:e,rotation:t}=this._parseCurrentHash(),this._pushOrReplaceState({hash:i,page:e,rotation:t},!0))}_pageHide(){this._destination&&!this._destination.temporary||this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFPageView=void 0;var v=i(4),m=i(2),_=i(14),P=i(6),n=i(15),r=i(7),a=i(5),s=i(16),y=i(17),o=i(18),b=i(19),E=i(20);const l=n.compatibilityParams.maxCanvasPixels||16777216,h=()=>({annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new a.SimpleLinkService}});t.PDFPageView=class{#annotationMode=v.AnnotationMode.ENABLE_FORMS;#layerProperties=null;#loadingId=null;#previousRotation=null;#renderError=null;#renderingState=m.RenderingStates.INITIAL;#textLayerMode=m.TextLayerMode.ENABLE;#useThumbnailCanvas={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#viewportMap=new WeakMap;constructor(e){var t=e.container,i=e.defaultViewport;this.id=e.id,this.renderingId="page"+this.id,this.#layerProperties=e.layerProperties||h,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=e.scale||m.DEFAULT_SCALE,this.viewport=i,this.pdfPageRotate=i.rotation,this._optionalContentConfigPromise=e.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.#textLayerMode=e.textLayerMode??m.TextLayerMode.ENABLE,this.#annotationMode=e.annotationMode??v.AnnotationMode.ENABLE_FORMS,this.imageResourcesPath=e.imageResourcesPath||"",this.useOnlyCssZoom=e.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=e.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=e.maxCanvasPixels||l,this.pageColors=e.pageColors||null,this.eventBus=e.eventBus,this.renderingQueue=e.renderingQueue,this.l10n=e.l10n||r.NullL10n,this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=t,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const n=document.createElement("div");if(n.className="page",n.setAttribute("data-page-number",this.id),n.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(e=>{n.setAttribute("aria-label",e)}),this.div=n,this.#setDimensions(),t?.append(n),this._isStandalone){t?.style.setProperty("--scale-factor",this.scale*v.PixelsPerInch.PDF_TO_CSS_UNITS);const a=e["optionalContentConfigPromise"];a&&a.then(e=>{a===this._optionalContentConfigPromise&&(this.#useThumbnailCanvas.initialOptionalContent=e.hasInitialVisibility)})}}get renderingState(){return this.#renderingState}set renderingState(e){if(e!==this.#renderingState)switch(this.#renderingState=e,this.#loadingId&&(clearTimeout(this.#loadingId),this.#loadingId=null),e){case m.RenderingStates.PAUSED:this.div.classList.remove("loading");break;case m.RenderingStates.RUNNING:this.div.classList.add("loadingIcon"),this.#loadingId=setTimeout(()=>{this.div.classList.add("loading"),this.#loadingId=null},0);break;case m.RenderingStates.INITIAL:case m.RenderingStates.FINISHED:this.div.classList.remove("loadingIcon","loading")}}#setDimensions(){var e=this["viewport"];if(this.pdfPage){if(this.#previousRotation===e.rotation)return;this.#previousRotation=e.rotation}(0,v.setLayerDimensions)(this.div,e,!0,!1)}setPdfPage(e){!this._isStandalone||"CanvasText"!==this.pageColors?.foreground&&"Canvas"!==this.pageColors?.background||this._container?.style.setProperty("--hcm-highligh-filter",e.filterFactory.addHighlightHCMFilter("CanvasText","Canvas","HighlightText","Highlight")),this.pdfPage=e,this.pdfPageRotate=e.rotate;var t=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:this.scale*v.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:t}),this.#setDimensions(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}get _textHighlighter(){return(0,v.shadow)(this,"_textHighlighter",new o.TextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#layerProperties().findController}))}async#renderAnnotationLayer(){let t=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(e){console.error(`#renderAnnotationLayer: "${e}".`),t=e}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:t})}}async#renderAnnotationEditorLayer(){let t=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(e){console.error(`#renderAnnotationEditorLayer: "${e}".`),t=e}finally{this.eventBus.dispatch("annotationeditorlayerrendered",{source:this,pageNumber:this.id,error:t})}}async#renderXfaLayer(){let t=null;try{var e=await this.xfaLayer.render(this.viewport,"display");e?.textDivs&&this._textHighlighter&&this.#buildXfaTextContentItems(e.textDivs)}catch(e){console.error(`#renderXfaLayer: "${e}".`),t=e}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:t})}}async#renderTextLayer(){var e,{pdfPage:i,textLayer:n,viewport:a}=this;if(n){let t=null;try{n.renderingDone||(e=i.streamTextContent({includeMarkedContent:!0,disableNormalization:!0}),n.setTextContentSource(e)),await n.render(a)}catch(e){if(e instanceof v.AbortException)return;console.error(`#renderTextLayer: "${e}".`),t=e}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.id,numTextDivs:n.numTextDivs,error:t}),this.#renderStructTreeLayer()}}async#renderStructTreeLayer(){var e;this.textLayer&&(this.structTreeLayer||=new s.StructTreeLayerBuilder,e=await(this.structTreeLayer.renderingDone?null:this.pdfPage.getStructTree()),(e=this.structTreeLayer?.render(e))&&this.canvas?.append(e),this.structTreeLayer?.show())}async#buildXfaTextContentItems(e){var t=[];for(const i of(await this.pdfPage.getTextContent()).items)t.push(i.str);this._textHighlighter.setTextMapping(e,t),this._textHighlighter.enable()}_resetZoomLayer(e=!1){var t;this.zoomLayer&&(t=this.zoomLayer.firstChild,this.#viewportMap.delete(t),t.width=0,t.height=0,e&&this.zoomLayer.remove(),this.zoomLayer=null)}reset({keepZoomLayer:e=!1,keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:i=!1,keepXfaLayer:n=!1,keepTextLayer:a=!1}={}){this.cancelRendering({keepAnnotationLayer:t,keepAnnotationEditorLayer:i,keepXfaLayer:n,keepTextLayer:a}),this.renderingState=m.RenderingStates.INITIAL;var r=this.div,s=r.childNodes,o=e&&this.zoomLayer||null,l=t&&this.annotationLayer?.div||null,h=i&&this.annotationEditorLayer?.div||null,d=n&&this.xfaLayer?.div||null,c=a&&this.textLayer?.div||null;for(let e=s.length-1;0<=e;e--){var u=s[e];switch(u){case o:case l:case h:case d:case c:continue}u.remove()}r.removeAttribute("data-loaded"),l&&this.annotationLayer.hide(),h&&this.annotationEditorLayer.hide(),d&&this.xfaLayer.hide(),c&&this.textLayer.hide(),this.structTreeLayer?.hide(),o||(this.canvas&&(this.#viewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}update({scale:e=0,rotation:t=null,optionalContentConfigPromise:i=null,drawingDelay:n=-1}){this.scale=e||this.scale,"number"==typeof t&&(this.rotation=t),i instanceof Promise&&(this._optionalContentConfigPromise=i).then(e=>{i===this._optionalContentConfigPromise&&(this.#useThumbnailCanvas.initialOptionalContent=e.hasInitialVisibility)}),this.#useThumbnailCanvas.directDrawing=!0;var a,e=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:this.scale*v.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:e}),this.#setDimensions(),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale);let r=!1;this.canvas&&0<this.maxCanvasPixels&&({width:t,height:e}=this.viewport,{sx:s,sy:a}=this.outputScale,(Math.floor(t)*s|0)*(Math.floor(e)*a|0)>this.maxCanvasPixels)&&(r=!0);var t=this.useOnlyCssZoom||this.hasRestrictedScaling&&r,s=!t&&0<=n&&n<1e3;if(this.canvas){if(s||t)return s&&this.renderingState!==m.RenderingStates.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:n}),this.renderingState=m.RenderingStates.FINISHED,this.#useThumbnailCanvas.directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!s,hideTextLayer:s}),s?void 0:void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this.#renderError});this.zoomLayer||this.canvas.hidden||(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:e=!1,keepAnnotationEditorLayer:t=!1,keepXfaLayer:i=!1,keepTextLayer:n=!1,cancelExtraDelay:a=0}={}){this.renderTask&&(this.renderTask.cancel(a),this.renderTask=null),this.resume=null,!this.textLayer||n&&this.textLayer.div||(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),!this.annotationLayer||e&&this.annotationLayer.div||(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),!this.annotationEditorLayer||t&&this.annotationEditorLayer.div||(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),!this.xfaLayer||i&&this.xfaLayer.div||(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({target:i,redrawAnnotationLayer:e=!1,redrawAnnotationEditorLayer:t=!1,redrawXfaLayer:n=!1,redrawTextLayer:a=!1,hideTextLayer:r=!1}){i.hasAttribute("zooming")||(i.setAttribute("zooming",!0),s=i["style"],s.width=s.height="");var s=this.#viewportMap.get(i);if(this.viewport!==s){var o,s=this.viewport.rotation-s.rotation,l=Math.abs(s);let e=1,t=1;90!==l&&270!==l||({width:l,height:o}=this.viewport,e=o/l,t=l/o),i.style.transform=`rotate(${s}deg) scale(${e}, ${t})`}e&&this.annotationLayer&&this.#renderAnnotationLayer(),t&&this.annotationEditorLayer&&this.#renderAnnotationEditorLayer(),n&&this.xfaLayer&&this.#renderXfaLayer(),this.textLayer&&(r?(this.textLayer.hide(),this.structTreeLayer?.hide()):a&&this.#renderTextLayer())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(e,t){return this.viewport.convertToPdfPoint(e,t)}async#finishRenderTask(e,t=null){if(e===this.renderTask&&(this.renderTask=null),t instanceof v.RenderingCancelledException)this.#renderError=null;else if(this.#renderError=t,this.renderingState=m.RenderingStates.FINISHED,this._resetZoomLayer(!0),this.#useThumbnailCanvas.regularAnnotations=!e.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this.#renderError}),t)throw t}async draw(){this.renderingState!==m.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:t,l10n:i,pageColors:e,pdfPage:n,viewport:a}=this;if(!n)throw this.renderingState=m.RenderingStates.FINISHED,new Error("pdfPage is not loaded");this.renderingState=m.RenderingStates.RUNNING;var r=document.createElement("div"),{width:s,height:o}=(r.classList.add("canvasWrapper"),t.append(r),this.textLayer||this.#textLayerMode===m.TextLayerMode.DISABLE||n.isPureXfa||(this._accessibilityManager||=new y.TextAccessibilityManager,this.textLayer=new b.TextLayerBuilder({highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,enablePermissions:this.#textLayerMode===m.TextLayerMode.ENABLE_PERMISSIONS}),t.append(this.textLayer.div)),this.annotationLayer||this.#annotationMode===v.AnnotationMode.DISABLE||({annotationStorage:s,downloadManager:c,enableScripting:u,fieldObjectsPromise:p,hasJSActionsPromise:g,linkService:o}=this.#layerProperties(),this._annotationCanvasMap||=new Map,this.annotationLayer=new P.AnnotationLayerBuilder({pageDiv:t,pdfPage:n,annotationStorage:s,imageResourcesPath:this.imageResourcesPath,renderForms:this.#annotationMode===v.AnnotationMode.ENABLE_FORMS,linkService:o,downloadManager:c,l10n:i,enableScripting:u,hasJSActionsPromise:g,fieldObjectsPromise:p,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager})),a);const l=document.createElement("canvas"),h=(l.setAttribute("role","presentation"),l.hidden=!0,!(!e?.background||!e?.foreground));let d=e=>{h&&!e||(l.hidden=!1,d=null)};r.append(l);var c=(this.canvas=l).getContext("2d",{alpha:!1}),u=this.outputScale=new m.OutputScale,r=(this.useOnlyCssZoom&&(g=a.clone({scale:v.PixelsPerInch.PDF_TO_CSS_UNITS}),u.sx*=g.width/s,u.sy*=g.height/o),0<this.maxCanvasPixels&&(p=Math.sqrt(this.maxCanvasPixels/(s*o)),u.sx>p||u.sy>p?(u.sx=p,u.sy=p,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1),(0,m.approximateFraction)(u.sx)),g=(0,m.approximateFraction)(u.sy),p=(l.width=(0,m.roundToDivide)(s*u.sx,r[0]),l.height=(0,m.roundToDivide)(o*u.sy,g[0]),l)["style"],s=(p.width=(0,m.roundToDivide)(s,r[1])+"px",p.height=(0,m.roundToDivide)(o,g[1])+"px",this.#viewportMap.set(l,a),u.scaled?[u.sx,0,0,u.sy,0,0]:null),r={canvasContext:c,transform:s,viewport:a,annotationMode:this.#annotationMode,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:e};const f=this.renderTask=this.pdfPage.render(r);f.onContinue=e=>{d?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)?(this.renderingState=m.RenderingStates.PAUSED,this.resume=()=>{this.renderingState=m.RenderingStates.RUNNING,e()}):e()};p=f.promise.then(async()=>{if(d?.(!0),await this.#finishRenderTask(f),this.#renderTextLayer(),this.annotationLayer&&await this.#renderAnnotationLayer(),!this.annotationEditorLayer){var e=this.#layerProperties()["annotationEditorUIManager"];if(!e)return;this.annotationEditorLayer=new _.AnnotationEditorLayerBuilder({uiManager:e,pageDiv:t,pdfPage:n,l10n:i,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer})}this.#renderAnnotationEditorLayer()},e=>(e instanceof v.RenderingCancelledException||d?.(!0),this.#finishRenderTask(f,e)));return n.isPureXfa&&(this.xfaLayer?this.xfaLayer.div&&t.append(this.xfaLayer.div):({annotationStorage:o,linkService:g}=this.#layerProperties(),this.xfaLayer=new E.XfaLayerBuilder({pageDiv:t,pdfPage:n,annotationStorage:o,linkService:g})),this.#renderXfaLayer()),t.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),p}setPageLabel(e){this.pageLabel="string"==typeof e?e:null,null!==this.pageLabel?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){var{directDrawing:e,initialOptionalContent:t,regularAnnotations:i}=this.#useThumbnailCanvas;return e&&t&&i?this.canvas:null}}},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayerBuilder=void 0;var n=i(4),a=i(7);t.AnnotationEditorLayerBuilder=class{#annotationLayer=null;#uiManager;constructor(e){this.pageDiv=e.pageDiv,this.pdfPage=e.pdfPage,this.accessibilityManager=e.accessibilityManager,this.l10n=e.l10n||a.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#uiManager=e.uiManager,this.#annotationLayer=e.annotationLayer||null}async render(e,t="display"){var i;"display"!==t||this._cancelled||(e=e.clone({dontFlip:!0}),this.div?this.annotationEditorLayer.update({viewport:e}):((i=this.div=document.createElement("div")).className="annotationEditorLayer",i.tabIndex=0,i.hidden=!0,this.pageDiv.append(i),this.annotationEditorLayer=new n.AnnotationEditorLayer({uiManager:this.#uiManager,div:i,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:e,annotationLayer:this.#annotationLayer}),this.annotationEditorLayer.render({viewport:e,div:i,annotations:null,intent:t})),this.show())}cancel(){this._cancelled=!0,this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}hide(){this.div&&(this.div.hidden=!0)}show(){this.div&&!this.annotationEditorLayer.isEmpty&&(this.div.hidden=!1)}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.compatibilityParams=t.OptionKind=t.AppOptions=void 0;const s=Object.create(null);t.compatibilityParams=s;{var i=navigator.userAgent||"",n=navigator.platform||"",a=navigator.maxTouchPoints||1;const d=/Android/.test(i),c=/\b(iPad|iPhone|iPod)(?=;)/.test(i)||"MacIntel"===n&&1<a;(c||d)&&(s.maxCanvasPixels=5242880)}const o={VIEWER:2,API:4,WORKER:8,PREFERENCE:128},l={annotationEditorMode:{value:0,kind:(t.OptionKind=o).VIEWER+o.PREFERENCE},annotationMode:{value:2,kind:o.VIEWER+o.PREFERENCE},cursorToolOnLoad:{value:0,kind:o.VIEWER+o.PREFERENCE},defaultZoomDelay:{value:400,kind:o.VIEWER+o.PREFERENCE},defaultZoomValue:{value:"",kind:o.VIEWER+o.PREFERENCE},disableHistory:{value:!1,kind:o.VIEWER},disablePageLabels:{value:!1,kind:o.VIEWER+o.PREFERENCE},enablePermissions:{value:!1,kind:o.VIEWER+o.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:o.VIEWER+o.PREFERENCE},enableScripting:{value:!0,kind:o.VIEWER+o.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:o.VIEWER},externalLinkTarget:{value:0,kind:o.VIEWER+o.PREFERENCE},historyUpdateUrl:{value:!1,kind:o.VIEWER+o.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:o.VIEWER+o.PREFERENCE},imageResourcesPath:{value:"./images/",kind:o.VIEWER},maxCanvasPixels:{value:16777216,kind:o.VIEWER},forcePageColors:{value:!1,kind:o.VIEWER+o.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:o.VIEWER+o.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:o.VIEWER+o.PREFERENCE},pdfBugEnabled:{value:!1,kind:o.VIEWER+o.PREFERENCE},printResolution:{value:150,kind:o.VIEWER},sidebarViewOnLoad:{value:-1,kind:o.VIEWER+o.PREFERENCE},scrollModeOnLoad:{value:-1,kind:o.VIEWER+o.PREFERENCE},spreadModeOnLoad:{value:-1,kind:o.VIEWER+o.PREFERENCE},textLayerMode:{value:1,kind:o.VIEWER+o.PREFERENCE},useOnlyCssZoom:{value:!1,kind:o.VIEWER+o.PREFERENCE},viewerCssTheme:{value:0,kind:o.VIEWER+o.PREFERENCE},viewOnLoad:{value:0,kind:o.VIEWER+o.PREFERENCE},cMapPacked:{value:!0,kind:o.API},cMapUrl:{value:"../web/cmaps/",kind:o.API},disableAutoFetch:{value:!1,kind:o.API+o.PREFERENCE},disableFontFace:{value:!1,kind:o.API+o.PREFERENCE},disableRange:{value:!1,kind:o.API+o.PREFERENCE},disableStream:{value:!1,kind:o.API+o.PREFERENCE},docBaseUrl:{value:"",kind:o.API},enableXfa:{value:!0,kind:o.API+o.PREFERENCE},fontExtraProperties:{value:!1,kind:o.API},isEvalSupported:{value:!0,kind:o.API},isOffscreenCanvasSupported:{value:!0,kind:o.API},maxImageSize:{value:-1,kind:o.API},pdfBug:{value:!1,kind:o.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:o.API},verbosity:{value:1,kind:o.API},workerPort:{value:null,kind:o.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:o.WORKER}},h=(l.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:o.VIEWER},l.disablePreferences={value:!1,kind:o.VIEWER},l.locale={value:navigator.language||"en-US",kind:o.VIEWER},l.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:o.VIEWER},Object.create(null));class r{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(e){var t=h[e];return void 0!==t?t:void 0!==(t=l[e])?s[e]??t.value:void 0}static getAll(e=null){var t=Object.create(null);for(const r in l){var i=l[r];if(e){if(0==(e&i.kind))continue;if(e===o.PREFERENCE){var n=i.value,a=typeof n;if("boolean"==a||"string"==a||"number"==a&&Number.isInteger(n)){t[r]=n;continue}throw new Error("Invalid type for preference: "+r)}}a=h[r];t[r]=void 0!==a?a:s[r]??i.value}return t}static set(e,t){h[e]=t}static setAll(e){for(const t in e)h[t]=e[t]}static remove(e){delete h[e]}}(t.AppOptions=r)._hasUserOptions=function(){return 0<Object.keys(h).length}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StructTreeLayerBuilder=void 0;const r={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},s=/^H(\d+)$/;t.StructTreeLayerBuilder=class{#treeDom=void 0;get renderingDone(){return void 0!==this.#treeDom}render(e){return void 0!==this.#treeDom?this.#treeDom:((e=this.#walk(e))?.classList.add("structTree"),this.#treeDom=e)}hide(){this.#treeDom&&!this.#treeDom.hidden&&(this.#treeDom.hidden=!0)}show(){this.#treeDom?.hidden&&(this.#treeDom.hidden=!1)}#setAttributes(e,t){void 0!==e.alt&&t.setAttribute("aria-label",e.alt),void 0!==e.id&&t.setAttribute("aria-owns",e.id),void 0!==e.lang&&t.setAttribute("lang",e.lang)}#walk(e){if(!e)return null;var t,i,n=document.createElement("span");if("role"in e&&(t=e["role"],(i=t.match(s))?(n.setAttribute("role","heading"),n.setAttribute("aria-level",i[1])):r[t]&&n.setAttribute("role",r[t])),this.#setAttributes(e,n),e.children)if(1===e.children.length&&"id"in e.children[0])this.#setAttributes(e.children[0],n);else for(const a of e.children)n.append(this.#walk(a));return n}}},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextAccessibilityManager=void 0;var r=i(2);class s{#enabled=!1;#textChildren=null;#textNodes=new Map;#waitingElements=new Map;setTextMapping(e){this.#textChildren=e}static#compareElementPositions(e,t){var i,n,a,r,s,o,e=e.getBoundingClientRect(),t=t.getBoundingClientRect();return 0===e.width&&0===e.height?1:0===t.width&&0===t.height||(i=e.y,n=e.y+e.height,a=e.y+e.height/2,r=t.y,s=t.y+t.height,o=t.y+t.height/2,a<=r&&n<=o)?-1:o<=i&&s<=a?1:e.x+e.width/2-(t.x+t.width/2)}enable(){if(this.#enabled)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#textChildren)throw new Error("Text divs and strings have not been set.");if(this.#enabled=!0,this.#textChildren=this.#textChildren.slice(),this.#textChildren.sort(s.#compareElementPositions),0<this.#textNodes.size){var e,t,i=this.#textChildren;for([e,t]of this.#textNodes)document.getElementById(e)?this.#addIdToAriaOwns(e,i[t]):this.#textNodes.delete(e)}for(var[n,a]of this.#waitingElements)this.addPointerInTextLayer(n,a);this.#waitingElements.clear()}disable(){this.#enabled&&(this.#waitingElements.clear(),this.#textChildren=null,this.#enabled=!1)}removePointerInTextLayer(e){if(this.#enabled){var t=this.#textChildren;if(t&&0!==t.length){const n=e["id"];var i=this.#textNodes.get(n);if(void 0!==i){t=t[i];this.#textNodes.delete(n);let e=t.getAttribute("aria-owns");e?.includes(n)&&((e=e.split(" ").filter(e=>e!==n).join(" "))?t.setAttribute("aria-owns",e):(t.removeAttribute("aria-owns"),t.setAttribute("role","presentation")))}}}else this.#waitingElements.delete(e)}#addIdToAriaOwns(e,t){var i=t.getAttribute("aria-owns");i?.includes(e)||t.setAttribute("aria-owns",i?i+" "+e:e),t.removeAttribute("role")}addPointerInTextLayer(t,e){var i,n,a=t["id"];a&&(this.#enabled?(e&&this.removePointerInTextLayer(t),(i=this.#textChildren)&&0!==i.length&&(n=(0,r.binarySearchFirstItem)(i,e=>s.#compareElementPositions(t,e)<0),n=Math.max(0,n-1),this.#addIdToAriaOwns(a,i[n]),this.#textNodes.set(a,n))):this.#waitingElements.set(t,e))}moveElementInDOM(e,t,i,n){if(this.addPointerInTextLayer(i,n),e.hasChildNodes()){n=Array.from(e.childNodes).filter(e=>e!==t);if(0!==n.length){const a=i||t;i=(0,r.binarySearchFirstItem)(n,e=>s.#compareElementPositions(a,e)<0);0===i?n[0].before(t):n[i-1].after(t)}}else e.append(t)}}t.TextAccessibilityManager=s},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextHighlighter=void 0;t.TextHighlighter=class{constructor({findController:e,eventBus:t,pageIndex:i}){this.findController=e,this.matches=[],this.eventBus=t,this.pageIdx=i,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(e,t){this.textDivs=e,this.textContentItemsStr=t}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=e=>{e.pageIndex!==this.pageIdx&&-1!==e.pageIndex||this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null),this._updateMatches(!0))}_convertMatches(i,n){if(!i)return[];var a=this["textContentItemsStr"];let r=0,s=0;var o=a.length-1,l=[];for(let t=0,e=i.length;t<e;t++){let e=i[t];for(;r!==o&&e>=s+a[r].length;)s+=a[r].length,r++;r===a.length&&console.error("Could not find a matching mapping");var h={begin:{divIdx:r,offset:e-s}};for(e+=n[t];r!==o&&e>s+a[r].length;)s+=a[r].length,r++;h.end={divIdx:r,offset:e-s},l.push(h)}return l}_renderMatches(s){if(0!==s.length){var{findController:o,pageIdx:l}=this;const{textContentItemsStr:_,textDivs:P}=this;var h=l===o.selected.pageIdx,d=o.selected.matchIdx,t=o.state.highlightAll;let i=null;var c={divIdx:-1,offset:void 0};let e=d,n=e+1;if(t)e=0,n=s.length;else if(!h)return;let a=-1,r=-1;for(let t=e;t<n;t++){var u=s[t],g=u.begin;if(g.divIdx!==a||g.offset!==r){a=g.divIdx,r=g.offset;var u=u.end,p=h&&t===d,f=p?" selected":"";let e=0;if(i&&g.divIdx===i.divIdx?m(i.divIdx,i.offset,g.offset):(null!==i&&m(i.divIdx,i.offset,c.offset),v(g)),g.divIdx===u.divIdx)e=m(g.divIdx,g.offset,u.offset,"highlight"+f);else{e=m(g.divIdx,g.offset,c.offset,"highlight begin"+f);for(let e=g.divIdx+1,t=u.divIdx;e<t;e++)P[e].className="highlight middle"+f;v(u,"highlight end"+f)}i=u,p&&o.scrollMatchIntoView({element:P[g.divIdx],selectedLeft:e,pageIndex:l,matchIndex:d})}}function v(e,t){var i=e.divIdx;P[i].textContent="",m(i,0,e.offset,t)}function m(e,t,i,n){let a=P[e];a.nodeType===Node.TEXT_NODE&&(r=document.createElement("span"),a.before(r),r.append(a),P[e]=r,a=r);var r=_[e].substring(t,i),e=document.createTextNode(r);return n?((t=document.createElement("span")).className=n+" appended",t.append(e),a.append(t),n.includes("selected")?t.offsetLeft:0):(a.append(e),0)}i&&m(i.divIdx,i.offset,c.offset)}}_updateMatches(e=!1){if(this.enabled||e){var{findController:t,matches:n,pageIdx:a}=this,{textContentItemsStr:r,textDivs:s}=this;let i=-1;for(const l of n){for(let e=Math.max(i,l.begin.divIdx),t=l.end.divIdx;e<=t;e++){var o=s[e];o.textContent=r[e],o.className=""}i=l.end.divIdx+1}t?.highlightMatches&&!e&&(n=t.pageMatches[a]||null,e=t.pageMatchesLength[a]||null,this.matches=this._convertMatches(n,e),this._renderMatches(this.matches))}}}},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerBuilder=void 0;var r=i(4),a=i(2);t.TextLayerBuilder=class{#enablePermissions=!1;#rotation=0;#scale=0;#textContentSource=null;constructor({highlighter:e=null,accessibilityManager:t=null,isOffscreenCanvasSupported:i=!0,enablePermissions:n=!1}){this.textContentItemsStr=[],this.renderingDone=!1,this.textDivs=[],this.textDivProperties=new WeakMap,this.textLayerRenderTask=null,this.highlighter=e,this.accessibilityManager=t,this.isOffscreenCanvasSupported=i,this.#enablePermissions=!0===n,this.div=document.createElement("div"),this.div.className="textLayer",this.hide()}#finishRendering(){this.renderingDone=!0;var e=document.createElement("div");e.className="endOfContent",this.div.append(e),this.#bindMouse()}get numTextDivs(){return this.textDivs.length}async render(e){if(!this.#textContentSource)throw new Error('No "textContentSource" parameter specified.');var t,i,n=e.scale*(globalThis.devicePixelRatio||1),a=e["rotation"];this.renderingDone?(t=a!==this.#rotation,i=n!==this.#scale,(t||i)&&(this.hide(),(0,r.updateTextLayer)({container:this.div,viewport:e,textDivs:this.textDivs,textDivProperties:this.textDivProperties,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,mustRescale:i,mustRotate:t}),this.#scale=n,this.#rotation=a),this.show()):(this.cancel(),this.highlighter?.setTextMapping(this.textDivs,this.textContentItemsStr),this.accessibilityManager?.setTextMapping(this.textDivs),this.textLayerRenderTask=(0,r.renderTextLayer)({textContentSource:this.#textContentSource,container:this.div,viewport:e,textDivs:this.textDivs,textDivProperties:this.textDivProperties,textContentItemsStr:this.textContentItemsStr,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),await this.textLayerRenderTask.promise,this.#finishRendering(),this.#scale=n,this.#rotation=a,this.show(),this.accessibilityManager?.enable())}hide(){this.div.hidden||(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.renderingDone&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),this.highlighter?.disable(),this.accessibilityManager?.disable(),this.textContentItemsStr.length=0,this.textDivs.length=0,this.textDivProperties=new WeakMap}setTextContentSource(e){this.cancel(),this.#textContentSource=e}#bindMouse(){const n=this["div"];n.addEventListener("mousedown",e=>{var t,i=n.querySelector(".endOfContent");i&&(t=e.target!==n,(t&&="none"!==getComputedStyle(i).getPropertyValue("-moz-user-select"))&&(t=n.getBoundingClientRect(),e=Math.max(0,(e.pageY-t.top)/t.height),i.style.top=(100*e).toFixed(2)+"%"),i.classList.add("active"))}),n.addEventListener("mouseup",()=>{var e=n.querySelector(".endOfContent");e&&(e.style.top="",e.classList.remove("active"))}),n.addEventListener("copy",e=>{var t;this.#enablePermissions||(t=document.getSelection(),e.clipboardData.setData("text/plain",(0,a.removeNullCharacters)((0,r.normalizeUnicode)(t.toString())))),e.preventDefault(),e.stopPropagation()})}}},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayerBuilder=void 0;var a=i(4);t.XfaLayerBuilder=class{constructor({pageDiv:e,pdfPage:t,annotationStorage:i=null,linkService:n,xfaHtml:a=null}){this.pageDiv=e,this.pdfPage=t,this.annotationStorage=i,this.linkService=n,this.xfaHtml=a,this.div=null,this._cancelled=!1}async render(e,t="display"){if("print"===t){const n={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};var i=document.createElement("div");return this.pageDiv.append(i),n.div=i,a.XfaLayer.render(n)}i=await this.pdfPage.getXfa();if(this._cancelled||!i)return{textDivs:[]};const n={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:i,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div?a.XfaLayer.update(n):(this.div=document.createElement("div"),this.pageDiv.append(this.div),n.div=this.div,a.XfaLayer.render(n))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}},(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFScriptingManager=void 0;var d=r(2),s=r(4);t.PDFScriptingManager=class{#closeCapability=null;#destroyCapability=null;#docProperties=null;#eventBus=null;#externalServices=null;#pdfDocument=null;#pdfViewer=null;#ready=!1;#sandboxBundleSrc=null;#scripting=null;constructor({eventBus:e,sandboxBundleSrc:t=null,externalServices:i=null,docProperties:n=null}){this.#eventBus=e,this.#sandboxBundleSrc=t,this.#externalServices=i,this.#docProperties=n;const a=r(22);this.#externalServices||={createScripting:e=>new a.GenericScripting(e.sandboxBundleSrc)},this.#docProperties||=e=>a.docProperties(e),i||window.addEventListener("updatefromsandbox",e=>{this.#eventBus.dispatch("updatefromsandbox",{source:window,detail:e.detail})})}setViewer(e){this.#pdfViewer=e}async setDocument(e){if(this.#pdfDocument&&await this.#destroyScripting(),this.#pdfDocument=e){var[t,i,n]=await Promise.all([e.getFieldObjects(),e.getCalculationOrderIds(),e.getJSActions()]);if(t||n){if(e===this.#pdfDocument){try{this.#scripting=this.#initScripting()}catch(e){return console.error(`setDocument: "${e.message}".`),void await this.#destroyScripting()}this._internalEvents.set("updatefromsandbox",e=>{e?.source===window&&this.#updateFromSandbox(e.detail)}),this._internalEvents.set("dispatcheventinsandbox",e=>{this.#scripting?.dispatchEventInSandbox(e.detail)}),this._internalEvents.set("pagechanging",({pageNumber:e,previous:t})=>{e!==t&&(this.#dispatchPageClose(t),this.#dispatchPageOpen(e))}),this._internalEvents.set("pagerendered",({pageNumber:e})=>{this._pageOpenPending.has(e)&&e===this.#pdfViewer.currentPageNumber&&this.#dispatchPageOpen(e)}),this._internalEvents.set("pagesdestroy",async()=>{await this.#dispatchPageClose(this.#pdfViewer.currentPageNumber),await this.#scripting?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this.#closeCapability?.resolve()});for(var[a,r]of this._internalEvents)this.#eventBus._on(a,r);try{var s=await this.#docProperties(e);if(e!==this.#pdfDocument)return;await this.#scripting.createSandbox({objects:t,calculationOrder:i,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...s,actions:n}}),this.#eventBus.dispatch("sandboxcreated",{source:this})}catch(e){return console.error(`setDocument: "${e.message}".`),void await this.#destroyScripting()}await this.#scripting?.dispatchEventInSandbox({id:"doc",name:"Open"}),await this.#dispatchPageOpen(this.#pdfViewer.currentPageNumber,!0),Promise.resolve().then(()=>{e===this.#pdfDocument&&(this.#ready=!0)})}}else await this.#destroyScripting()}}async dispatchWillSave(){return this.#scripting?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){return this.#scripting?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){return this.#scripting?.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}async dispatchDidPrint(){return this.#scripting?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){return this.#destroyCapability?.promise||null}get ready(){return this.#ready}get _internalEvents(){return(0,s.shadow)(this,"_internalEvents",new Map)}get _pageOpenPending(){return(0,s.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,s.shadow)(this,"_visitedPages",new Map)}async#updateFromSandbox(e){var t,i=this.#pdfViewer,n=i.isInPresentationMode||i.isChangingPresentationMode,{id:a,siblings:r,command:s,value:o}=e;if(a){if(!n||!e.focus){delete e.id,delete e.siblings;for(const h of r?[a,...r]:[a]){var l=document.querySelector(`[data-element-id="${h}"]`);l?l.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:e})):this.#pdfDocument?.annotationStorage.setValue(h,e)}}}else switch(s){case"clear":console.clear();break;case"error":console.error(o);break;case"layout":n||(t=(0,d.apiPageLayoutToViewerModes)(o),i.spreadMode=t.spreadMode);break;case"page-num":i.currentPageNumber=o+1;break;case"print":await i.pagesPromise,this.#eventBus.dispatch("print",{source:this});break;case"println":console.log(o);break;case"zoom":n||(i.currentScaleValue=o);break;case"SaveAs":this.#eventBus.dispatch("download",{source:this});break;case"FirstPage":i.currentPageNumber=1;break;case"LastPage":i.currentPageNumber=i.pagesCount;break;case"NextPage":i.nextPage();break;case"PrevPage":i.previousPage();break;case"ZoomViewIn":n||i.increaseScale();break;case"ZoomViewOut":n||i.decreaseScale()}}async#dispatchPageOpen(t,e=!1){const i=this.#pdfDocument,n=this._visitedPages;if(e&&(this.#closeCapability=new s.PromiseCapability),this.#closeCapability){const a=this.#pdfViewer.getPageView(t-1);a?.renderingState!==d.RenderingStates.FINISHED?this._pageOpenPending.add(t):(this._pageOpenPending.delete(t),e=(async()=>{var e=await(n.has(t)?null:a.pdfPage?.getJSActions());i===this.#pdfDocument&&await this.#scripting?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:t,actions:e})})(),n.set(t,e))}}async#dispatchPageClose(e){var t,i=this.#pdfDocument,n=this._visitedPages;this.#closeCapability&&!this._pageOpenPending.has(e)&&(t=n.get(e))&&(n.set(e,null),await t,i===this.#pdfDocument)&&await this.#scripting?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:e})}#initScripting(){if(this.#destroyCapability=new s.PromiseCapability,this.#scripting)throw new Error("#initScripting: Scripting already exists.");return this.#externalServices.createScripting({sandboxBundleSrc:this.#sandboxBundleSrc})}async#destroyScripting(){if(this.#scripting){this.#closeCapability&&(await Promise.race([this.#closeCapability.promise,new Promise(e=>{setTimeout(e,1e3)})]).catch(()=>{}),this.#closeCapability=null),this.#pdfDocument=null;try{await this.#scripting.destroySandbox()}catch{}for(var[e,t]of this._internalEvents)this.#eventBus._off(e,t);this._internalEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),this.#scripting=null,this.#ready=!1}else this.#pdfDocument=null;this.#destroyCapability?.resolve()}}},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GenericScripting=void 0,t.docProperties=async function(e){var t="".split("#")[0];let{info:i,metadata:n,contentDispositionFilename:a,contentLength:r}=await e.getMetadata();{var s;r||(s=(await e.getDownloadInfo())["length"],r=s)}return{...i,baseURL:t,filesize:r,filename:a||(0,o.getPdfFilenameFromUrl)(""),metadata:n?.getRaw(),authors:n?.get("dc:creator"),numPages:e.numPages,URL:""}};var o=i(4);t.GenericScripting=class{constructor(e){this._ready=(0,o.loadScript)(e,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}async createSandbox(e){(await this._ready).create(e)}async dispatchEventInSandbox(e){const t=await this._ready;setTimeout(()=>t.dispatchEvent(e),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFSinglePageViewer=void 0;var n=i(2);class a extends i(24).PDFViewer{_resetView(){super._resetView(),this._scrollMode=n.ScrollMode.PAGE,this._spreadMode=n.SpreadMode.NONE}set scrollMode(e){}_updateScrollMode(){}set spreadMode(e){}_updateSpreadMode(){}}t.PDFSinglePageViewer=a},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PagesCountLimit=t.PDFViewer=t.PDFPageViewBuffer=void 0;var f=i(4),P=i(2),n=i(7),g=i(13),a=i(25),r=i(5);const p={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};function v(e){return Object.values(f.AnnotationEditorType).includes(e)&&e!==f.AnnotationEditorType.DISABLE}t.PagesCountLimit=p;class s{#buf=new Set;#size=0;constructor(e){this.#size=e}push(e){var t=this.#buf;t.has(e)&&t.delete(e),t.add(e),t.size>this.#size&&this.#destroyFirstView()}resize(e,t=null){this.#size=e;var i=this.#buf;if(t){var n=i.size;let e=1;for(const a of i)if(t.has(a.id)&&(i.delete(a),i.add(a)),++e>n)break}for(;i.size>this.#size;)this.#destroyFirstView()}has(e){return this.#buf.has(e)}[Symbol.iterator](){return this.#buf.keys()}#destroyFirstView(){var e=this.#buf.keys().next().value;e?.destroy(),this.#buf.delete(e)}}t.PDFPageViewBuffer=s;t.PDFViewer=class{#buffer=null;#annotationEditorMode=f.AnnotationEditorType.NONE;#annotationEditorUIManager=null;#annotationMode=f.AnnotationMode.ENABLE_FORMS;#containerTopLeft=null;#copyCallbackBound=null;#enablePermissions=!1;#getAllTextInProgress=!1;#hiddenCopyElement=null;#interruptCopyCondition=!1;#previousContainerHeight=0;#resizeObserver=new ResizeObserver(this.#resizeObserverCallback.bind(this));#scrollModePageState=null;#onVisibilityChange=null;#scaleTimeoutId=null;#textLayerMode=P.TextLayerMode.ENABLE;constructor(e){var t="3.8.162";if(f.version!==t)throw new Error(`The API version "${f.version}" does not match the Viewer version "${t}".`);if(this.container=e.container,this.viewer=e.viewer||e.container.firstElementChild,"DIV"!==this.container?.tagName||"DIV"!==this.viewer?.tagName)throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&"absolute"!==getComputedStyle(this.container).position)throw new Error("The `container` must be absolutely positioned.");this.#resizeObserver.observe(this.container),this.eventBus=e.eventBus,this.linkService=e.linkService||new r.SimpleLinkService,this.downloadManager=e.downloadManager||null,this.findController=e.findController||null,this.findController&&(this.findController.onIsPageVisible=e=>this._getVisiblePages().ids.has(e)),this._scriptingManager=e.scriptingManager||null,this.#textLayerMode=e.textLayerMode??P.TextLayerMode.ENABLE,this.#annotationMode=e.annotationMode??f.AnnotationMode.ENABLE_FORMS,this.#annotationEditorMode=e.annotationEditorMode??f.AnnotationEditorType.NONE,this.imageResourcesPath=e.imageResourcesPath||"",this.enablePrintAutoRotate=e.enablePrintAutoRotate||!1,this.removePageBorders=e.removePageBorders||!1,this.useOnlyCssZoom=e.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=e.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=e.maxCanvasPixels,this.l10n=e.l10n||n.NullL10n,this.#enablePermissions=e.enablePermissions||!1,this.pageColors=e.pageColors||null,this.defaultRenderingQueue=!e.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new a.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=e.renderingQueue,this.scroll=(0,P.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=P.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#updateContainerHeightCss(),this.eventBus._on("thumbnailrendered",({pageNumber:e,pdfPage:t})=>{e=this._pages[e-1];this.#buffer.has(e)||t?.cleanup()})}get pagesCount(){return this._pages.length}getPageView(e){return this._pages[e]}getCachedPageViews(){return new Set(this.#buffer)}get pageViewsReady(){return this._pagesCapability.settled&&this._pages.every(e=>e?.pdfPage)}get renderForms(){return this.#annotationMode===f.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(e){if(!Number.isInteger(e))throw new Error("Invalid page number.");this.pdfDocument&&!this._setCurrentPageNumber(e,!0)&&console.error(`currentPageNumber: "${e}" is not a valid page.`)}_setCurrentPageNumber(e,t=!1){if(this._currentPageNumber!==e){if(!(0<e&&e<=this.pagesCount))return!1;var i=this._currentPageNumber;this._currentPageNumber=e,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:e,pageLabel:this._pageLabels?.[e-1]??null,previous:i})}return t&&this.#resetCurrentPageView(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(t){if(this.pdfDocument){let e=0|t;var i;this._pageLabels&&0<=(i=this._pageLabels.indexOf(t))&&(e=i+1),this._setCurrentPageNumber(e,!0)||console.error(`currentPageLabel: "${t}" is not a valid page.`)}}get currentScale(){return this._currentScale!==P.UNKNOWN_SCALE?this._currentScale:P.DEFAULT_SCALE}set currentScale(e){if(isNaN(e))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#setScale(e,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(e){this.pdfDocument&&this.#setScale(e,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!(0,P.isValidRotation)(e))throw new Error("Invalid pages rotation angle.");var t;this.pdfDocument&&((e%=360)<0&&(e+=360),this._pagesRotation!==e)&&(this._pagesRotation=e,t=this._currentPageNumber,this.refresh(!0,{rotation:e}),this._currentScaleValue&&this.#setScale(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:e,pageNumber:t}),this.defaultRenderingQueue)&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}#layerProperties(){const e=this;return{get annotationEditorUIManager(){return e.#annotationEditorUIManager},get annotationStorage(){return e.pdfDocument?.annotationStorage},get downloadManager(){return e.downloadManager},get enableScripting(){return!!e._scriptingManager},get fieldObjectsPromise(){return e.pdfDocument?.getFieldObjects()},get findController(){return e.findController},get hasJSActionsPromise(){return e.pdfDocument?.hasJSActions()},get linkService(){return e.linkService}}}#initializePermissions(e){var t={annotationEditorMode:this.#annotationEditorMode,annotationMode:this.#annotationMode,textLayerMode:this.#textLayerMode};return e&&(e.includes(f.PermissionFlag.COPY)||this.#textLayerMode!==P.TextLayerMode.ENABLE||(t.textLayerMode=P.TextLayerMode.ENABLE_PERMISSIONS),e.includes(f.PermissionFlag.MODIFY_CONTENTS)||(t.annotationEditorMode=f.AnnotationEditorType.DISABLE),e.includes(f.PermissionFlag.MODIFY_ANNOTATIONS)||e.includes(f.PermissionFlag.FILL_INTERACTIVE_FORMS)||this.#annotationMode!==f.AnnotationMode.ENABLE_FORMS||(t.annotationMode=f.AnnotationMode.ENABLE)),t}#onePageRenderedOrForceFetch(){var e;return"hidden"!==document.visibilityState&&this.container.offsetParent&&0!==this._getVisiblePages().views.length?(e=new Promise(e=>{this.#onVisibilityChange=()=>{"hidden"===document.visibilityState&&(e(),document.removeEventListener("visibilitychange",this.#onVisibilityChange),this.#onVisibilityChange=null)},document.addEventListener("visibilitychange",this.#onVisibilityChange)}),Promise.race([this._onePageRenderedCapability.promise,e])):Promise.resolve()}async getAllText(){var i=[],n=[];for(let e=1,t=this.pdfDocument.numPages;e<=t;++e){if(this.#interruptCopyCondition)return null;n.length=0;var a=(await(await this.pdfDocument.getPage(e)).getTextContent())["items"];for(const r of a)r.str&&n.push(r.str),r.hasEOL&&n.push("\n");i.push((0,P.removeNullCharacters)(n.join("")))}return i.join("\n")}#copyCallback(e,t){var i=document.getSelection(),{focusNode:n,anchorNode:a}=i;if(a&&n&&i.containsNode(this.#hiddenCopyElement)){if(this.#getAllTextInProgress||e===P.TextLayerMode.ENABLE_PERMISSIONS);else{this.#getAllTextInProgress=!0;const r=this.container.style.cursor,s=(this.container.style.cursor="wait",e=>this.#interruptCopyCondition="Escape"===e.key);window.addEventListener("keydown",s),this.getAllText().then(async e=>{null!==e&&await navigator.clipboard.writeText(e)}).catch(e=>{console.warn("Something goes wrong when extracting the text: "+e.message)}).finally(()=>{this.#getAllTextInProgress=!1,this.#interruptCopyCondition=!1,window.removeEventListener("keydown",s),this.container.style.cursor=r})}t.preventDefault(),t.stopPropagation()}}setDocument(d){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#annotationEditorUIManager)&&(this.#annotationEditorUIManager.destroy(),this.#annotationEditorUIManager=null),this.pdfDocument=d){const c=d.numPages;var e=d.getPage(1);const u=d.getOptionalContentConfig();var t,i=this.#enablePermissions?d.getPermissions():Promise.resolve();c>p.FORCE_SCROLL_MODE_PAGE&&(console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document."),t=this._scrollMode=P.ScrollMode.PAGE,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:t})),this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:c})},()=>{}),this._onBeforeDraw=e=>{e=this._pages[e.pageNumber-1];e&&this.#buffer.push(e)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=e=>{e.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:e.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,this.#onVisibilityChange&&(document.removeEventListener("visibilitychange",this.#onVisibilityChange),this.#onVisibilityChange=null))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([e,i]).then(([e,t])=>{if(d===this.pdfDocument){this._firstPageCapability.resolve(e),this._optionalContentConfigPromise=u;const{annotationEditorMode:o,annotationMode:l,textLayerMode:h}=this.#initializePermissions(t);h!==P.TextLayerMode.DISABLE&&((t=this.#hiddenCopyElement=document.createElement("div")).id="hiddenCopyElement",this.viewer.before(t)),o!==f.AnnotationEditorType.DISABLE&&(t=o,d.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):v(t)?(this.#annotationEditorUIManager=new f.AnnotationEditorUIManager(this.container,this.eventBus,d?.annotationStorage),t!==f.AnnotationEditorType.NONE&&this.#annotationEditorUIManager.updateMode(t)):console.error("Invalid AnnotationEditor mode: "+t));var i=this.#layerProperties.bind(this),n=this._scrollMode===P.ScrollMode.PAGE?null:this.viewer,a=this.currentScale,r=e.getViewport({scale:a*f.PixelsPerInch.PDF_TO_CSS_UNITS});this.viewer.style.setProperty("--scale-factor",r.scale),"CanvasText"!==this.pageColors?.foreground&&"Canvas"!==this.pageColors?.background||this.viewer.style.setProperty("--hcm-highligh-filter",d.filterFactory.addHighlightHCMFilter("CanvasText","Canvas","HighlightText","Highlight"));for(let e=1;e<=c;++e){var s=new g.PDFPageView({container:n,eventBus:this.eventBus,id:e,scale:a,defaultViewport:r.clone(),optionalContentConfigPromise:u,renderingQueue:this.renderingQueue,textLayerMode:h,annotationMode:l,imageResourcesPath:this.imageResourcesPath,useOnlyCssZoom:this.useOnlyCssZoom,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n,layerProperties:i});this._pages.push(s)}t=this._pages[0];t&&(t.setPdfPage(e),this.linkService.cachePageRef(1,e.ref)),this._scrollMode===P.ScrollMode.PAGE?this.#ensurePageViewVisible():this._spreadMode!==P.SpreadMode.NONE&&this._updateSpreadMode(),this.#onePageRenderedOrForceFetch().then(async()=>{if(this.findController?.setDocument(d),this._scriptingManager?.setDocument(d),this.#hiddenCopyElement&&(this.#copyCallbackBound=this.#copyCallback.bind(this,h),document.addEventListener("copy",this.#copyCallbackBound)),this.#annotationEditorUIManager&&this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:this.#annotationEditorMode}),d.loadingParams.disableAutoFetch||c>p.FORCE_LAZY_PAGE_INIT)this._pagesCapability.resolve();else{let n=c-1;if(n<=0)this._pagesCapability.resolve();else for(let i=2;i<=c;++i){var e=d.getPage(i).then(e=>{var t=this._pages[i-1];t.pdfPage||t.setPdfPage(e),this.linkService.cachePageRef(i,e.ref),0==--n&&this._pagesCapability.resolve()},e=>{console.error(`Unable to get page ${i} to initialize viewer`,e),0==--n&&this._pagesCapability.resolve()});i%p.PAUSE_EAGER_PAGE_INIT==0&&await e}}}),this.eventBus.dispatch("pagesinit",{source:this}),d.getMetadata().then(({info:e})=>{d===this.pdfDocument&&e.Language&&(this.viewer.lang=e.Language)}),this.defaultRenderingQueue&&this.update()}}).catch(e=>{console.error("Unable to initialize viewer",e),this._pagesCapability.reject(e)})}}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let e=0,t=this._pages.length;e<t;e++)this._pages[e].setPageLabel(this._pageLabels?.[e]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=P.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,this.#buffer=new s(10),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=new f.PromiseCapability,this._onePageRenderedCapability=new f.PromiseCapability,this._pagesCapability=new f.PromiseCapability,this._scrollMode=P.ScrollMode.VERTICAL,this._previousScrollMode=P.ScrollMode.UNKNOWN,this._spreadMode=P.SpreadMode.NONE,this.#scrollModePageState={previousPageNumber:1,scrollDown:!0,pages:[]},this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),this.#onVisibilityChange&&(document.removeEventListener("visibilitychange",this.#onVisibilityChange),this.#onVisibilityChange=null),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#hiddenCopyElement&&(document.removeEventListener("copy",this.#copyCallbackBound),this.#copyCallbackBound=null,this.#hiddenCopyElement.remove(),this.#hiddenCopyElement=null)}#ensurePageViewVisible(){if(this._scrollMode!==P.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");var e=this._currentPageNumber,t=this.#scrollModePageState,i=this.viewer;if(i.textContent="",t.pages.length=0,this._spreadMode!==P.SpreadMode.NONE||this.isInPresentationMode){var n=new Set,a=this._spreadMode-1,r=(-1==a?n.add(e-1):e%2!=a?(n.add(e-1),n.add(e)):(n.add(e-2),n.add(e-1)),document.createElement("div"));r.className="spread",this.isInPresentationMode&&((a=document.createElement("div")).className="dummyPage",r.append(a));for(const o of n){var s=this._pages[o];s&&(r.append(s.div),t.pages.push(s))}i.append(r)}else{a=this._pages[e-1];i.append(a.div),t.pages.push(a)}t.scrollDown=e>=t.previousPageNumber,t.previousPageNumber=e}_scrollUpdate(){0!==this.pagesCount&&this.update()}#scrollIntoView(e,t=null){var i,n,a,{div:e,id:r}=e;this._currentPageNumber!==r&&this._setCurrentPageNumber(r),this._scrollMode===P.ScrollMode.PAGE&&(this.#ensurePageViewVisible(),this.update()),!t&&!this.isInPresentationMode&&(i=(r=e.offsetLeft+e.clientLeft)+e.clientWidth,{scrollLeft:n,clientWidth:a}=this.container,this._scrollMode===P.ScrollMode.HORIZONTAL||r<n||n+a<i)&&(t={left:0,top:0}),(0,P.scrollIntoView)(e,t),!this._currentScaleValue&&this._location&&(this._location=null)}#isSameScale(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}#setScaleUpdatePages(e,t,{noScroll:i=!1,preset:n=!1,drawingDelay:a=-1}){if(this._currentScaleValue=t.toString(),this.#isSameScale(e))n&&this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:t});else{this.viewer.style.setProperty("--scale-factor",e*f.PixelsPerInch.PDF_TO_CSS_UNITS);var r=0<=a&&a<1e3;if(this.refresh(!0,{scale:e,drawingDelay:r?a:-1}),r&&(this.#scaleTimeoutId=setTimeout(()=>{this.#scaleTimeoutId=null,this.refresh()},a)),this._currentScale=e,!i){let e=this._currentPageNumber,t;!this._location||this.isInPresentationMode||this.isChangingPresentationMode||(e=this._location.pageNumber,t=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:e,destArray:t,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:n?t:void 0}),this.defaultRenderingQueue&&this.update()}}get#pageWidthScaleFactor(){return this._spreadMode!==P.SpreadMode.NONE&&this._scrollMode!==P.ScrollMode.HORIZONTAL?2:1}#setScale(i,n){let a=parseFloat(i);if(0<a)n.preset=!1,this.#setScaleUpdatePages(a,i,n);else{var r=this._pages[this._currentPageNumber-1];if(r){let e=P.SCROLLBAR_PADDING,t=P.VERTICAL_PADDING;this.isInPresentationMode?(e=t=4,this._spreadMode!==P.SpreadMode.NONE&&(e*=2)):this.removePageBorders?e=t=0:this._scrollMode===P.ScrollMode.HORIZONTAL&&([e,t]=[t,e]);var s=(this.container.clientWidth-e)/r.width*r.scale/this.#pageWidthScaleFactor,o=(this.container.clientHeight-t)/r.height*r.scale;switch(i){case"page-actual":a=1;break;case"page-width":a=s;break;case"page-height":a=o;break;case"page-fit":a=Math.min(s,o);break;case"auto":var l=(0,P.isPortraitOrientation)(r)?s:Math.min(o,s);a=Math.min(P.MAX_AUTO_SCALE,l);break;default:return void console.error(`#setScale: "${i}" is an unknown zoom value.`)}n.preset=!0,this.#setScaleUpdatePages(a,i,n)}}}#resetCurrentPageView(){var e=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#setScale(this._currentScaleValue,{noScroll:!0}),this.#scrollIntoView(e)}pageLabelToPageNumber(e){return!this._pageLabels||(e=this._pageLabels.indexOf(e))<0?null:e+1}scrollPageIntoView({pageNumber:e,destArray:h=null,allowNegativeOffset:d=!1,ignoreDestinationZoom:t=!1}){if(this.pdfDocument){var c=Number.isInteger(e)&&this._pages[e-1];if(c)if(this.isInPresentationMode||!h)this._setCurrentPageNumber(e,!0);else{let i=0,n=0,a=0,r=0,s,o;var u=c.rotation%180!=0,g=(u?c.height:c.width)/c.scale/f.PixelsPerInch.PDF_TO_CSS_UNITS,p=(u?c.width:c.height)/c.scale/f.PixelsPerInch.PDF_TO_CSS_UNITS;let l=0;switch(h[1].name){case"XYZ":i=h[2],n=h[3],l=h[4],i=null!==i?i:0,n=null!==n?n:p;break;case"Fit":case"FitB":l="page-fit";break;case"FitH":case"FitBH":n=h[2],l="page-width",null===n&&this._location?(i=this._location.left,n=this._location.top):("number"!=typeof n||n<0)&&(n=p);break;case"FitV":case"FitBV":i=h[2],a=g,r=p,l="page-height";break;case"FitR":i=h[2],n=h[3],a=h[4]-i,r=h[5]-n;let e=P.SCROLLBAR_PADDING,t=P.VERTICAL_PADDING;this.removePageBorders&&(e=t=0),s=(this.container.clientWidth-e)/a/f.PixelsPerInch.PDF_TO_CSS_UNITS,o=(this.container.clientHeight-t)/r/f.PixelsPerInch.PDF_TO_CSS_UNITS,l=Math.min(Math.abs(s),Math.abs(o));break;default:return void console.error(`scrollPageIntoView: "${h[1].name}" is not a valid destination type.`)}if(t||(l&&l!==this._currentScale?this.currentScaleValue=l:this._currentScale===P.UNKNOWN_SCALE&&(this.currentScaleValue=P.DEFAULT_SCALE_VALUE)),"page-fit"!==l||h[4]){u=[c.viewport.convertToViewportPoint(i,n),c.viewport.convertToViewportPoint(i+a,n+r)];let e=Math.min(u[0][0],u[1][0]),t=Math.min(u[0][1],u[1][1]);d||(e=Math.max(e,0),t=Math.max(t,0)),this.#scrollIntoView(c,{left:e,top:t})}else this.#scrollIntoView(c)}else console.error(`scrollPageIntoView: "${e}" is not a valid pageNumber parameter.`)}}_updateLocation(e){var t=this._currentScale,i=this._currentScaleValue,t=parseFloat(i)===t?Math.round(1e4*t)/100:i,i=e.id,n=this._pages[i-1],a=this.container,n=n.getPagePoint(a.scrollLeft-e.x,a.scrollTop-e.y),a=Math.round(n[0]),e=Math.round(n[1]);let r="#page="+i;this.isInPresentationMode||(r+=`&zoom=${t},${a},`+e),this._location={pageNumber:i,scale:t,top:e,left:a,rotation:this._pagesRotation,pdfOpenParams:r}}update(){var t=this._getVisiblePages(),i=t.views,n=i.length;if(0!==n){var n=Math.max(10,2*n+1),a=(this.#buffer.resize(n,t.ids),this.renderingQueue.renderHighestPriority(t),this._spreadMode===P.SpreadMode.NONE&&(this._scrollMode===P.ScrollMode.PAGE||this._scrollMode===P.ScrollMode.VERTICAL)),r=this._currentPageNumber;let e=!1;for(const s of i){if(s.percent<100)break;if(s.id===r&&a){e=!0;break}}this._setCurrentPageNumber(e?r:i[0].id),this._updateLocation(t.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}}containsElement(e){return this.container.contains(e)}focus(){this.container.focus()}get _isContainerRtl(){return"rtl"===getComputedStyle(this.container).direction}get isInPresentationMode(){return this.presentationModeState===P.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===P.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){var e=this._scrollMode===P.ScrollMode.PAGE?this.#scrollModePageState.pages:this._pages,t=this._scrollMode===P.ScrollMode.HORIZONTAL,i=t&&this._isContainerRtl;return(0,P.getVisibleElements)({scrollEl:this.container,views:e,sortByVisibility:!0,horizontal:t,rtl:i})}cleanup(){for(const e of this._pages)e.renderingState!==P.RenderingStates.FINISHED&&e.reset()}_cancelRendering(){for(const e of this._pages)e.cancelRendering()}async#ensurePdfPageLoaded(e){if(e.pdfPage)return e.pdfPage;try{var t=await this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(t),this.linkService._cachedPageNumber?.(t.ref)||this.linkService.cachePageRef(e.id,t.ref),t}catch(e){return console.error("Unable to get page for page view",e),null}}#getScrollAhead(e){if(1===e.first?.id)return!0;if(e.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case P.ScrollMode.PAGE:return this.#scrollModePageState.scrollDown;case P.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(e){var e=e||this._getVisiblePages(),t=this.#getScrollAhead(e),i=this._spreadMode!==P.SpreadMode.NONE&&this._scrollMode!==P.ScrollMode.HORIZONTAL;const n=this.renderingQueue.getHighestPriority(e,this._pages,t,i);return!!n&&(this.#ensurePdfPageLoaded(n).then(()=>{this.renderingQueue.renderView(n)}),!0)}get hasEqualPageSizes(){var i=this._pages[0];for(let e=1,t=this._pages.length;e<t;++e){var n=this._pages[e];if(n.width!==i.width||n.height!==i.height)return!1}return!0}getPagesOverview(){let i;return this._pages.map(e=>{var e=e.pdfPage.getViewport({scale:1}),t=(0,P.isPortraitOrientation)(e);if(void 0===i)i=t;else if(this.enablePrintAutoRotate&&t!==i)return{width:e.height,height:e.width,rotation:(e.rotation-90)%360};return{width:e.width,height:e.height,rotation:e.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise||(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(e){if(!(e instanceof Promise))throw new Error("Invalid optionalContentConfigPromise: "+e);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=e,this.refresh(!1,{optionalContentConfigPromise:e}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:e}))}get scrollMode(){return this._scrollMode}set scrollMode(e){if(this._scrollMode!==e){if(!(0,P.isValidScrollMode)(e))throw new Error("Invalid scroll mode: "+e);this.pagesCount>p.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=e,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(e=null){var t=this._scrollMode,i=this.viewer;i.classList.toggle("scrollHorizontal",t===P.ScrollMode.HORIZONTAL),i.classList.toggle("scrollWrapped",t===P.ScrollMode.WRAPPED),this.pdfDocument&&e&&(t===P.ScrollMode.PAGE?this.#ensurePageViewVisible():this._previousScrollMode===P.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#setScale(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(e){if(this._spreadMode!==e){if(!(0,P.isValidSpreadMode)(e))throw new Error("Invalid spread mode: "+e);this._spreadMode=e,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:e}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(e=null){if(this.pdfDocument){var n=this.viewer,a=this._pages;if(this._scrollMode===P.ScrollMode.PAGE)this.#ensurePageViewVisible();else if(n.textContent="",this._spreadMode===P.SpreadMode.NONE)for(const t of this._pages)n.append(t.div);else{var r=this._spreadMode-1;let i=null;for(let e=0,t=a.length;e<t;++e)null===i?((i=document.createElement("div")).className="spread",n.append(i)):e%2==r&&(i=i.cloneNode(!1),n.append(i)),i.append(a[e].div)}e&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#setScale(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}}_getPageAdvance(i,e=!1){switch(this._scrollMode){case P.ScrollMode.WRAPPED:var t,n,a,r,s=this._getVisiblePages()["views"],o=new Map;for({id:t,y:n,percent:a,widthPercent:r}of s)if(!(0===a||r<100)){let e=o.get(n);e||o.set(n,e||=[]),e.push(t)}for(const _ of o.values()){var l=_.indexOf(i);if(-1!==l){var h=_.length;if(1===h)break;if(e)for(let e=l-1;0<=e;e--){var d=_[e],c=_[e+1]-1;if(d<c)return i-c}else for(let e=l+1,t=h;e<t;e++){var u=_[e],g=_[e-1]+1;if(g<u)return g-i}if(e){l=_[0];if(l<i)return i-l+1}else{l=_[h-1];if(i<l)return l-i+1}break}}break;case P.ScrollMode.HORIZONTAL:break;case P.ScrollMode.PAGE:case P.ScrollMode.VERTICAL:if(this._spreadMode!==P.SpreadMode.NONE){s=this._spreadMode-1;if((!e||i%2==s)&&(e||i%2!=s)){var p,f,v,s=this._getVisiblePages()["views"],m=e?i-1:i+1;for({id:p,percent:f,widthPercent:v}of s)if(p===m){if(0<f&&100===v)return 2;break}}}}return 1}nextPage(){var e,t=this._currentPageNumber,i=this.pagesCount;return!(i<=t||(e=this._getPageAdvance(t,!1)||1,this.currentPageNumber=Math.min(t+e,i),0))}previousPage(){var e,t=this._currentPageNumber;return!(t<=1||(e=this._getPageAdvance(t,!0)||1,this.currentPageNumber=Math.max(t-e,1),0))}increaseScale({drawingDelay:t,scaleFactor:i,steps:n}={}){if(this.pdfDocument){let e=this._currentScale;if(1<i)e=Math.round(e*i*100)/100;else for(n??=1;e=Math.ceil(10*(e*P.DEFAULT_SCALE_DELTA).toFixed(2))/10,0<--n&&e<P.MAX_SCALE;);this.#setScale(Math.min(P.MAX_SCALE,e),{noScroll:!1,drawingDelay:t})}}decreaseScale({drawingDelay:t,scaleFactor:i,steps:n}={}){if(this.pdfDocument){let e=this._currentScale;if(0<i&&i<1)e=Math.round(e*i*100)/100;else for(n??=1;e=Math.floor(10*(e/P.DEFAULT_SCALE_DELTA).toFixed(2))/10,0<--n&&e>P.MIN_SCALE;);this.#setScale(Math.max(P.MIN_SCALE,e),{noScroll:!1,drawingDelay:t})}}#updateContainerHeightCss(e=this.container.clientHeight){e!==this.#previousContainerHeight&&(this.#previousContainerHeight=e,P.docStyle.setProperty("--viewer-container-height",e+"px"))}#resizeObserverCallback(e){for(const t of e)if(t.target===this.container){this.#updateContainerHeightCss(Math.floor(t.borderBoxSize[0].blockSize)),this.#containerTopLeft=null;break}}get containerTopLeft(){return this.#containerTopLeft||=[this.container.offsetTop,this.container.offsetLeft]}get annotationEditorMode(){return this.#annotationEditorUIManager?this.#annotationEditorMode:f.AnnotationEditorType.DISABLE}set annotationEditorMode(e){if(!this.#annotationEditorUIManager)throw new Error("The AnnotationEditor is not enabled.");if(this.#annotationEditorMode!==e){if(!v(e))throw new Error("Invalid AnnotationEditor mode: "+e);this.pdfDocument&&(this.#annotationEditorMode=e,this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:e}),this.#annotationEditorUIManager.updateMode(e))}}set annotationEditorParams({type:e,value:t}){if(!this.#annotationEditorUIManager)throw new Error("The AnnotationEditor is not enabled.");this.#annotationEditorUIManager.updateParams(e,t)}refresh(e=!1,t=Object.create(null)){if(this.pdfDocument){for(const i of this._pages)i.update(t);null!==this.#scaleTimeoutId&&(clearTimeout(this.#scaleTimeoutId),this.#scaleTimeoutId=null),e||this.update()}}}},(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFRenderingQueue=void 0;var n=i(4),a=i(2);t.PDFRenderingQueue=class{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(e){this.pdfViewer=e}setThumbnailViewer(e){this.pdfThumbnailViewer=e}isHighestPriority(e){return this.highestPriorityPage===e.renderingId}renderHighestPriority(e){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),this.pdfViewer.forceRendering(e)||this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),3e4))}getHighestPriority(e,i,n,t=!1){var a=e.views,r=a.length;if(0===r)return null;for(let e=0;e<r;e++){var s=a[e].view;if(!this.isViewFinished(s))return s}var o=e.first.id,l=e.last.id;if(r<l-o+1){var h=e.ids;for(let e=1,t=l-o;e<t;e++){var d=n?o+e:l-e;if(!h.has(d)){d=i[d-1];if(!this.isViewFinished(d))return d}}}var e=n?l:o-2,c=i[e];return c&&!this.isViewFinished(c)||t&&(c=i[e+=n?1:-1])&&!this.isViewFinished(c)?c:null}isViewFinished(e){return e.renderingState===a.RenderingStates.FINISHED}renderView(e){switch(e.renderingState){case a.RenderingStates.FINISHED:return!1;case a.RenderingStates.PAUSED:this.highestPriorityPage=e.renderingId,e.resume();break;case a.RenderingStates.RUNNING:this.highestPriorityPage=e.renderingId;break;case a.RenderingStates.INITIAL:this.highestPriorityPage=e.renderingId,e.draw().finally(()=>{this.renderHighestPriority()}).catch(e=>{e instanceof n.RenderingCancelledException||console.error(`renderView: "${e}"`)})}return!0}}}],n={};function a(e){var t=n[e];return void 0!==t||(t=n[e]={exports:{}},i[e](t,t.exports,a)),t.exports}var e,t,r,s,o,l,h,d,c,u,g,p,f,v,m,_,P,y={};return e=y,Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return o.AnnotationLayerBuilder}}),Object.defineProperty(e,"DownloadManager",{enumerable:!0,get:function(){return l.DownloadManager}}),Object.defineProperty(e,"EventBus",{enumerable:!0,get:function(){return h.EventBus}}),Object.defineProperty(e,"FindState",{enumerable:!0,get:function(){return t.FindState}}),Object.defineProperty(e,"GenericL10n",{enumerable:!0,get:function(){return d.GenericL10n}}),Object.defineProperty(e,"LinkTarget",{enumerable:!0,get:function(){return r.LinkTarget}}),Object.defineProperty(e,"NullL10n",{enumerable:!0,get:function(){return c.NullL10n}}),Object.defineProperty(e,"PDFFindController",{enumerable:!0,get:function(){return t.PDFFindController}}),Object.defineProperty(e,"PDFHistory",{enumerable:!0,get:function(){return u.PDFHistory}}),Object.defineProperty(e,"PDFLinkService",{enumerable:!0,get:function(){return r.PDFLinkService}}),Object.defineProperty(e,"PDFPageView",{enumerable:!0,get:function(){return g.PDFPageView}}),Object.defineProperty(e,"PDFScriptingManager",{enumerable:!0,get:function(){return p.PDFScriptingManager}}),Object.defineProperty(e,"PDFSinglePageViewer",{enumerable:!0,get:function(){return f.PDFSinglePageViewer}}),Object.defineProperty(e,"PDFViewer",{enumerable:!0,get:function(){return v.PDFViewer}}),Object.defineProperty(e,"ProgressBar",{enumerable:!0,get:function(){return s.ProgressBar}}),Object.defineProperty(e,"RenderingStates",{enumerable:!0,get:function(){return s.RenderingStates}}),Object.defineProperty(e,"ScrollMode",{enumerable:!0,get:function(){return s.ScrollMode}}),Object.defineProperty(e,"SimpleLinkService",{enumerable:!0,get:function(){return r.SimpleLinkService}}),Object.defineProperty(e,"SpreadMode",{enumerable:!0,get:function(){return s.SpreadMode}}),Object.defineProperty(e,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return m.StructTreeLayerBuilder}}),Object.defineProperty(e,"TextLayerBuilder",{enumerable:!0,get:function(){return _.TextLayerBuilder}}),Object.defineProperty(e,"XfaLayerBuilder",{enumerable:!0,get:function(){return P.XfaLayerBuilder}}),Object.defineProperty(e,"parseQueryString",{enumerable:!0,get:function(){return s.parseQueryString}}),t=a(1),r=a(5),s=a(2),o=a(6),l=a(8),h=a(9),d=a(10),c=a(7),u=a(12),g=a(13),p=a(21),f=a(23),v=a(24),m=a(16),_=a(19),P=a(20),y})());
var accent_map={"\u1e9a":"a","\u00c1":"a","\u00e1":"a","\u00c0":"a","\u00e0":"a","\u0102":"a","\u0103":"a","\u1eae":"a","\u1eaf":"a","\u1eb0":"a","\u1eb1":"a","\u1eb4":"a","\u1eb5":"a","\u1eb2":"a","\u1eb3":"a","\u00c2":"a","\u00e2":"a","\u1ea4":"a","\u1ea5":"a","\u1ea6":"a","\u1ea7":"a","\u1eaa":"a","\u1eab":"a","\u1ea8":"a","\u1ea9":"a","\u01cd":"a","\u01ce":"a","\u00c5":"a","\u00e5":"a","\u01fa":"a","\u01fb":"a","\u00c4":"a","\u00e4":"a","\u01de":"a","\u01df":"a","\u00c3":"a","\u00e3":"a","\u0226":"a",
"\u0227":"a","\u01e0":"a","\u01e1":"a","\u0104":"a","\u0105":"a","\u0100":"a","\u0101":"a","\u1ea2":"a","\u1ea3":"a","\u0200":"a","\u0201":"a","\u0202":"a","\u0203":"a","\u1ea0":"a","\u1ea1":"a","\u1eb6":"a","\u1eb7":"a","\u1eac":"a","\u1ead":"a","\u1e00":"a","\u1e01":"a","\u023a":"a","\u2c65":"a","\u01fc":"a","\u01fd":"a","\u01e2":"a","\u01e3":"a","\u1e02":"b","\u1e03":"b","\u1e04":"b","\u1e05":"b","\u1e06":"b","\u1e07":"b","\u0243":"b","\u0180":"b","\u1d6c":"b","\u0181":"b","\u0253":"b","\u0182":"b",
"\u0183":"b","\u0106":"c","\u0107":"c","\u0108":"c","\u0109":"c","\u010c":"c","\u010d":"c","\u010a":"c","\u010b":"c","\u00c7":"c","\u00e7":"c","\u1e08":"c","\u1e09":"c","\u023b":"c","\u023c":"c","\u0187":"c","\u0188":"c","\u0255":"c","\u010e":"d","\u010f":"d","\u1e0a":"d","\u1e0b":"d","\u1e10":"d","\u1e11":"d","\u1e0c":"d","\u1e0d":"d","\u1e12":"d","\u1e13":"d","\u1e0e":"d","\u1e0f":"d","\u0110":"d","\u0111":"d","\u1d6d":"d","\u0189":"d","\u0256":"d","\u018a":"d","\u0257":"d","\u018b":"d","\u018c":"d",
"\u0221":"d","\u00f0":"d","\u00c9":"e","\u018f":"e","\u018e":"e","\u01dd":"e","\u00e9":"e","\u00c8":"e","\u00e8":"e","\u0114":"e","\u0115":"e","\u00ca":"e","\u00ea":"e","\u1ebe":"e","\u1ebf":"e","\u1ec0":"e","\u1ec1":"e","\u1ec4":"e","\u1ec5":"e","\u1ec2":"e","\u1ec3":"e","\u011a":"e","\u011b":"e","\u00cb":"e","\u00eb":"e","\u1ebc":"e","\u1ebd":"e","\u0116":"e","\u0117":"e","\u0228":"e","\u0229":"e","\u1e1c":"e","\u1e1d":"e","\u0118":"e","\u0119":"e","\u0112":"e","\u0113":"e","\u1e16":"e","\u1e17":"e",
"\u1e14":"e","\u1e15":"e","\u1eba":"e","\u1ebb":"e","\u0204":"e","\u0205":"e","\u0206":"e","\u0207":"e","\u1eb8":"e","\u1eb9":"e","\u1ec6":"e","\u1ec7":"e","\u1e18":"e","\u1e19":"e","\u1e1a":"e","\u1e1b":"e","\u0246":"e","\u0247":"e","\u025a":"e","\u025d":"e","\u1e1e":"f","\u1e1f":"f","\u1d6e":"f","\u0191":"f","\u0192":"f","\u01f4":"g","\u01f5":"g","\u011e":"g","\u011f":"g","\u011c":"g","\u011d":"g","\u01e6":"g","\u01e7":"g","\u0120":"g","\u0121":"g","\u0122":"g","\u0123":"g","\u1e20":"g","\u1e21":"g",
"\u01e4":"g","\u01e5":"g","\u0193":"g","\u0260":"g","\u0124":"h","\u0125":"h","\u021e":"h","\u021f":"h","\u1e26":"h","\u1e27":"h","\u1e22":"h","\u1e23":"h","\u1e28":"h","\u1e29":"h","\u1e24":"h","\u1e25":"h","\u1e2a":"h","\u1e2b":"h",H:"h","\u0331":"h","\u1e96":"h","\u0126":"h","\u0127":"h","\u2c67":"h","\u2c68":"h","\u00cd":"i","\u00ed":"i","\u00cc":"i","\u00ec":"i","\u012c":"i","\u012d":"i","\u00ce":"i","\u00ee":"i","\u01cf":"i","\u01d0":"i","\u00cf":"i","\u00ef":"i","\u1e2e":"i","\u1e2f":"i","\u0128":"i",
"\u0129":"i","\u0130":"i",i:"i","\u012e":"i","\u012f":"i","\u012a":"i","\u012b":"i","\u1ec8":"i","\u1ec9":"i","\u0208":"i","\u0209":"i","\u020a":"i","\u020b":"i","\u1eca":"i","\u1ecb":"i","\u1e2c":"i","\u1e2d":"i",I:"i","\u0131":"i","\u0197":"i","\u0268":"i","\u0134":"j","\u0135":"j",J:"j","\u030c":"j","\u01f0":"j","\u0237":"j","\u0248":"j","\u0249":"j","\u029d":"j","\u025f":"j","\u0284":"j","\u1e30":"k","\u1e31":"k","\u01e8":"k","\u01e9":"k","\u0136":"k","\u0137":"k","\u1e32":"k","\u1e33":"k","\u1e34":"k",
"\u1e35":"k","\u0198":"k","\u0199":"k","\u2c69":"k","\u2c6a":"k","\u0139":"a","\u013a":"l","\u013d":"l","\u013e":"l","\u013b":"l","\u013c":"l","\u1e36":"l","\u1e37":"l","\u1e38":"l","\u1e39":"l","\u1e3c":"l","\u1e3d":"l","\u1e3a":"l","\u1e3b":"l","\u0141":"l","\u0142":"l","\u0141":"l","\u0323":"l","\u0142":"l","\u0323":"l","\u013f":"l","\u0140":"l","\u023d":"l","\u019a":"l","\u2c60":"l","\u2c61":"l","\u2c62":"l","\u026b":"l","\u026c":"l","\u026d":"l","\u0234":"l","\u1e3e":"m","\u1e3f":"m","\u1e40":"m",
"\u1e41":"m","\u1e42":"m","\u1e43":"m","\u0271":"m","\u0143":"n","\u0144":"n","\u01f8":"n","\u01f9":"n","\u0147":"n","\u0148":"n","\u00d1":"n","\u00f1":"n","\u1e44":"n","\u1e45":"n","\u0145":"n","\u0146":"n","\u1e46":"n","\u1e47":"n","\u1e4a":"n","\u1e4b":"n","\u1e48":"n","\u1e49":"n","\u019d":"n","\u0272":"n","\u0220":"n","\u019e":"n","\u0273":"n","\u0235":"n",N:"n","\u0308":"n",n:"n","\u0308":"n","\u00d3":"o","\u00f3":"o","\u00d2":"o","\u00f2":"o","\u014e":"o","\u014f":"o","\u00d4":"o","\u00f4":"o",
"\u1ed0":"o","\u1ed1":"o","\u1ed2":"o","\u1ed3":"o","\u1ed6":"o","\u1ed7":"o","\u1ed4":"o","\u1ed5":"o","\u01d1":"o","\u01d2":"o","\u00d6":"o","\u00f6":"o","\u022a":"o","\u022b":"o","\u0150":"o","\u0151":"o","\u00d5":"o","\u00f5":"o","\u1e4c":"o","\u1e4d":"o","\u1e4e":"o","\u1e4f":"o","\u022c":"o","\u022d":"o","\u022e":"o","\u022f":"o","\u0230":"o","\u0231":"o","\u00d8":"o","\u00f8":"o","\u01fe":"o","\u01ff":"o","\u01ea":"o","\u01eb":"o","\u01ec":"o","\u01ed":"o","\u014c":"o","\u014d":"o","\u1e52":"o",
"\u1e53":"o","\u1e50":"o","\u1e51":"o","\u1ece":"o","\u1ecf":"o","\u020c":"o","\u020d":"o","\u020e":"o","\u020f":"o","\u01a0":"o","\u01a1":"o","\u1eda":"o","\u1edb":"o","\u1edc":"o","\u1edd":"o","\u1ee0":"o","\u1ee1":"o","\u1ede":"o","\u1edf":"o","\u1ee2":"o","\u1ee3":"o","\u1ecc":"o","\u1ecd":"o","\u1ed8":"o","\u1ed9":"o","\u019f":"o","\u0275":"o","\u1e54":"p","\u1e55":"p","\u1e56":"p","\u1e57":"p","\u2c63":"p","\u01a4":"p","\u01a5":"p",P:"p","\u0303":"p",p:"p","\u0303":"p","\u02a0":"q","\u024a":"q",
"\u024b":"q","\u0154":"r","\u0155":"r","\u0158":"r","\u0159":"r","\u1e58":"r","\u1e59":"r","\u0156":"r","\u0157":"r","\u0210":"r","\u0211":"r","\u0212":"r","\u0213":"r","\u1e5a":"r","\u1e5b":"r","\u1e5c":"r","\u1e5d":"r","\u1e5e":"r","\u1e5f":"r","\u024c":"r","\u024d":"r","\u1d72":"r","\u027c":"r","\u2c64":"r","\u027d":"r","\u027e":"r","\u1d73":"r","\u00df":"s","\u015a":"s","\u015b":"s","\u1e64":"s","\u1e65":"s","\u015c":"s","\u015d":"s","\u0160":"s","\u0161":"s","\u1e66":"s","\u1e67":"s","\u1e60":"s",
"\u1e61":"s","\u1e9b":"s","\u015e":"s","\u015f":"s","\u1e62":"s","\u1e63":"s","\u1e68":"s","\u1e69":"s","\u0218":"s","\u0219":"s","\u0282":"s",S:"s","\u0329":"s",s:"s","\u0329":"s","\u00de":"t","\u00fe":"t","\u0164":"t","\u0165":"t",T:"t","\u0308":"t","\u1e97":"t","\u1e6a":"t","\u1e6b":"t","\u0162":"t","\u0163":"t","\u1e6c":"t","\u1e6d":"t","\u021a":"t","\u021b":"t","\u1e70":"t","\u1e71":"t","\u1e6e":"t","\u1e6f":"t","\u0166":"t","\u0167":"t","\u023e":"t","\u2c66":"t","\u1d75":"t","\u01ab":"t","\u01ac":"t",
"\u01ad":"t","\u01ae":"t","\u0288":"t","\u0236":"t","\u00da":"u","\u00fa":"u","\u00d9":"u","\u00f9":"u","\u016c":"u","\u016d":"u","\u00db":"u","\u00fb":"u","\u01d3":"u","\u01d4":"u","\u016e":"u","\u016f":"u","\u00dc":"u","\u00fc":"u","\u01d7":"u","\u01d8":"u","\u01db":"u","\u01dc":"u","\u01d9":"u","\u01da":"u","\u01d5":"u","\u01d6":"u","\u0170":"u","\u0171":"u","\u0168":"u","\u0169":"u","\u1e78":"u","\u1e79":"u","\u0172":"u","\u0173":"u","\u016a":"u","\u016b":"u","\u1e7a":"u","\u1e7b":"u","\u1ee6":"u",
"\u1ee7":"u","\u0214":"u","\u0215":"u","\u0216":"u","\u0217":"u","\u01af":"u","\u01b0":"u","\u1ee8":"u","\u1ee9":"u","\u1eea":"u","\u1eeb":"u","\u1eee":"u","\u1eef":"u","\u1eec":"u","\u1eed":"u","\u1ef0":"u","\u1ef1":"u","\u1ee4":"u","\u1ee5":"u","\u1e72":"u","\u1e73":"u","\u1e76":"u","\u1e77":"u","\u1e74":"u","\u1e75":"u","\u0244":"u","\u0289":"u","\u1e7c":"v","\u1e7d":"v","\u1e7e":"v","\u1e7f":"v","\u01b2":"v","\u028b":"v","\u1e82":"w","\u1e83":"w","\u1e80":"w","\u1e81":"w","\u0174":"w","\u0175":"w",
W:"w","\u030a":"w","\u1e98":"w","\u1e84":"w","\u1e85":"w","\u1e86":"w","\u1e87":"w","\u1e88":"w","\u1e89":"w","\u1e8c":"x","\u1e8d":"x","\u1e8a":"x","\u1e8b":"x","\u00dd":"y","\u00fd":"y","\u1ef2":"y","\u1ef3":"y","\u0176":"y","\u0177":"y",Y:"y","\u030a":"y","\u1e99":"y","\u0178":"y","\u00ff":"y","\u1ef8":"y","\u1ef9":"y","\u1e8e":"y","\u1e8f":"y","\u0232":"y","\u0233":"y","\u1ef6":"y","\u1ef7":"y","\u1ef4":"y","\u1ef5":"y","\u028f":"y","\u024e":"y","\u024f":"y","\u01b3":"y","\u01b4":"y","\u0179":"z",
"\u017a":"z","\u1e90":"z","\u1e91":"z","\u017d":"z","\u017e":"z","\u017b":"z","\u017c":"z","\u1e92":"z","\u1e93":"z","\u1e94":"z","\u1e95":"z","\u01b5":"z","\u01b6":"z","\u0224":"z","\u0225":"z","\u0290":"z","\u0291":"z","\u2c6b":"z","\u2c6c":"z","\u01ee":"z","\u01ef":"z","\u01ba":"z","\uff12":"2","\uff16":"6","\uff22":"B","\uff26":"F","\uff2a":"J","\uff2e":"N","\uff32":"R","\uff36":"V","\uff3a":"Z","\uff42":"b","\uff46":"f","\uff4a":"j","\uff4e":"n","\uff52":"r","\uff56":"v","\uff5a":"z","\uff11":"1",
"\uff15":"5","\uff19":"9","\uff21":"A","\uff25":"E","\uff29":"I","\uff2d":"M","\uff31":"Q","\uff35":"U","\uff39":"Y","\uff41":"a","\uff45":"e","\uff49":"i","\uff4d":"m","\uff51":"q","\uff55":"u","\uff59":"y","\uff10":"0","\uff14":"4","\uff18":"8","\uff24":"D","\uff28":"H","\uff2c":"L","\uff30":"P","\uff34":"T","\uff38":"X","\uff44":"d","\uff48":"h","\uff4c":"l","\uff50":"p","\uff54":"t","\uff58":"x","\uff13":"3","\uff17":"7","\uff23":"C","\uff27":"G","\uff2b":"K","\uff2f":"O","\uff33":"S","\uff37":"W",
"\uff43":"c","\uff47":"g","\uff4b":"k","\uff4f":"o","\uff53":"s","\uff57":"w"},accentMap={"\u00e1":"a","\u00e9":"e","\u00ed":"i","\u00f3":"o","\u00fa":"u"};function accent_fold(d){if(!d)return"";for(var a="",c=0;c<d.length;c++)a+=accent_map[d.charAt(c)]||d.charAt(c);return a}
function accent_folded_hilite(d,a){var c=accent_fold(d).toLowerCase().replace(/[<>]+/g,""),e=[],b;for(b in a)e[b]=accent_fold(a[b]).toLowerCase().replace(/[<>]+/g,"");for(b in a)a=new RegExp(e[b],"g"),c=c.replace(a,"<"+e[b]+">");e=0;a="";for(b=0;b<c.length;b++){var g=d.charAt(e),f=c.charAt(b);"<"===f?a+="<b>":">"===f?a+="</b>":(e+=1,a+=g)}return a};

/*
 timidity. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(f){return f.raw=f};$jscomp.createTemplateTagFirstArgWithRaw=function(f,m){f.raw=m;return f};$jscomp.arrayIteratorImpl=function(f){var m=0;return function(){return m<f.length?{done:!1,value:f[m++]}:{done:!0}}};$jscomp.arrayIterator=function(f){return{next:$jscomp.arrayIteratorImpl(f)}};$jscomp.makeIterator=function(f){var m="undefined"!=typeof Symbol&&Symbol.iterator&&f[Symbol.iterator];return m?m.call(f):$jscomp.arrayIterator(f)};
$jscomp.arrayFromIterator=function(f){for(var m,q=[];!(m=f.next()).done;)q.push(m.value);return q};$jscomp.arrayFromIterable=function(f){return f instanceof Array?f:$jscomp.arrayFromIterator($jscomp.makeIterator(f))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(f){var m=function(){};m.prototype=f;return new m};$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,m,q){if(f==Array.prototype||f==Object.prototype)return f;f[m]=q.value;return f};
$jscomp.getGlobal=function(f){f=["object"==typeof globalThis&&globalThis,f,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var m=0;m<f.length;++m){var q=f[m];if(q&&q.Math==Math)return q}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(f,m){var q=$jscomp.propertyToPolyfillSymbol[m];if(null==q)return f[m];q=f[q];return void 0!==q?q:f[m]};$jscomp.polyfill=function(f,m,q,u){m&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(f,m,q,u):$jscomp.polyfillUnisolated(f,m,q,u))};
$jscomp.polyfillUnisolated=function(f,m,q,u){q=$jscomp.global;f=f.split(".");for(u=0;u<f.length-1;u++){var l=f[u];if(!(l in q))return;q=q[l]}f=f[f.length-1];u=q[f];m=m(u);m!=u&&null!=m&&$jscomp.defineProperty(q,f,{configurable:!0,writable:!0,value:m})};
$jscomp.polyfillIsolated=function(f,m,q,u){var l=f.split(".");f=1===l.length;u=l[0];u=!f&&u in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var z=0;z<l.length-1;z++){var w=l[z];if(!(w in u))return;u=u[w]}l=l[l.length-1];q=$jscomp.IS_SYMBOL_NATIVE&&"es6"===q?u[l]:null;m=m(q);null!=m&&(f?$jscomp.defineProperty($jscomp.polyfills,l,{configurable:!0,writable:!0,value:m}):m!==q&&(void 0===$jscomp.propertyToPolyfillSymbol[l]&&(q=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[l]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(l):$jscomp.POLYFILL_PREFIX+q+"$"+l),$jscomp.defineProperty(u,$jscomp.propertyToPolyfillSymbol[l],{configurable:!0,writable:!0,value:m})))};
$jscomp.getConstructImplementation=function(){function f(){function q(){}new q;Reflect.construct(q,[],function(){});return new q instanceof q}if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(f())return Reflect.construct;var m=Reflect.construct;return function(q,u,l){q=m(q,u);l&&Reflect.setPrototypeOf(q,l.prototype);return q}}return function(q,u,l){void 0===l&&(l=q);l=$jscomp.objectCreate(l.prototype||Object.prototype);return Function.prototype.apply.call(q,l,u)||
l}};$jscomp.construct={valueOf:$jscomp.getConstructImplementation}.valueOf();$jscomp.underscoreProtoCanBeSet=function(){var f={a:!0},m={};try{return m.__proto__=f,m.a}catch(q){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(f,m){f.__proto__=m;if(f.__proto__!==m)throw new TypeError(f+" is not extensible");return f}:null;
$jscomp.inherits=function(f,m){f.prototype=$jscomp.objectCreate(m.prototype);f.prototype.constructor=f;if($jscomp.setPrototypeOf){var q=$jscomp.setPrototypeOf;q(f,m)}else for(q in m)if("prototype"!=q)if(Object.defineProperties){var u=Object.getOwnPropertyDescriptor(m,q);u&&Object.defineProperty(f,q,u)}else f[q]=m[q];f.superClass_=m.prototype};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(f){if(!(f instanceof Object))throw new TypeError("Iterator result "+f+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(f){this.yieldResult=f};
$jscomp.generator.Context.prototype.throw_=function(f){this.abruptCompletion_={exception:f,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(f){this.abruptCompletion_={return:f};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(f){this.abruptCompletion_={jumpTo:f};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(f,m){this.nextAddress=m;return{value:f}};
$jscomp.generator.Context.prototype.yieldAll=function(f,m){f=$jscomp.makeIterator(f);var q=f.next();$jscomp.generator.ensureIteratorResultIsObject_(q);if(q.done)this.yieldResult=q.value,this.nextAddress=m;else return this.yieldAllIterator_=f,this.yield(q.value,m)};$jscomp.generator.Context.prototype.jumpTo=function(f){this.nextAddress=f};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(f,m){this.catchAddress_=f;void 0!=m&&(this.finallyAddress_=m)};$jscomp.generator.Context.prototype.setFinallyBlock=function(f){this.catchAddress_=0;this.finallyAddress_=f||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(f,m){this.nextAddress=f;this.catchAddress_=m||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(f){this.catchAddress_=f||0;f=this.abruptCompletion_.exception;this.abruptCompletion_=null;return f};$jscomp.generator.Context.prototype.enterFinallyBlock=function(f,m,q){q?this.finallyContexts_[q]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=f||0;this.finallyAddress_=m||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(f,m){m=this.finallyContexts_.splice(m||0)[0];if(m=this.abruptCompletion_=this.abruptCompletion_||m){if(m.isException)return this.jumpToErrorHandler_();void 0!=m.jumpTo&&this.finallyAddress_<m.jumpTo?(this.nextAddress=m.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=f};$jscomp.generator.Context.prototype.forIn=function(f){return new $jscomp.generator.Context.PropertyIterator(f)};
$jscomp.generator.Context.PropertyIterator=function(f){this.object_=f;this.properties_=[];for(var m in f)this.properties_.push(m);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var f=this.properties_.pop();if(f in this.object_)return f}return null};$jscomp.generator.Engine_=function(f){this.context_=new $jscomp.generator.Context;this.program_=f};
$jscomp.generator.Engine_.prototype.next_=function(f){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,f,this.context_.next_);this.context_.next_(f);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(f){this.context_.start_();var m=this.context_.yieldAllIterator_;if(m)return this.yieldAllStep_("return"in m?m["return"]:function(q){return{value:q,done:!0}},f,this.context_.return);this.context_.return(f);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(f){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],f,this.context_.next_);this.context_.throw_(f);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(f,m,q){try{var u=f.call(this.context_.yieldAllIterator_,m);$jscomp.generator.ensureIteratorResultIsObject_(u);if(!u.done)return this.context_.stop_(),u;var l=u.value}catch(z){return this.context_.yieldAllIterator_=null,this.context_.throw_(z),this.nextStep_()}this.context_.yieldAllIterator_=null;q.call(this.context_,l);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var f=this.program_(this.context_);if(f)return this.context_.stop_(),{value:f.value,done:!1}}catch(m){this.context_.yieldResult=void 0,this.context_.throw_(m)}this.context_.stop_();if(this.context_.abruptCompletion_){f=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(f.isException)throw f.exception;return{value:f.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(f){this.next=function(m){return f.next_(m)};this.throw=function(m){return f.throw_(m)};this.return=function(m){return f.return_(m)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(f,m){m=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(m));$jscomp.setPrototypeOf&&f.prototype&&$jscomp.setPrototypeOf(m,f.prototype);return m};
$jscomp.asyncExecutePromiseGenerator=function(f){function m(u){return f.next(u)}function q(u){return f.throw(u)}return new Promise(function(u,l){function z(w){w.done?u(w.value):Promise.resolve(w.value).then(m,q).then(z,l)}z(f.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(f){return $jscomp.asyncExecutePromiseGenerator(f())};$jscomp.asyncExecutePromiseGeneratorProgram=function(f){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(f)))};
$jscomp.polyfill("Reflect",function(f){return f?f:{}},"es6","es3");$jscomp.polyfill("Reflect.construct",function(f){return $jscomp.construct},"es6","es3");$jscomp.polyfill("Reflect.setPrototypeOf",function(f){if(f)return f;if($jscomp.setPrototypeOf){var m=$jscomp.setPrototypeOf;return function(q,u){try{return m(q,u),!0}catch(l){return!1}}}return null},"es6","es5");$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(f){if(f)return f;var m=function(z,w){this.$jscomp$symbol$id_=z;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:w})};m.prototype.toString=function(){return this.$jscomp$symbol$id_};var q="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",u=0,l=function(z){if(this instanceof l)throw new TypeError("Symbol is not a constructor");return new m(q+(z||"")+"_"+u++,z)};return l},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(f){if(f)return f;f=Symbol("Symbol.iterator");for(var m="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),q=0;q<m.length;q++){var u=$jscomp.global[m[q]];"function"===typeof u&&"function"!=typeof u.prototype[f]&&$jscomp.defineProperty(u.prototype,f,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return f},"es6",
"es3");$jscomp.iteratorPrototype=function(f){f={next:f};f[Symbol.iterator]=function(){return this};return f};
$jscomp.polyfill("Promise",function(f){function m(){this.batch_=null}function q(w){return w instanceof l?w:new l(function(r,h){r(w)})}if(f&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return f;m.prototype.asyncExecute=function(w){if(null==this.batch_){this.batch_=[];var r=this;this.asyncExecuteFunction(function(){r.executeBatch_()})}this.batch_.push(w)};
var u=$jscomp.global.setTimeout;m.prototype.asyncExecuteFunction=function(w){u(w,0)};m.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var w=this.batch_;this.batch_=[];for(var r=0;r<w.length;++r){var h=w[r];w[r]=null;try{h()}catch(p){this.asyncThrow_(p)}}}this.batch_=null};m.prototype.asyncThrow_=function(w){this.asyncExecuteFunction(function(){throw w;})};var l=function(w){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=!1;var r=this.createResolveAndReject_();
try{w(r.resolve,r.reject)}catch(h){r.reject(h)}};l.prototype.createResolveAndReject_=function(){function w(p){return function(A){h||(h=!0,p.call(r,A))}}var r=this,h=!1;return{resolve:w(this.resolveTo_),reject:w(this.reject_)}};l.prototype.resolveTo_=function(w){if(w===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(w instanceof l)this.settleSameAsPromise_(w);else{a:switch(typeof w){case "object":var r=null!=w;break a;case "function":r=!0;break a;default:r=!1}r?this.resolveToNonPromiseObj_(w):
this.fulfill_(w)}};l.prototype.resolveToNonPromiseObj_=function(w){var r=void 0;try{r=w.then}catch(h){this.reject_(h);return}"function"==typeof r?this.settleSameAsThenable_(r,w):this.fulfill_(w)};l.prototype.reject_=function(w){this.settle_(2,w)};l.prototype.fulfill_=function(w){this.settle_(1,w)};l.prototype.settle_=function(w,r){if(0!=this.state_)throw Error("Cannot settle("+w+", "+r+"): Promise already settled in state"+this.state_);this.state_=w;this.result_=r;2===this.state_&&this.scheduleUnhandledRejectionCheck_();
this.executeOnSettledCallbacks_()};l.prototype.scheduleUnhandledRejectionCheck_=function(){var w=this;u(function(){if(w.notifyUnhandledRejection_()){var r=$jscomp.global.console;"undefined"!==typeof r&&r.error(w.result_)}},1)};l.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var w=$jscomp.global.CustomEvent,r=$jscomp.global.Event,h=$jscomp.global.dispatchEvent;if("undefined"===typeof h)return!0;"function"===typeof w?w=new w("unhandledrejection",{cancelable:!0}):
"function"===typeof r?w=new r("unhandledrejection",{cancelable:!0}):(w=$jscomp.global.document.createEvent("CustomEvent"),w.initCustomEvent("unhandledrejection",!1,!0,w));w.promise=this;w.reason=this.result_;return h(w)};l.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var w=0;w<this.onSettledCallbacks_.length;++w)z.asyncExecute(this.onSettledCallbacks_[w]);this.onSettledCallbacks_=null}};var z=new m;l.prototype.settleSameAsPromise_=function(w){var r=this.createResolveAndReject_();
w.callWhenSettled_(r.resolve,r.reject)};l.prototype.settleSameAsThenable_=function(w,r){var h=this.createResolveAndReject_();try{w.call(r,h.resolve,h.reject)}catch(p){h.reject(p)}};l.prototype.then=function(w,r){function h(F,E){return"function"==typeof F?function(D){try{p(F(D))}catch(O){A(O)}}:E}var p,A,B=new l(function(F,E){p=F;A=E});this.callWhenSettled_(h(w,p),h(r,A));return B};l.prototype.catch=function(w){return this.then(void 0,w)};l.prototype.callWhenSettled_=function(w,r){function h(){switch(p.state_){case 1:w(p.result_);
break;case 2:r(p.result_);break;default:throw Error("Unexpected state: "+p.state_);}}var p=this;null==this.onSettledCallbacks_?z.asyncExecute(h):this.onSettledCallbacks_.push(h);this.isRejectionHandled_=!0};l.resolve=q;l.reject=function(w){return new l(function(r,h){h(w)})};l.race=function(w){return new l(function(r,h){for(var p=$jscomp.makeIterator(w),A=p.next();!A.done;A=p.next())q(A.value).callWhenSettled_(r,h)})};l.all=function(w){var r=$jscomp.makeIterator(w),h=r.next();return h.done?q([]):new l(function(p,
A){function B(D){return function(O){F[D]=O;E--;0==E&&p(F)}}var F=[],E=0;do F.push(void 0),E++,q(h.value).callWhenSettled_(B(F.length-1),A),h=r.next();while(!h.done)})};return l},"es6","es3");$jscomp.polyfill("Number.isNaN",function(f){return f?f:function(m){return"number"===typeof m&&isNaN(m)}},"es6","es3");
$jscomp.iteratorFromArray=function(f,m){f instanceof String&&(f+="");var q=0,u=!1,l={next:function(){if(!u&&q<f.length){var z=q++;return{value:m(z,f[z]),done:!1}}u=!0;return{done:!0,value:void 0}}};l[Symbol.iterator]=function(){return l};return l};$jscomp.polyfill("Array.prototype.keys",function(f){return f?f:function(){return $jscomp.iteratorFromArray(this,function(m){return m})}},"es6","es3");
$jscomp.polyfill("Array.prototype.copyWithin",function(f){function m(q){q=Number(q);return Infinity===q||-Infinity===q?q:q|0}return f?f:function(q,u,l){var z=this.length;q=m(q);u=m(u);l=void 0===l?z:m(l);q=0>q?Math.max(z+q,0):Math.min(q,z);u=0>u?Math.max(z+u,0):Math.min(u,z);l=0>l?Math.max(z+l,0):Math.min(l,z);if(q<u)for(;u<l;)u in this?this[q++]=this[u++]:(delete this[q++],u++);else for(l=Math.min(l,z+u-q),q+=l-u;l>u;)--l in this?this[--q]=this[l]:delete this[--q];return this}},"es6","es3");
$jscomp.typedArrayCopyWithin=function(f){return f?f:Array.prototype.copyWithin};$jscomp.polyfill("Int8Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Uint8ClampedArray.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Int16Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");
$jscomp.polyfill("Uint16Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Int32Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Float32Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Float64Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");
$jscomp.checkStringArgs=function(f,m,q){if(null==f)throw new TypeError("The 'this' value for String.prototype."+q+" must not be null or undefined");if(m instanceof RegExp)throw new TypeError("First argument to String.prototype."+q+" must not be a regular expression");return f+""};
$jscomp.polyfill("String.prototype.endsWith",function(f){return f?f:function(m,q){var u=$jscomp.checkStringArgs(this,m,"endsWith");m+="";void 0===q&&(q=u.length);q=Math.max(0,Math.min(q|0,u.length));for(var l=m.length;0<l&&0<q;)if(u[--q]!=m[--l])return!1;return 0>=l}},"es6","es3");
require=function(){function f(m,q,u){function l(r,h){if(!q[r]){if(!m[r]){var p="function"==typeof require&&require;if(!h&&p)return p(r,!0);if(z)return z(r,!0);h=Error("Cannot find module '"+r+"'");throw h.code="MODULE_NOT_FOUND",h;}h=q[r]={exports:{}};m[r][0].call(h.exports,function(A){return l(m[r][1][A]||A)},h,h.exports,f,m,q,u)}return q[r].exports}for(var z="function"==typeof require&&require,w=0;w<u.length;w++)l(u[w]);return l}return f}()({1:[function(f,m,q){function u(){u.init.call(this)}function l(t){if("function"!==
typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);}function z(t,v,y,J){l(y);var H=t._events;if(void 0===H)H=t._events=Object.create(null),t._eventsCount=0;else{void 0!==H.newListener&&(t.emit("newListener",v,y.listener?y.listener:y),H=t._events);var P=H[v]}void 0===P?(H[v]=y,++t._eventsCount):("function"===typeof P?P=H[v]=J?[y,P]:[P,y]:J?P.unshift(y):P.push(y),y=void 0===t._maxListeners?u.defaultMaxListeners:t._maxListeners,0<y&&P.length>y&&
!P.warned&&(P.warned=!0,y=Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(v)+" listeners added. Use emitter.setMaxListeners() to increase limit"),y.name="MaxListenersExceededWarning",y.emitter=t,y.type=v,y.count=P.length,console&&console.warn&&console.warn(y)));return t}function w(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r(t,
v,y){t={fired:!1,wrapFn:void 0,target:t,type:v,listener:y};v=w.bind(t);v.listener=y;return t.wrapFn=v}function h(t,v,y){t=t._events;if(void 0===t)return[];v=t[v];if(void 0===v)return[];if("function"===typeof v)return y?[v.listener||v]:[v];if(y)for(y=Array(v.length),t=0;t<y.length;++t)y[t]=v[t].listener||v[t];else y=A(v,v.length);return y}function p(t){var v=this._events;if(void 0!==v){t=v[t];if("function"===typeof t)return 1;if(void 0!==t)return t.length}return 0}function A(t,v){for(var y=Array(v),
J=0;J<v;++J)y[J]=t[J];return y}function B(t,v,y){"function"===typeof t.on&&F(t,"error",v,y)}function F(t,v,y,J){if("function"===typeof t.on)if(J.once)t.once(v,y);else t.on(v,y);else if("function"===typeof t.addEventListener)t.addEventListener(v,function X(P){J.once&&t.removeEventListener(v,X);y(P)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);}var E=(f="object"===typeof Reflect?Reflect:null)&&"function"===typeof f.apply?f.apply:function(t,
v,y){return Function.prototype.apply.call(t,v,y)};var D=f&&"function"===typeof f.ownKeys?f.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var O=Number.isNaN||function(t){return t!==t};m.exports=u;m.exports.once=function(t,v){return new Promise(function(y,J){function H(X){t.removeListener(v,P);J(X)}function P(){"function"===typeof t.removeListener&&t.removeListener("error",
H);y([].slice.call(arguments))}F(t,v,P,{once:!0});"error"!==v&&B(t,H,{once:!0})})};u.EventEmitter=u;u.prototype._events=void 0;u.prototype._eventsCount=0;u.prototype._maxListeners=void 0;var V=10;Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return V},set:function(t){if("number"!==typeof t||0>t||O(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");V=t}});u.init=function(){if(void 0===this._events||
this._events===Object.getPrototypeOf(this)._events)this._events=Object.create(null),this._eventsCount=0;this._maxListeners=this._maxListeners||void 0};u.prototype.setMaxListeners=function(t){if("number"!==typeof t||0>t||O(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");this._maxListeners=t;return this};u.prototype.getMaxListeners=function(){return void 0===this._maxListeners?u.defaultMaxListeners:this._maxListeners};u.prototype.emit=function(t){for(var v=
[],y=1;y<arguments.length;y++)v.push(arguments[y]);y="error"===t;var J=this._events;if(void 0!==J)y=y&&void 0===J.error;else if(!y)return!1;if(y){var H;0<v.length&&(H=v[0]);if(H instanceof Error)throw H;v=Error("Unhandled error."+(H?" ("+H.message+")":""));v.context=H;throw v;}y=J[t];if(void 0===y)return!1;if("function"===typeof y)E(y,this,v);else for(H=y.length,J=A(y,H),y=0;y<H;++y)E(J[y],this,v);return!0};u.prototype.addListener=function(t,v){return z(this,t,v,!1)};u.prototype.on=u.prototype.addListener;
u.prototype.prependListener=function(t,v){return z(this,t,v,!0)};u.prototype.once=function(t,v){l(v);this.on(t,r(this,t,v));return this};u.prototype.prependOnceListener=function(t,v){l(v);this.prependListener(t,r(this,t,v));return this};u.prototype.removeListener=function(t,v){var y;l(v);var J=this._events;if(void 0===J)return this;var H=J[t];if(void 0===H)return this;if(H===v||H.listener===v)0===--this._eventsCount?this._events=Object.create(null):(delete J[t],J.removeListener&&this.emit("removeListener",
t,H.listener||v));else if("function"!==typeof H){var P=-1;for(y=H.length-1;0<=y;y--)if(H[y]===v||H[y].listener===v){var X=H[y].listener;P=y;break}if(0>P)return this;if(0===P)H.shift();else{for(;P+1<H.length;P++)H[P]=H[P+1];H.pop()}1===H.length&&(J[t]=H[0]);void 0!==J.removeListener&&this.emit("removeListener",t,X||v)}return this};u.prototype.off=u.prototype.removeListener;u.prototype.removeAllListeners=function(t){var v=this._events;if(void 0===v)return this;if(void 0===v.removeListener)return 0===
arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==v[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete v[t]),this;if(0===arguments.length){var y=Object.keys(v);for(v=0;v<y.length;++v){var J=y[v];"removeListener"!==J&&this.removeAllListeners(J)}this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}y=v[t];if("function"===typeof y)this.removeListener(t,y);else if(void 0!==y)for(v=y.length-1;0<=v;v--)this.removeListener(t,
y[v]);return this};u.prototype.listeners=function(t){return h(this,t,!0)};u.prototype.rawListeners=function(t){return h(this,t,!1)};u.listenerCount=function(t,v){return"function"===typeof t.listenerCount?t.listenerCount(v):p.call(t,v)};u.prototype.listenerCount=p;u.prototype.eventNames=function(){return 0<this._eventsCount?D(this._events):[]}},{}],2:[function(f,m,q){function u(){throw Error("setTimeout has not been defined");}function l(){throw Error("clearTimeout has not been defined");}function z(t){if(B===
setTimeout)return setTimeout(t,0);if((B===u||!B)&&setTimeout)return B=setTimeout,setTimeout(t,0);try{return B(t,0)}catch(v){try{return B.call(null,t,0)}catch(y){return B.call(this,t,0)}}}function w(t){if(F===clearTimeout)return clearTimeout(t);if((F===l||!F)&&clearTimeout)return F=clearTimeout,clearTimeout(t);try{return F(t)}catch(v){try{return F.call(null,t)}catch(y){return F.call(this,t)}}}function r(){D&&O&&(D=!1,O.length?E=O.concat(E):V=-1,E.length&&h())}function h(){if(!D){var t=z(r);D=!0;for(var v=
E.length;v;){O=E;for(E=[];++V<v;)O&&O[V].run();V=-1;v=E.length}O=null;D=!1;w(t)}}function p(t,v){this.fun=t;this.array=v}function A(){}f=m.exports={};try{var B="function"===typeof setTimeout?setTimeout:u}catch(t){B=u}try{var F="function"===typeof clearTimeout?clearTimeout:l}catch(t){F=l}var E=[],D=!1,O,V=-1;f.nextTick=function(t){var v=Array(arguments.length-1);if(1<arguments.length)for(var y=1;y<arguments.length;y++)v[y-1]=arguments[y];E.push(new p(t,v));1!==E.length||D||z(h)};p.prototype.run=function(){this.fun.apply(null,
this.array)};f.title="browser";f.browser=!0;f.env={};f.argv=[];f.version="";f.versions={};f.on=A;f.addListener=A;f.once=A;f.off=A;f.removeListener=A;f.removeAllListeners=A;f.emit=A;f.prependListener=A;f.prependOnceListener=A;f.listeners=function(t){return[]};f.binding=function(t){throw Error("process.binding is not supported");};f.cwd=function(){return"/"};f.chdir=function(t){throw Error("process.chdir is not supported");};f.umask=function(){return 0}},{}],3:[function(f,m,q){(function(u){(function(){q.formatArgs=
function(z){z[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+z[0]+(this.useColors?"%c ":" ")+"+"+m.exports.humanize(this.diff);if(this.useColors){var w="color: "+this.color;z.splice(1,0,w,"color: inherit");var r=0,h=0;z[0].replace(/%[a-zA-Z%]/g,function(p){"%%"!==p&&(r++,"%c"===p&&(h=r))});z.splice(h,0,w)}};q.save=function(z){try{z?q.storage.setItem("debug",z):q.storage.removeItem("debug")}catch(w){}};q.load=function(){try{var z=q.storage.getItem("debug")}catch(w){}!z&&"undefined"!==
typeof u&&"env"in u&&(z=u.env.DEBUG);return z};q.useColors=function(){return"undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs)?!0:"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||
window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};a:{try{var l=localStorage;break a}catch(z){}l=void 0}q.storage=l;q.destroy=function(){var z=!1;return function(){z||(z=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}();
q.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
q.log=console.debug||console.log||function(){};m.exports=f("./common")(q);m.exports.formatters.j=function(z){try{return JSON.stringify(z)}catch(w){return"[UnexpectedJSONParseError]: "+w.message}}}).call(this)}).call(this,f("_process"))},{"./common":4,_process:2}],4:[function(f,m,q){m.exports=function(u){function l(r){function h(E){for(var D=[],O=0;O<arguments.length;++O)D[O-0]=arguments[O];if(h.enabled){O=Number(new Date);h.diff=O-(p||O);h.prev=p;p=h.curr=O;D[0]=l.coerce(D[0]);"string"!==typeof D[0]&&
D.unshift("%O");var V=0;D[0]=D[0].replace(/%([a-zA-Z%])/g,function(t,v){if("%%"===t)return"%";V++;v=l.formatters[v];"function"===typeof v&&(t=v.call(h,D[V]),D.splice(V,1),V--);return t});l.formatArgs.call(h,D);(h.log||l.log).apply(h,D)}}var p,A=null,B,F;h.namespace=r;h.useColors=l.useColors();h.color=l.selectColor(r);h.extend=z;h.destroy=l.destroy;Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:function(){if(null!==A)return A;B!==l.namespaces&&(B=l.namespaces,F=l.enabled(r));
return F},set:function(E){A=E}});"function"===typeof l.init&&l.init(h);return h}function z(r,h){r=l(this.namespace+("undefined"===typeof h?":":h)+r);r.log=this.log;return r}function w(r){return r.toString().substring(2,r.toString().length-2).replace(/\.\*\?$/,"*")}l.debug=l;l.default=l;l.coerce=function(r){return r instanceof Error?r.stack||r.message:r};l.disable=function(){var r=[].concat($jscomp.arrayFromIterable(l.names.map(w)),$jscomp.arrayFromIterable(l.skips.map(w).map(function(h){return"-"+
h}))).join(",");l.enable("");return r};l.enable=function(r){l.save(r);l.namespaces=r;l.names=[];l.skips=[];var h,p=("string"===typeof r?r:"").split(/[\s,]+/),A=p.length;for(h=0;h<A;h++)p[h]&&(r=p[h].replace(/\*/g,".*?"),"-"===r[0]?l.skips.push(new RegExp("^"+r.substr(1)+"$")):l.names.push(new RegExp("^"+r+"$")))};l.enabled=function(r){if("*"===r[r.length-1])return!0;var h;var p=0;for(h=l.skips.length;p<h;p++)if(l.skips[p].test(r))return!1;p=0;for(h=l.names.length;p<h;p++)if(l.names[p].test(r))return!0;
return!1};l.humanize=f("ms");l.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")};Object.keys(u).forEach(function(r){l[r]=u[r]});l.names=[];l.skips=[];l.formatters={};l.selectColor=function(r){for(var h=0,p=0;p<r.length;p++)h=(h<<5)-h+r.charCodeAt(p),h|=0;return l.colors[Math.abs(h)%l.colors.length]};l.enable(l.load());return l}},{ms:5}],5:[function(f,m,q){function u(r){r=String(r);
if(!(100<r.length)&&(r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r))){var h=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return h*w;case "weeks":case "week":case "w":return h*z;case "days":case "day":case "d":return 864E5*h;case "hours":case "hour":case "hrs":case "hr":case "h":return 36E5*h;case "minutes":case "minute":case "mins":case "min":case "m":return 6E4*
h;case "seconds":case "second":case "secs":case "sec":case "s":return 1E3*h;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return h}}}function l(r,h,p,A){return Math.round(r/p)+" "+A+(h>=1.5*p?"s":"")}var z=6048E5,w=315576E5;m.exports=function(r,h){h=h||{};var p=typeof r;if("string"===p&&0<r.length)return u(r);if("number"===p&&isFinite(r))return h.long?(h=Math.abs(r),r=864E5<=h?l(r,h,864E5,"day"):36E5<=h?l(r,h,36E5,"hour"):6E4<=h?l(r,h,6E4,"minute"):1E3<=h?l(r,h,1E3,"second"):
r+" ms"):(h=Math.abs(r),r=864E5<=h?Math.round(r/864E5)+"d":36E5<=h?Math.round(r/36E5)+"h":6E4<=h?Math.round(r/6E4)+"m":1E3<=h?Math.round(r/1E3)+"s":r+"ms"),r;throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r));}},{}],6:[function(f,m,q){var u=function(){var l="undefined"!==typeof document&&document.currentScript?document.currentScript.src:void 0;return function(z){function w(a){return n.locateFile?n.locateFile(a,aa):aa+a}function r(a,b,d){var e=b+d;for(d=b;a[d]&&
!(d>=e);)++d;if(16<d-b&&a.subarray&&ta)return ta.decode(a.subarray(b,d));for(e="";b<d;){var g=a[b++];if(g&128){var k=a[b++]&63;if(192==(g&224))e+=String.fromCharCode((g&31)<<6|k);else{var x=a[b++]&63;g=224==(g&240)?(g&15)<<12|k<<6|x:(g&7)<<18|k<<12|x<<6|a[b++]&63;65536>g?e+=String.fromCharCode(g):(g-=65536,e+=String.fromCharCode(55296|g>>10,56320|g&1023))}}else e+=String.fromCharCode(g)}return e}function h(a,b){return a?r(ha,a,b):""}function p(a,b,d,e){if(!(0<e))return 0;var g=d;e=d+e-1;for(var k=
0;k<a.length;++k){var x=a.charCodeAt(k);if(55296<=x&&57343>=x){var C=a.charCodeAt(++k);x=65536+((x&1023)<<10)|C&1023}if(127>=x){if(d>=e)break;b[d++]=x}else{if(2047>=x){if(d+1>=e)break;b[d++]=192|x>>6}else{if(65535>=x){if(d+2>=e)break;b[d++]=224|x>>12}else{if(d+3>=e)break;b[d++]=240|x>>18;b[d++]=128|x>>12&63}b[d++]=128|x>>6&63}b[d++]=128|x&63}}b[d]=0;return d-g}function A(a){for(var b=0,d=0;d<a.length;++d){var e=a.charCodeAt(d);55296<=e&&57343>=e&&(e=65536+((e&1023)<<10)|a.charCodeAt(++d)&1023);127>=
e?++b:b=2047>=e?b+2:65535>=e?b+3:b+4}return b}function B(a){ia=a;n.HEAP8=ba=new Int8Array(a);n.HEAP16=ua=new Int16Array(a);n.HEAP32=K=new Int32Array(a);n.HEAPU8=ha=new Uint8Array(a);n.HEAPU16=new Uint16Array(a);n.HEAPU32=new Uint32Array(a);n.HEAPF32=new Float32Array(a);n.HEAPF64=new Float64Array(a)}function F(a){fa++;n.monitorRunDependencies&&n.monitorRunDependencies(fa)}function E(a){fa--;n.monitorRunDependencies&&n.monitorRunDependencies(fa);0==fa&&(null!==pa&&(clearInterval(pa),pa=null),ja&&(a=
ja,ja=null,a()))}function D(a){if(n.onAbort)n.onAbort(a);a+="";U(a);va=!0;a=new WebAssembly.RuntimeError("abort("+a+"). Build with -s ASSERTIONS=1 for more info.");wa(a);throw a;}function O(a,b){return String.prototype.startsWith?a.startsWith(b):0===a.indexOf(b)}function V(){try{if(ka)return new Uint8Array(ka);if(xa)return xa(ca);throw"both async and sync fetching of the wasm failed";}catch(a){D(a)}}function t(){return ka||"function"!==typeof fetch?Promise.resolve().then(V):fetch(ca,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+
ca+"'";return a.arrayBuffer()}).catch(function(){return V()})}function v(a){for(;0<a.length;){var b=a.shift();if("function"==typeof b)b(n);else{var d=b.func;"number"===typeof d?void 0===b.arg?qa.get(d)():qa.get(d)(b.arg):d(void 0===b.arg?null:b.arg)}}}function y(a){return a.replace(/\b_Z[\w\d_]+/g,function(b){return b===b?b:b+" ["+b+"]"})}function J(a){return K[ya()>>2]=a}function H(){if("object"===typeof crypto&&"function"===typeof crypto.getRandomValues){var a=new Uint8Array(1);return function(){crypto.getRandomValues(a);
return a[0]}}return function(){D("randomDevice")}}function P(a,b,d){d=0<d?d:A(a)+1;d=Array(d);a=p(a,d,0,d.length);b&&(d.length=a);return d}function X(a){function b(){if(!ma&&(ma=!0,n.calledRun=!0,!va)){n.noFSInit||c.init.initialized||c.init();da.init();v(za);c.ignorePermissions=!1;v(Ha);Aa(n);if(n.onRuntimeInitialized)n.onRuntimeInitialized();if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)Ba.unshift(n.postRun.shift());v(Ba)}}if(!(0<fa)){if(n.preRun)for("function"==
typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)Ca.unshift(n.preRun.shift());v(Ca);0<fa||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1);b()},1)):b())}}z=z||{};null;var n="undefined"!==typeof z?z:{},Aa,wa;n.ready=new Promise(function(a,b){Aa=a;wa=b});var W={},ea;for(ea in n)n.hasOwnProperty(ea)&&(W[ea]=n[ea]);var aa="",xa;document.currentScript&&(aa=document.currentScript.src);l&&(aa=l);aa=0!==aa.indexOf("blob:")?aa.substr(0,aa.lastIndexOf("/")+
1):"";var Da=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.send(null);return b.responseText};var ra=n.print||console.log.bind(console),U=n.printErr||console.warn.bind(console);for(ea in W)W.hasOwnProperty(ea)&&(n[ea]=W[ea]);W=null;var ka;n.wasmBinary&&(ka=n.wasmBinary);"object"!==typeof WebAssembly&&D("no native wasm support detected");var la,qa,va=!1,ta="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0,ba,ha,ua,K;W=n.INITIAL_MEMORY||16777216;if(la=n.wasmMemory?n.wasmMemory:
new WebAssembly.Memory({initial:W/65536,maximum:32768}))var ia=la.buffer;W=ia.byteLength;B(ia);var Ca=[],za=[],Ha=[],Ba=[],fa=0,pa=null,ja=null;n.preloadedImages={};n.preloadedAudios={};var ca="libtimidity.wasm";O(ca,"data:application/octet-stream;base64,")||(ca=w(ca));var S,Y,L={splitPath:function(a){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(a).slice(1)},normalizeArray:function(a,b){for(var d=0,e=a.length-1;0<=e;e--){var g=a[e];"."===g?a.splice(e,1):".."===g?(a.splice(e,
1),d++):d&&(a.splice(e,1),d--)}if(b)for(;d;d--)a.unshift("..");return a},normalize:function(a){var b="/"===a.charAt(0),d="/"===a.substr(-1);(a=L.normalizeArray(a.split("/").filter(function(e){return!!e}),!b).join("/"))||b||(a=".");a&&d&&(a+="/");return(b?"/":"")+a},dirname:function(a){var b=L.splitPath(a);a=b[0];b=b[1];if(!a&&!b)return".";b&&(b=b.substr(0,b.length-1));return a+b},basename:function(a){if("/"===a)return"/";a=L.normalize(a);a=a.replace(/\/$/,"");var b=a.lastIndexOf("/");return-1===b?
a:a.substr(b+1)},extname:function(a){return L.splitPath(a)[3]},join:function(){var a=Array.prototype.slice.call(arguments,0);return L.normalize(a.join("/"))},join2:function(a,b){return L.normalize(a+"/"+b)}},Z={resolve:function(){for(var a="",b=!1,d=arguments.length-1;-1<=d&&!b;d--){b=0<=d?arguments[d]:c.cwd();if("string"!==typeof b)throw new TypeError("Arguments to path.resolve must be strings");if(!b)return"";a=b+"/"+a;b="/"===b.charAt(0)}a=L.normalizeArray(a.split("/").filter(function(e){return!!e}),
!b).join("/");return(b?"/":"")+a||"."},relative:function(a,b){function d(x){for(var C=0;C<x.length&&""===x[C];C++);for(var I=x.length-1;0<=I&&""===x[I];I--);return C>I?[]:x.slice(C,I-C+1)}a=Z.resolve(a).substr(1);b=Z.resolve(b).substr(1);a=d(a.split("/"));b=d(b.split("/"));for(var e=Math.min(a.length,b.length),g=e,k=0;k<e;k++)if(a[k]!==b[k]){g=k;break}e=[];for(k=g;k<a.length;k++)e.push("..");e=e.concat(b.slice(g));return e.join("/")}},da={ttys:[],init:function(){},shutdown:function(){},register:function(a,
b){da.ttys[a]={input:[],output:[],ops:b};c.registerDevice(a,da.stream_ops)},stream_ops:{open:function(a){var b=da.ttys[a.node.rdev];if(!b)throw new c.ErrnoError(43);a.tty=b;a.seekable=!1},close:function(a){a.tty.ops.flush(a.tty)},flush:function(a){a.tty.ops.flush(a.tty)},read:function(a,b,d,e,g){if(!a.tty||!a.tty.ops.get_char)throw new c.ErrnoError(60);for(var k=g=0;k<e;k++){try{var x=a.tty.ops.get_char(a.tty)}catch(C){throw new c.ErrnoError(29);}if(void 0===x&&0===g)throw new c.ErrnoError(6);if(null===
x||void 0===x)break;g++;b[d+k]=x}g&&(a.node.timestamp=Date.now());return g},write:function(a,b,d,e,g){if(!a.tty||!a.tty.ops.put_char)throw new c.ErrnoError(60);try{for(g=0;g<e;g++)a.tty.ops.put_char(a.tty,b[d+g])}catch(k){throw new c.ErrnoError(29);}e&&(a.node.timestamp=Date.now());return g}},default_tty_ops:{get_char:function(a){if(!a.input.length){var b=null;"undefined"!=typeof window&&"function"==typeof window.prompt?(b=window.prompt("Input: "),null!==b&&(b+="\n")):"function"==typeof readline&&
(b=readline(),null!==b&&(b+="\n"));if(!b)return null;a.input=P(b,!0)}return a.input.shift()},put_char:function(a,b){null===b||10===b?(ra(r(a.output,0)),a.output=[]):0!=b&&a.output.push(b)},flush:function(a){a.output&&0<a.output.length&&(ra(r(a.output,0)),a.output=[])}},default_tty1_ops:{put_char:function(a,b){null===b||10===b?(U(r(a.output,0)),a.output=[]):0!=b&&a.output.push(b)},flush:function(a){a.output&&0<a.output.length&&(U(r(a.output,0)),a.output=[])}}},G={ops_table:null,mount:function(a){return G.createNode(null,
"/",16895,0)},createNode:function(a,b,d,e){if(c.isBlkdev(d)||c.isFIFO(d))throw new c.ErrnoError(63);G.ops_table||(G.ops_table={dir:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr,lookup:G.node_ops.lookup,mknod:G.node_ops.mknod,rename:G.node_ops.rename,unlink:G.node_ops.unlink,rmdir:G.node_ops.rmdir,readdir:G.node_ops.readdir,symlink:G.node_ops.symlink},stream:{llseek:G.stream_ops.llseek}},file:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr},stream:{llseek:G.stream_ops.llseek,
read:G.stream_ops.read,write:G.stream_ops.write,allocate:G.stream_ops.allocate,mmap:G.stream_ops.mmap,msync:G.stream_ops.msync}},link:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr,readlink:G.node_ops.readlink},stream:{}},chrdev:{node:{getattr:G.node_ops.getattr,setattr:G.node_ops.setattr},stream:c.chrdev_stream_ops}});d=c.createNode(a,b,d,e);c.isDir(d.mode)?(d.node_ops=G.ops_table.dir.node,d.stream_ops=G.ops_table.dir.stream,d.contents={}):c.isFile(d.mode)?(d.node_ops=G.ops_table.file.node,
d.stream_ops=G.ops_table.file.stream,d.usedBytes=0,d.contents=null):c.isLink(d.mode)?(d.node_ops=G.ops_table.link.node,d.stream_ops=G.ops_table.link.stream):c.isChrdev(d.mode)&&(d.node_ops=G.ops_table.chrdev.node,d.stream_ops=G.ops_table.chrdev.stream);d.timestamp=Date.now();a&&(a.contents[b]=d);return d},getFileDataAsRegularArray:function(a){if(a.contents&&a.contents.subarray){for(var b=[],d=0;d<a.usedBytes;++d)b.push(a.contents[d]);return b}return a.contents},getFileDataAsTypedArray:function(a){return a.contents?
a.contents.subarray?a.contents.subarray(0,a.usedBytes):new Uint8Array(a.contents):new Uint8Array(0)},expandFileStorage:function(a,b){var d=a.contents?a.contents.length:0;d>=b||(b=Math.max(b,d*(1048576>d?2:1.125)>>>0),0!=d&&(b=Math.max(b,256)),d=a.contents,a.contents=new Uint8Array(b),0<a.usedBytes&&a.contents.set(d.subarray(0,a.usedBytes),0))},resizeFileStorage:function(a,b){if(a.usedBytes!=b)if(0==b)a.contents=null,a.usedBytes=0;else{if(!a.contents||a.contents.subarray){var d=a.contents;a.contents=
new Uint8Array(b);d&&a.contents.set(d.subarray(0,Math.min(b,a.usedBytes)))}else if(a.contents||(a.contents=[]),a.contents.length>b)a.contents.length=b;else for(;a.contents.length<b;)a.contents.push(0);a.usedBytes=b}},node_ops:{getattr:function(a){var b={};b.dev=c.isChrdev(a.mode)?a.id:1;b.ino=a.id;b.mode=a.mode;b.nlink=1;b.uid=0;b.gid=0;b.rdev=a.rdev;c.isDir(a.mode)?b.size=4096:c.isFile(a.mode)?b.size=a.usedBytes:c.isLink(a.mode)?b.size=a.link.length:b.size=0;b.atime=new Date(a.timestamp);b.mtime=
new Date(a.timestamp);b.ctime=new Date(a.timestamp);b.blksize=4096;b.blocks=Math.ceil(b.size/b.blksize);return b},setattr:function(a,b){void 0!==b.mode&&(a.mode=b.mode);void 0!==b.timestamp&&(a.timestamp=b.timestamp);void 0!==b.size&&G.resizeFileStorage(a,b.size)},lookup:function(a,b){throw c.genericErrors[44];},mknod:function(a,b,d,e){return G.createNode(a,b,d,e)},rename:function(a,b,d){if(c.isDir(a.mode)){try{var e=c.lookupNode(b,d)}catch(k){}if(e)for(var g in e.contents)throw new c.ErrnoError(55);
}delete a.parent.contents[a.name];a.name=d;b.contents[d]=a;a.parent=b},unlink:function(a,b){delete a.contents[b]},rmdir:function(a,b){var d=c.lookupNode(a,b),e;for(e in d.contents)throw new c.ErrnoError(55);delete a.contents[b]},readdir:function(a){var b=[".",".."],d;for(d in a.contents)a.contents.hasOwnProperty(d)&&b.push(d);return b},symlink:function(a,b,d){a=G.createNode(a,b,41471,0);a.link=d;return a},readlink:function(a){if(!c.isLink(a.mode))throw new c.ErrnoError(28);return a.link}},stream_ops:{read:function(a,
b,d,e,g){var k=a.node.contents;if(g>=a.node.usedBytes)return 0;a=Math.min(a.node.usedBytes-g,e);if(8<a&&k.subarray)b.set(k.subarray(g,g+a),d);else for(e=0;e<a;e++)b[d+e]=k[g+e];return a},write:function(a,b,d,e,g,k){b.buffer===ba.buffer&&(k=!1);if(!e)return 0;a=a.node;a.timestamp=Date.now();if(b.subarray&&(!a.contents||a.contents.subarray)){if(k)return a.contents=b.subarray(d,d+e),a.usedBytes=e;if(0===a.usedBytes&&0===g)return a.contents=b.slice(d,d+e),a.usedBytes=e;if(g+e<=a.usedBytes)return a.contents.set(b.subarray(d,
d+e),g),e}G.expandFileStorage(a,g+e);if(a.contents.subarray&&b.subarray)a.contents.set(b.subarray(d,d+e),g);else for(k=0;k<e;k++)a.contents[g+k]=b[d+k];a.usedBytes=Math.max(a.usedBytes,g+e);return e},llseek:function(a,b,d){1===d?b+=a.position:2===d&&c.isFile(a.node.mode)&&(b+=a.node.usedBytes);if(0>b)throw new c.ErrnoError(28);return b},allocate:function(a,b,d){G.expandFileStorage(a.node,b+d);a.node.usedBytes=Math.max(a.node.usedBytes,b+d)},mmap:function(a,b,d,e,g,k){0!==b&&D("Assertion failed: undefined");
if(!c.isFile(a.node.mode))throw new c.ErrnoError(43);a=a.node.contents;if(k&2||a.buffer!==ia){if(0<e||e+d<a.length)a=a.subarray?a.subarray(e,e+d):Array.prototype.slice.call(a,e,e+d);e=!0;k=16384*Math.ceil(d/16384);for(b=Ea(k);d<k;)ba[b+d++]=0;d=b;if(!d)throw new c.ErrnoError(48);ba.set(a,d)}else e=!1,d=a.byteOffset;return{ptr:d,allocated:e}},msync:function(a,b,d,e,g){if(!c.isFile(a.node.mode))throw new c.ErrnoError(43);if(g&2)return 0;G.stream_ops.write(a,b,0,e,d,!1);return 0}}},c={root:null,mounts:[],
devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(a){if(!(a instanceof c.ErrnoError)){a:{var b=Error();if(!b.stack){try{throw Error();}catch(d){b=d}if(!b.stack){b="(no stack trace available)";break a}}b=b.stack.toString()}n.extraStackTrace&&(b+="\n"+n.extraStackTrace());b=y(b);throw a+" : "+b;}return J(a.errno)},
lookupPath:function(a,b){a=Z.resolve(c.cwd(),a);b=b||{};if(!a)return{path:"",node:null};var d={follow_mount:!0,recurse_count:0},e;for(e in d)void 0===b[e]&&(b[e]=d[e]);if(8<b.recurse_count)throw new c.ErrnoError(32);a=L.normalizeArray(a.split("/").filter(function(x){return!!x}),!1);var g=c.root;d="/";for(e=0;e<a.length;e++){var k=e===a.length-1;if(k&&b.parent)break;g=c.lookupNode(g,a[e]);d=L.join2(d,a[e]);c.isMountpoint(g)&&(!k||k&&b.follow_mount)&&(g=g.mounted.root);if(!k||b.follow)for(k=0;c.isLink(g.mode);)if(g=
c.readlink(d),d=Z.resolve(L.dirname(d),g),g=c.lookupPath(d,{recurse_count:b.recurse_count}).node,40<k++)throw new c.ErrnoError(32);}return{path:d,node:g}},getPath:function(a){for(var b;;){if(c.isRoot(a))return a=a.mount.mountpoint,b?"/"!==a[a.length-1]?a+"/"+b:a+b:a;b=b?a.name+"/"+b:a.name;a=a.parent}},hashName:function(a,b){for(var d=0,e=0;e<b.length;e++)d=(d<<5)-d+b.charCodeAt(e)|0;return(a+d>>>0)%c.nameTable.length},hashAddNode:function(a){var b=c.hashName(a.parent.id,a.name);a.name_next=c.nameTable[b];
c.nameTable[b]=a},hashRemoveNode:function(a){var b=c.hashName(a.parent.id,a.name);if(c.nameTable[b]===a)c.nameTable[b]=a.name_next;else for(b=c.nameTable[b];b;){if(b.name_next===a){b.name_next=a.name_next;break}b=b.name_next}},lookupNode:function(a,b){var d=c.mayLookup(a);if(d)throw new c.ErrnoError(d,a);d=c.hashName(a.id,b);for(d=c.nameTable[d];d;d=d.name_next){var e=d.name;if(d.parent.id===a.id&&e===b)return d}return c.lookup(a,b)},createNode:function(a,b,d,e){a=new c.FSNode(a,b,d,e);c.hashAddNode(a);
return a},destroyNode:function(a){c.hashRemoveNode(a)},isRoot:function(a){return a===a.parent},isMountpoint:function(a){return!!a.mounted},isFile:function(a){return 32768===(a&61440)},isDir:function(a){return 16384===(a&61440)},isLink:function(a){return 40960===(a&61440)},isChrdev:function(a){return 8192===(a&61440)},isBlkdev:function(a){return 24576===(a&61440)},isFIFO:function(a){return 4096===(a&61440)},isSocket:function(a){return 49152===(a&49152)},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,
xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(a){var b=c.flagModes[a];if("undefined"===typeof b)throw Error("Unknown file open mode: "+a);return b},flagsToPermissionString:function(a){var b=["r","w","rw"][a&3];a&512&&(b+="w");return b},nodePermissions:function(a,b){if(c.ignorePermissions)return 0;if(-1===b.indexOf("r")||a.mode&292){if(-1!==b.indexOf("w")&&!(a.mode&146)||-1!==b.indexOf("x")&&!(a.mode&73))return 2}else return 2;
return 0},mayLookup:function(a){var b=c.nodePermissions(a,"x");return b?b:a.node_ops.lookup?0:2},mayCreate:function(a,b){try{return c.lookupNode(a,b),20}catch(d){}return c.nodePermissions(a,"wx")},mayDelete:function(a,b,d){try{var e=c.lookupNode(a,b)}catch(g){return g.errno}if(a=c.nodePermissions(a,"wx"))return a;if(d){if(!c.isDir(e.mode))return 54;if(c.isRoot(e)||c.getPath(e)===c.cwd())return 10}else if(c.isDir(e.mode))return 31;return 0},mayOpen:function(a,b){return a?c.isLink(a.mode)?32:c.isDir(a.mode)&&
("r"!==c.flagsToPermissionString(b)||b&512)?31:c.nodePermissions(a,c.flagsToPermissionString(b)):44},MAX_OPEN_FDS:4096,nextfd:function(a,b){b=b||c.MAX_OPEN_FDS;for(a=a||0;a<=b;a++)if(!c.streams[a])return a;throw new c.ErrnoError(33);},getStream:function(a){return c.streams[a]},createStream:function(a,b,d){c.FSStream||(c.FSStream=function(){},c.FSStream.prototype={object:{get:function(){return this.node},set:function(k){this.node=k}},isRead:{get:function(){return 1!==(this.flags&2097155)}},isWrite:{get:function(){return 0!==
(this.flags&2097155)}},isAppend:{get:function(){return this.flags&1024}}});var e=new c.FSStream,g;for(g in a)e[g]=a[g];a=e;b=c.nextfd(b,d);a.fd=b;return c.streams[b]=a},closeStream:function(a){c.streams[a]=null},chrdev_stream_ops:{open:function(a){var b=c.getDevice(a.node.rdev);a.stream_ops=b.stream_ops;a.stream_ops.open&&a.stream_ops.open(a)},llseek:function(){throw new c.ErrnoError(70);}},major:function(a){return a>>8},minor:function(a){return a&255},makedev:function(a,b){return a<<8|b},registerDevice:function(a,
b){c.devices[a]={stream_ops:b}},getDevice:function(a){return c.devices[a]},getMounts:function(a){var b=[];for(a=[a];a.length;){var d=a.pop();b.push(d);a.push.apply(a,d.mounts)}return b},syncfs:function(a,b){function d(x){c.syncFSRequests--;return b(x)}function e(x){if(x){if(!e.errored)return e.errored=!0,d(x)}else++k>=g.length&&d(null)}"function"===typeof a&&(b=a,a=!1);c.syncFSRequests++;1<c.syncFSRequests&&U("warning: "+c.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");
var g=c.getMounts(c.root.mount),k=0;g.forEach(function(x){if(!x.type.syncfs)return e(null);x.type.syncfs(x,a,e)})},mount:function(a,b,d){var e="/"===d,g=!d;if(e&&c.root)throw new c.ErrnoError(10);if(!e&&!g){var k=c.lookupPath(d,{follow_mount:!1});d=k.path;k=k.node;if(c.isMountpoint(k))throw new c.ErrnoError(10);if(!c.isDir(k.mode))throw new c.ErrnoError(54);}b={type:a,opts:b,mountpoint:d,mounts:[]};a=a.mount(b);a.mount=b;b.root=a;e?c.root=a:k&&(k.mounted=b,k.mount&&k.mount.mounts.push(b));return a},
unmount:function(a){a=c.lookupPath(a,{follow_mount:!1});if(!c.isMountpoint(a.node))throw new c.ErrnoError(28);a=a.node;var b=a.mounted,d=c.getMounts(b);Object.keys(c.nameTable).forEach(function(e){for(e=c.nameTable[e];e;){var g=e.name_next;-1!==d.indexOf(e.mount)&&c.destroyNode(e);e=g}});a.mounted=null;b=a.mount.mounts.indexOf(b);a.mount.mounts.splice(b,1)},lookup:function(a,b){return a.node_ops.lookup(a,b)},mknod:function(a,b,d){var e=c.lookupPath(a,{parent:!0}).node;a=L.basename(a);if(!a||"."===
a||".."===a)throw new c.ErrnoError(28);var g=c.mayCreate(e,a);if(g)throw new c.ErrnoError(g);if(!e.node_ops.mknod)throw new c.ErrnoError(63);return e.node_ops.mknod(e,a,b,d)},create:function(a,b){return c.mknod(a,(void 0!==b?b:438)&4095|32768,0)},mkdir:function(a,b){return c.mknod(a,(void 0!==b?b:511)&1023|16384,0)},mkdirTree:function(a,b){a=a.split("/");for(var d="",e=0;e<a.length;++e)if(a[e]){d+="/"+a[e];try{c.mkdir(d,b)}catch(g){if(20!=g.errno)throw g;}}},mkdev:function(a,b,d){"undefined"===typeof d&&
(d=b,b=438);return c.mknod(a,b|8192,d)},symlink:function(a,b){if(!Z.resolve(a))throw new c.ErrnoError(44);var d=c.lookupPath(b,{parent:!0}).node;if(!d)throw new c.ErrnoError(44);b=L.basename(b);var e=c.mayCreate(d,b);if(e)throw new c.ErrnoError(e);if(!d.node_ops.symlink)throw new c.ErrnoError(63);return d.node_ops.symlink(d,b,a)},rename:function(a,b){var d=L.dirname(a),e=L.dirname(b),g=L.basename(a),k=L.basename(b);var x=c.lookupPath(a,{parent:!0});var C=x.node;x=c.lookupPath(b,{parent:!0});x=x.node;
if(!C||!x)throw new c.ErrnoError(44);if(C.mount!==x.mount)throw new c.ErrnoError(75);var I=c.lookupNode(C,g);e=Z.relative(a,e);if("."!==e.charAt(0))throw new c.ErrnoError(28);e=Z.relative(b,d);if("."!==e.charAt(0))throw new c.ErrnoError(55);try{var M=c.lookupNode(x,k)}catch(N){}if(I!==M){d=c.isDir(I.mode);if(g=c.mayDelete(C,g,d))throw new c.ErrnoError(g);if(g=M?c.mayDelete(x,k,d):c.mayCreate(x,k))throw new c.ErrnoError(g);if(!C.node_ops.rename)throw new c.ErrnoError(63);if(c.isMountpoint(I)||M&&c.isMountpoint(M))throw new c.ErrnoError(10);
if(x!==C&&(g=c.nodePermissions(C,"w")))throw new c.ErrnoError(g);try{c.trackingDelegate.willMovePath&&c.trackingDelegate.willMovePath(a,b)}catch(N){U("FS.trackingDelegate['willMovePath']('"+a+"', '"+b+"') threw an exception: "+N.message)}c.hashRemoveNode(I);try{C.node_ops.rename(I,x,k)}catch(N){throw N;}finally{c.hashAddNode(I)}try{if(c.trackingDelegate.onMovePath)c.trackingDelegate.onMovePath(a,b)}catch(N){U("FS.trackingDelegate['onMovePath']('"+a+"', '"+b+"') threw an exception: "+N.message)}}},
rmdir:function(a){var b=c.lookupPath(a,{parent:!0}).node,d=L.basename(a),e=c.lookupNode(b,d),g=c.mayDelete(b,d,!0);if(g)throw new c.ErrnoError(g);if(!b.node_ops.rmdir)throw new c.ErrnoError(63);if(c.isMountpoint(e))throw new c.ErrnoError(10);try{c.trackingDelegate.willDeletePath&&c.trackingDelegate.willDeletePath(a)}catch(k){U("FS.trackingDelegate['willDeletePath']('"+a+"') threw an exception: "+k.message)}b.node_ops.rmdir(b,d);c.destroyNode(e);try{if(c.trackingDelegate.onDeletePath)c.trackingDelegate.onDeletePath(a)}catch(k){U("FS.trackingDelegate['onDeletePath']('"+
a+"') threw an exception: "+k.message)}},readdir:function(a){a=c.lookupPath(a,{follow:!0}).node;if(!a.node_ops.readdir)throw new c.ErrnoError(54);return a.node_ops.readdir(a)},unlink:function(a){var b=c.lookupPath(a,{parent:!0}).node,d=L.basename(a),e=c.lookupNode(b,d),g=c.mayDelete(b,d,!1);if(g)throw new c.ErrnoError(g);if(!b.node_ops.unlink)throw new c.ErrnoError(63);if(c.isMountpoint(e))throw new c.ErrnoError(10);try{c.trackingDelegate.willDeletePath&&c.trackingDelegate.willDeletePath(a)}catch(k){U("FS.trackingDelegate['willDeletePath']('"+
a+"') threw an exception: "+k.message)}b.node_ops.unlink(b,d);c.destroyNode(e);try{if(c.trackingDelegate.onDeletePath)c.trackingDelegate.onDeletePath(a)}catch(k){U("FS.trackingDelegate['onDeletePath']('"+a+"') threw an exception: "+k.message)}},readlink:function(a){a=c.lookupPath(a).node;if(!a)throw new c.ErrnoError(44);if(!a.node_ops.readlink)throw new c.ErrnoError(28);return Z.resolve(c.getPath(a.parent),a.node_ops.readlink(a))},stat:function(a,b){a=c.lookupPath(a,{follow:!b}).node;if(!a)throw new c.ErrnoError(44);
if(!a.node_ops.getattr)throw new c.ErrnoError(63);return a.node_ops.getattr(a)},lstat:function(a){return c.stat(a,!0)},chmod:function(a,b,d){a="string"===typeof a?c.lookupPath(a,{follow:!d}).node:a;if(!a.node_ops.setattr)throw new c.ErrnoError(63);a.node_ops.setattr(a,{mode:b&4095|a.mode&-4096,timestamp:Date.now()})},lchmod:function(a,b){c.chmod(a,b,!0)},fchmod:function(a,b){a=c.getStream(a);if(!a)throw new c.ErrnoError(8);c.chmod(a.node,b)},chown:function(a,b,d,e){a="string"===typeof a?c.lookupPath(a,
{follow:!e}).node:a;if(!a.node_ops.setattr)throw new c.ErrnoError(63);a.node_ops.setattr(a,{timestamp:Date.now()})},lchown:function(a,b,d){c.chown(a,b,d,!0)},fchown:function(a,b,d){a=c.getStream(a);if(!a)throw new c.ErrnoError(8);c.chown(a.node,b,d)},truncate:function(a,b){if(0>b)throw new c.ErrnoError(28);a="string"===typeof a?c.lookupPath(a,{follow:!0}).node:a;if(!a.node_ops.setattr)throw new c.ErrnoError(63);if(c.isDir(a.mode))throw new c.ErrnoError(31);if(!c.isFile(a.mode))throw new c.ErrnoError(28);
var d=c.nodePermissions(a,"w");if(d)throw new c.ErrnoError(d);a.node_ops.setattr(a,{size:b,timestamp:Date.now()})},ftruncate:function(a,b){a=c.getStream(a);if(!a)throw new c.ErrnoError(8);if(0===(a.flags&2097155))throw new c.ErrnoError(28);c.truncate(a.node,b)},utime:function(a,b,d){a=c.lookupPath(a,{follow:!0}).node;a.node_ops.setattr(a,{timestamp:Math.max(b,d)})},open:function(a,b,d,e,g){if(""===a)throw new c.ErrnoError(44);b="string"===typeof b?c.modeStringToFlags(b):b;d=b&64?("undefined"===typeof d?
438:d)&4095|32768:0;if("object"===typeof a)var k=a;else{a=L.normalize(a);try{k=c.lookupPath(a,{follow:!(b&131072)}).node}catch(C){}}var x=!1;if(b&64)if(k){if(b&128)throw new c.ErrnoError(20);}else k=c.mknod(a,d,0),x=!0;if(!k)throw new c.ErrnoError(44);c.isChrdev(k.mode)&&(b&=-513);if(b&65536&&!c.isDir(k.mode))throw new c.ErrnoError(54);if(!x&&(d=c.mayOpen(k,b)))throw new c.ErrnoError(d);b&512&&c.truncate(k,0);b&=-131713;e=c.createStream({node:k,path:c.getPath(k),flags:b,seekable:!0,position:0,stream_ops:k.stream_ops,
ungotten:[],error:!1},e,g);e.stream_ops.open&&e.stream_ops.open(e);!n.logReadFiles||b&1||(c.readFiles||(c.readFiles={}),a in c.readFiles||(c.readFiles[a]=1,U("FS.trackingDelegate error on read file: "+a)));try{c.trackingDelegate.onOpenFile&&(g=0,1!==(b&2097155)&&(g|=c.tracking.openFlags.READ),0!==(b&2097155)&&(g|=c.tracking.openFlags.WRITE),c.trackingDelegate.onOpenFile(a,g))}catch(C){U("FS.trackingDelegate['onOpenFile']('"+a+"', flags) threw an exception: "+C.message)}return e},close:function(a){if(c.isClosed(a))throw new c.ErrnoError(8);
a.getdents&&(a.getdents=null);try{a.stream_ops.close&&a.stream_ops.close(a)}catch(b){throw b;}finally{c.closeStream(a.fd)}a.fd=null},isClosed:function(a){return null===a.fd},llseek:function(a,b,d){if(c.isClosed(a))throw new c.ErrnoError(8);if(!a.seekable||!a.stream_ops.llseek)throw new c.ErrnoError(70);if(0!=d&&1!=d&&2!=d)throw new c.ErrnoError(28);a.position=a.stream_ops.llseek(a,b,d);a.ungotten=[];return a.position},read:function(a,b,d,e,g){if(0>e||0>g)throw new c.ErrnoError(28);if(c.isClosed(a))throw new c.ErrnoError(8);
if(1===(a.flags&2097155))throw new c.ErrnoError(8);if(c.isDir(a.node.mode))throw new c.ErrnoError(31);if(!a.stream_ops.read)throw new c.ErrnoError(28);var k="undefined"!==typeof g;if(!k)g=a.position;else if(!a.seekable)throw new c.ErrnoError(70);b=a.stream_ops.read(a,b,d,e,g);k||(a.position+=b);return b},write:function(a,b,d,e,g,k){if(0>e||0>g)throw new c.ErrnoError(28);if(c.isClosed(a))throw new c.ErrnoError(8);if(0===(a.flags&2097155))throw new c.ErrnoError(8);if(c.isDir(a.node.mode))throw new c.ErrnoError(31);
if(!a.stream_ops.write)throw new c.ErrnoError(28);a.seekable&&a.flags&1024&&c.llseek(a,0,2);var x="undefined"!==typeof g;if(!x)g=a.position;else if(!a.seekable)throw new c.ErrnoError(70);b=a.stream_ops.write(a,b,d,e,g,k);x||(a.position+=b);try{if(a.path&&c.trackingDelegate.onWriteToFile)c.trackingDelegate.onWriteToFile(a.path)}catch(C){U("FS.trackingDelegate['onWriteToFile']('"+a.path+"') threw an exception: "+C.message)}return b},allocate:function(a,b,d){if(c.isClosed(a))throw new c.ErrnoError(8);
if(0>b||0>=d)throw new c.ErrnoError(28);if(0===(a.flags&2097155))throw new c.ErrnoError(8);if(!c.isFile(a.node.mode)&&!c.isDir(a.node.mode))throw new c.ErrnoError(43);if(!a.stream_ops.allocate)throw new c.ErrnoError(138);a.stream_ops.allocate(a,b,d)},mmap:function(a,b,d,e,g,k){if(0!==(g&2)&&0===(k&2)&&2!==(a.flags&2097155))throw new c.ErrnoError(2);if(1===(a.flags&2097155))throw new c.ErrnoError(2);if(!a.stream_ops.mmap)throw new c.ErrnoError(43);return a.stream_ops.mmap(a,b,d,e,g,k)},msync:function(a,
b,d,e,g){return a&&a.stream_ops.msync?a.stream_ops.msync(a,b,d,e,g):0},munmap:function(a){return 0},ioctl:function(a,b,d){if(!a.stream_ops.ioctl)throw new c.ErrnoError(59);return a.stream_ops.ioctl(a,b,d)},readFile:function(a,b){b=b||{};b.flags=b.flags||"r";b.encoding=b.encoding||"binary";if("utf8"!==b.encoding&&"binary"!==b.encoding)throw Error('Invalid encoding type "'+b.encoding+'"');var d,e=c.open(a,b.flags);a=c.stat(a).size;var g=new Uint8Array(a);c.read(e,g,0,a,0);"utf8"===b.encoding?d=r(g,
0):"binary"===b.encoding&&(d=g);c.close(e);return d},writeFile:function(a,b,d){d=d||{};d.flags=d.flags||"w";a=c.open(a,d.flags,d.mode);if("string"===typeof b){var e=new Uint8Array(A(b)+1);b=p(b,e,0,e.length);c.write(a,e,0,b,void 0,d.canOwn)}else if(ArrayBuffer.isView(b))c.write(a,b,0,b.byteLength,void 0,d.canOwn);else throw Error("Unsupported data type");c.close(a)},cwd:function(){return c.currentPath},chdir:function(a){a=c.lookupPath(a,{follow:!0});if(null===a.node)throw new c.ErrnoError(44);if(!c.isDir(a.node.mode))throw new c.ErrnoError(54);
var b=c.nodePermissions(a.node,"x");if(b)throw new c.ErrnoError(b);c.currentPath=a.path},createDefaultDirectories:function(){c.mkdir("/tmp");c.mkdir("/home");c.mkdir("/home/web_user")},createDefaultDevices:function(){c.mkdir("/dev");c.registerDevice(c.makedev(1,3),{read:function(){return 0},write:function(b,d,e,g,k){return g}});c.mkdev("/dev/null",c.makedev(1,3));da.register(c.makedev(5,0),da.default_tty_ops);da.register(c.makedev(6,0),da.default_tty1_ops);c.mkdev("/dev/tty",c.makedev(5,0));c.mkdev("/dev/tty1",
c.makedev(6,0));var a=H();c.createDevice("/dev","random",a);c.createDevice("/dev","urandom",a);c.mkdir("/dev/shm");c.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){c.mkdir("/proc");c.mkdir("/proc/self");c.mkdir("/proc/self/fd");c.mount({mount:function(){var a=c.createNode("/proc/self","fd",16895,73);a.node_ops={lookup:function(b,d){var e=c.getStream(+d);if(!e)throw new c.ErrnoError(8);b={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return e.path}}};return b.parent=
b}};return a}},{},"/proc/self/fd")},createStandardStreams:function(){n.stdin?c.createDevice("/dev","stdin",n.stdin):c.symlink("/dev/tty","/dev/stdin");n.stdout?c.createDevice("/dev","stdout",null,n.stdout):c.symlink("/dev/tty","/dev/stdout");n.stderr?c.createDevice("/dev","stderr",null,n.stderr):c.symlink("/dev/tty1","/dev/stderr");c.open("/dev/stdin","r");c.open("/dev/stdout","w");c.open("/dev/stderr","w")},ensureErrnoError:function(){c.ErrnoError||(c.ErrnoError=function(a,b){this.node=b;this.setErrno=
function(d){this.errno=d};this.setErrno(a);this.message="FS error"},c.ErrnoError.prototype=Error(),c.ErrnoError.prototype.constructor=c.ErrnoError,[44].forEach(function(a){c.genericErrors[a]=new c.ErrnoError(a);c.genericErrors[a].stack="<generic error, no stack>"}))},staticInit:function(){c.ensureErrnoError();c.nameTable=Array(4096);c.mount(G,{},"/");c.createDefaultDirectories();c.createDefaultDevices();c.createSpecialDirectories();c.filesystems={MEMFS:G}},init:function(a,b,d){c.init.initialized=
!0;c.ensureErrnoError();n.stdin=a||n.stdin;n.stdout=b||n.stdout;n.stderr=d||n.stderr;c.createStandardStreams()},quit:function(){c.init.initialized=!1;var a=n._fflush;a&&a(0);for(a=0;a<c.streams.length;a++){var b=c.streams[a];b&&c.close(b)}},getMode:function(a,b){var d=0;a&&(d|=365);b&&(d|=146);return d},findObject:function(a,b){a=c.analyzePath(a,b);if(a.exists)return a.object;J(a.error);return null},analyzePath:function(a,b){try{var d=c.lookupPath(a,{follow:!b});a=d.path}catch(g){}var e={isRoot:!1,
exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{d=c.lookupPath(a,{parent:!0}),e.parentExists=!0,e.parentPath=d.path,e.parentObject=d.node,e.name=L.basename(a),d=c.lookupPath(a,{follow:!b}),e.exists=!0,e.path=d.path,e.object=d.node,e.name=d.node.name,e.isRoot="/"===d.path}catch(g){e.error=g.errno}return e},createPath:function(a,b,d,e){a="string"===typeof a?a:c.getPath(a);for(b=b.split("/").reverse();b.length;)if(d=b.pop()){var g=L.join2(a,d);
try{c.mkdir(g)}catch(k){}a=g}return g},createFile:function(a,b,d,e,g){a=L.join2("string"===typeof a?a:c.getPath(a),b);e=c.getMode(e,g);return c.create(a,e)},createDataFile:function(a,b,d,e,g,k){a=b?L.join2("string"===typeof a?a:c.getPath(a),b):a;e=c.getMode(e,g);g=c.create(a,e);if(d){if("string"===typeof d){a=Array(d.length);b=0;for(var x=d.length;b<x;++b)a[b]=d.charCodeAt(b);d=a}c.chmod(g,e|146);a=c.open(g,"w");c.write(a,d,0,d.length,0,k);c.close(a);c.chmod(g,e)}return g},createDevice:function(a,
b,d,e){a=L.join2("string"===typeof a?a:c.getPath(a),b);b=c.getMode(!!d,!!e);c.createDevice.major||(c.createDevice.major=64);var g=c.makedev(c.createDevice.major++,0);c.registerDevice(g,{open:function(k){k.seekable=!1},close:function(k){e&&e.buffer&&e.buffer.length&&e(10)},read:function(k,x,C,I,M){for(var N=M=0;N<I;N++){try{var Q=d()}catch(T){throw new c.ErrnoError(29);}if(void 0===Q&&0===M)throw new c.ErrnoError(6);if(null===Q||void 0===Q)break;M++;x[C+N]=Q}M&&(k.node.timestamp=Date.now());return M},
write:function(k,x,C,I,M){for(M=0;M<I;M++)try{e(x[C+M])}catch(N){throw new c.ErrnoError(29);}I&&(k.node.timestamp=Date.now());return M}});return c.mkdev(a,b,g)},forceLoadFile:function(a){if(a.isDevice||a.isFolder||a.link||a.contents)return!0;var b=!0;if("undefined"!==typeof XMLHttpRequest)throw Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(Da)try{a.contents=
P(Da(a.url),!0),a.usedBytes=a.contents.length}catch(d){b=!1}else throw Error("Cannot load without read() or XMLHttpRequest.");b||J(29);return b},createLazyFile:function(a,b,d,e,g){if("undefined"!==typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";d={isDevice:!1,url:d};var k=c.createFile(a,b,d,e,g);d.contents?k.contents=d.contents:d.url&&(k.contents=null,k.url=d.url);Object.defineProperties(k,{usedBytes:{get:function(){return this.contents.length}}});
var x={};Object.keys(k.stream_ops).forEach(function(C){var I=k.stream_ops[C];x[C]=function(){if(!c.forceLoadFile(k))throw new c.ErrnoError(29);return I.apply(null,arguments)}});x.read=function(C,I,M,N,Q){if(!c.forceLoadFile(k))throw new c.ErrnoError(29);C=C.node.contents;if(Q>=C.length)return 0;N=Math.min(C.length-Q,N);if(C.slice)for(var T=0;T<N;T++)I[M+T]=C[Q+T];else for(T=0;T<N;T++)I[M+T]=C.get(Q+T);return N};k.stream_ops=x;return k},createPreloadedFile:function(a,b,d,e,g,k,x,C,I,M){function N(na){function Fa(oa){M&&
M();C||c.createDataFile(a,b,oa,e,g,I);k&&k();E(T)}var sa=!1;n.preloadPlugins.forEach(function(oa){!sa&&oa.canHandle(Q)&&(oa.handle(na,Q,Fa,function(){x&&x();E(T)}),sa=!0)});sa||Fa(na)}Browser.init();var Q=b?Z.resolve(L.join2(a,b)):a,T="cp "+Q;F(T);"string"==typeof d?Browser.asyncLoad(d,function(na){N(na)},x):N(d)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,
DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(a,b,d){b=b||function(){};d=d||function(){};var e=c.indexedDB();try{var g=e.open(c.DB_NAME(),c.DB_VERSION)}catch(k){return d(k)}g.onupgradeneeded=function(){ra("creating db");g.result.createObjectStore(c.DB_STORE_NAME)};g.onsuccess=function(){var k=g.result.transaction([c.DB_STORE_NAME],"readwrite"),x=k.objectStore(c.DB_STORE_NAME),C=0,I=0,M=a.length;a.forEach(function(N){N=x.put(c.analyzePath(N).object.contents,N);N.onsuccess=function(){C++;C+I==M&&
(0==I?b():d())};N.onerror=function(){I++;C+I==M&&(0==I?b():d())}});k.onerror=d};g.onerror=d},loadFilesFromDB:function(a,b,d){b=b||function(){};d=d||function(){};var e=c.indexedDB();try{var g=e.open(c.DB_NAME(),c.DB_VERSION)}catch(k){return d(k)}g.onupgradeneeded=d;g.onsuccess=function(){var k=g.result;try{var x=k.transaction([c.DB_STORE_NAME],"readonly")}catch(Q){d(Q);return}var C=x.objectStore(c.DB_STORE_NAME),I=0,M=0,N=a.length;a.forEach(function(Q){var T=C.get(Q);T.onsuccess=function(){c.analyzePath(Q).exists&&
c.unlink(Q);c.createDataFile(L.dirname(Q),L.basename(Q),T.result,!0,!0,!0);I++;I+M==N&&(0==M?b():d())};T.onerror=function(){M++;I+M==N&&(0==M?b():d())}});x.onerror=d};g.onerror=d}},R={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt:function(a,b){if("/"!==b[0]){if(-100===a)a=c.cwd();else{a=c.getStream(a);if(!a)throw new c.ErrnoError(8);a=a.path}b=L.join2(a,b)}return b},doStat:function(a,b,d){try{var e=a(b)}catch(g){if(g&&g.node&&L.normalize(b)!==L.normalize(c.getPath(g.node)))return-54;throw g;
}K[d>>2]=e.dev;K[d+4>>2]=0;K[d+8>>2]=e.ino;K[d+12>>2]=e.mode;K[d+16>>2]=e.nlink;K[d+20>>2]=e.uid;K[d+24>>2]=e.gid;K[d+28>>2]=e.rdev;K[d+32>>2]=0;Y=[e.size>>>0,(S=e.size,1<=+Math.abs(S)?0<S?(Math.min(+Math.floor(S/4294967296),4294967295)|0)>>>0:~~+Math.ceil((S-+(~~S>>>0))/4294967296)>>>0:0)];K[d+40>>2]=Y[0];K[d+44>>2]=Y[1];K[d+48>>2]=4096;K[d+52>>2]=e.blocks;K[d+56>>2]=e.atime.getTime()/1E3|0;K[d+60>>2]=0;K[d+64>>2]=e.mtime.getTime()/1E3|0;K[d+68>>2]=0;K[d+72>>2]=e.ctime.getTime()/1E3|0;K[d+76>>2]=
0;Y=[e.ino>>>0,(S=e.ino,1<=+Math.abs(S)?0<S?(Math.min(+Math.floor(S/4294967296),4294967295)|0)>>>0:~~+Math.ceil((S-+(~~S>>>0))/4294967296)>>>0:0)];K[d+80>>2]=Y[0];K[d+84>>2]=Y[1];return 0},doMsync:function(a,b,d,e,g){a=ha.slice(a,a+d);c.msync(b,a,g,d,e)},doMkdir:function(a,b){a=L.normalize(a);"/"===a[a.length-1]&&(a=a.substr(0,a.length-1));c.mkdir(a,b,0);return 0},doMknod:function(a,b,d){switch(b&61440){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}c.mknod(a,b,d);return 0},
doReadlink:function(a,b,d){if(0>=d)return-28;a=c.readlink(a);var e=Math.min(d,A(a)),g=ba[b+e];p(a,ha,b,d+1);ba[b+e]=g;return e},doAccess:function(a,b){if(b&-8)return-28;a=c.lookupPath(a,{follow:!0}).node;if(!a)return-44;var d="";b&4&&(d+="r");b&2&&(d+="w");b&1&&(d+="x");return d&&c.nodePermissions(a,d)?-2:0},doDup:function(a,b,d){var e=c.getStream(d);e&&c.close(e);return c.open(a,b,0,d,d).fd},doReadv:function(a,b,d,e){for(var g=0,k=0;k<d;k++){var x=K[b+(8*k+4)>>2],C=c.read(a,ba,K[b+8*k>>2],x,e);if(0>
C)return-1;g+=C;if(C<x)break}return g},doWritev:function(a,b,d,e){for(var g=0,k=0;k<d;k++){var x=c.write(a,ba,K[b+8*k>>2],K[b+(8*k+4)>>2],e);if(0>x)return-1;g+=x}return g},varargs:void 0,get:function(){R.varargs+=4;return K[R.varargs-4>>2]},getStr:function(a){return h(a)},getStreamFromFD:function(a){a=c.getStream(a);if(!a)throw new c.ErrnoError(8);return a},get64:function(a,b){return a}};W=function(a,b,d,e){a||(a=this);this.parent=a;this.mount=a.mount;this.mounted=null;this.id=c.nextInode++;this.name=
b;this.mode=d;this.node_ops={};this.stream_ops={};this.rdev=e};Object.defineProperties(W.prototype,{read:{get:function(){return 365===(this.mode&365)},set:function(a){a?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146===(this.mode&146)},set:function(a){a?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return c.isDir(this.mode)}},isDevice:{get:function(){return c.isChrdev(this.mode)}}});c.FSNode=W;c.staticInit();n.FS_createPath=c.createPath;n.FS_createDataFile=c.createDataFile;
n.FS_createPreloadedFile=c.createPreloadedFile;n.FS_createLazyFile=c.createLazyFile;n.FS_createDevice=c.createDevice;n.FS_unlink=c.unlink;za.push({func:function(){Ga()}});var Ia={c:function(a,b,d){R.varargs=d;try{var e=R.getStreamFromFD(a);switch(b){case 0:var g=R.get();return 0>g?-28:c.open(e.path,e.flags,0,g).fd;case 1:case 2:return 0;case 3:return e.flags;case 4:return g=R.get(),e.flags|=g,0;case 12:return g=R.get(),ua[g+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return J(28),
-1;default:return-28}}catch(k){return"undefined"!==typeof c&&k instanceof c.ErrnoError||D(k),-k.errno}},i:function(a,b,d){R.varargs=d;try{var e=R.getStreamFromFD(a);switch(b){case 21509:case 21505:return e.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return e.tty?0:-59;case 21519:if(!e.tty)return-59;var g=R.get();return K[g>>2]=0;case 21520:return e.tty?-28:-59;case 21531:return g=R.get(),c.ioctl(e,b,g);case 21523:return e.tty?0:-59;case 21524:return e.tty?0:-59;default:D("bad ioctl syscall "+
b)}}catch(k){return"undefined"!==typeof c&&k instanceof c.ErrnoError||D(k),-k.errno}},j:function(a,b,d){R.varargs=d;try{var e=R.getStr(a),g=R.get();return c.open(e,b,g).fd}catch(k){return"undefined"!==typeof c&&k instanceof c.ErrnoError||D(k),-k.errno}},f:function(a,b,d){ha.copyWithin(a,b,b+d)},g:function(a){a>>>=0;var b=ha.length;if(2147483648<a)return!1;for(var d=1;4>=d;d*=2){var e=b*(1+.2/d);e=Math.min(e,a+100663296);var g=Math,k=g.min;e=Math.max(16777216,a,e);0<e%65536&&(e+=65536-e%65536);g=k.call(g,
2147483648,e);a:{try{la.grow(g-ia.byteLength+65535>>>16);B(la.buffer);var x=1;break a}catch(C){}x=void 0}if(x)return!0}return!1},d:function(a){try{var b=R.getStreamFromFD(a);c.close(b);return 0}catch(d){return"undefined"!==typeof c&&d instanceof c.ErrnoError||D(d),d.errno}},h:function(a,b,d,e){try{var g=R.getStreamFromFD(a),k=R.doReadv(g,b,d);K[e>>2]=k;return 0}catch(x){return"undefined"!==typeof c&&x instanceof c.ErrnoError||D(x),x.errno}},e:function(a,b,d,e,g){try{var k=R.getStreamFromFD(a);a=4294967296*
d+(b>>>0);if(-9007199254740992>=a||9007199254740992<=a)return-61;c.llseek(k,a,e);Y=[k.position>>>0,(S=k.position,1<=+Math.abs(S)?0<S?(Math.min(+Math.floor(S/4294967296),4294967295)|0)>>>0:~~+Math.ceil((S-+(~~S>>>0))/4294967296)>>>0:0)];K[g>>2]=Y[0];K[g+4>>2]=Y[1];k.getdents&&0===a&&0===e&&(k.getdents=null);return 0}catch(x){return"undefined"!==typeof c&&x instanceof c.ErrnoError||D(x),x.errno}},b:function(a,b,d,e){try{var g=R.getStreamFromFD(a),k=R.doWritev(g,b,d);K[e>>2]=k;return 0}catch(x){return"undefined"!==
typeof c&&x instanceof c.ErrnoError||D(x),x.errno}},a:la};(function(){function a(g,k){n.asm=g.exports;qa=n.asm.k;E("wasm-instantiate")}function b(g){a(g.instance)}function d(g){return t().then(function(k){return WebAssembly.instantiate(k,e)}).then(g,function(k){U("failed to asynchronously prepare wasm: "+k);D(k)})}var e={a:Ia};F("wasm-instantiate");if(n.instantiateWasm)try{return n.instantiateWasm(e,a)}catch(g){return U("Module.instantiateWasm callback failed with error: "+g),!1}(function(){if(ka||
"function"!==typeof WebAssembly.instantiateStreaming||O(ca,"data:application/octet-stream;base64,")||"function"!==typeof fetch)return d(b);fetch(ca,{credentials:"same-origin"}).then(function(g){return WebAssembly.instantiateStreaming(g,e).then(b,function(k){U("wasm streaming compile failed: "+k);U("falling back to ArrayBuffer instantiation");return d(b)})})})();return{}})();var Ga=n.___wasm_call_ctors=function(){return(Ga=n.___wasm_call_ctors=n.asm.l).apply(null,arguments)},Ea=n._malloc=function(){return(Ea=
n._malloc=n.asm.m).apply(null,arguments)};n._free=function(){return(n._free=n.asm.n).apply(null,arguments)};n._mid_song_start=function(){return(n._mid_song_start=n.asm.o).apply(null,arguments)};n._mid_song_seek=function(){return(n._mid_song_seek=n.asm.p).apply(null,arguments)};n._mid_song_get_total_time=function(){return(n._mid_song_get_total_time=n.asm.q).apply(null,arguments)};n._mid_song_get_time=function(){return(n._mid_song_get_time=n.asm.r).apply(null,arguments)};n._mid_song_read_wave=function(){return(n._mid_song_read_wave=
n.asm.s).apply(null,arguments)};n._mid_istream_open_mem=function(){return(n._mid_istream_open_mem=n.asm.t).apply(null,arguments)};n._mid_istream_close=function(){return(n._mid_istream_close=n.asm.u).apply(null,arguments)};n._mid_exit=function(){return(n._mid_exit=n.asm.v).apply(null,arguments)};n._mid_init=function(){return(n._mid_init=n.asm.w).apply(null,arguments)};n._mid_song_load=function(){return(n._mid_song_load=n.asm.x).apply(null,arguments)};n._mid_song_free=function(){return(n._mid_song_free=
n.asm.y).apply(null,arguments)};n._mid_alloc_options=function(){return(n._mid_alloc_options=n.asm.z).apply(null,arguments)};n._mid_get_load_request_count=function(){return(n._mid_get_load_request_count=n.asm.A).apply(null,arguments)};n._mid_get_load_request=function(){return(n._mid_get_load_request=n.asm.B).apply(null,arguments)};var ya=n.___errno_location=function(){return(ya=n.___errno_location=n.asm.C).apply(null,arguments)};n.UTF8ToString=h;n.addRunDependency=F;n.removeRunDependency=E;n.FS_createPath=
c.createPath;n.FS_createDataFile=c.createDataFile;n.FS_createPreloadedFile=c.createPreloadedFile;n.FS_createLazyFile=c.createLazyFile;n.FS_createDevice=c.createDevice;n.FS_unlink=c.unlink;n.FS=c;var ma;ja=function b(){ma||X();ma||(ja=b)};n.run=X;if(n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);0<n.preInit.length;)n.preInit.pop()();X();return z.ready}}();"object"===typeof q&&"object"===typeof m?m.exports=u:"function"===typeof define&&define.amd?define([],function(){return u}):
"object"===typeof q&&(q.LibTimidity=u)},{}],timidity:[function(f,m,q){q=f("debug");var u=f("events").EventEmitter,l=f("./libtimidity"),z=q("timidity"),w=q("timidity:verbose"),r="undefined"!==typeof window&&(window.AudioContext||window.webkitAudioContext);f=function(h){h=void 0===h?"/":h;var p=u.call(this)||this;p.destroyed=!1;h.endsWith("/")||(h+="/");p._baseUrl=(new URL(h,window.location.origin)).href;p._ready=!1;p._playing=!1;p._pendingFetches={};p._songPtr=0;p._bufferPtr=0;p._array=new Int16Array(32768);
p._currentUrlOrBuf=null;p._interval=null;p._startInterval=p._startInterval.bind(p);p._stopInterval=p._stopInterval.bind(p);p._audioContext=new r;p._node=p._audioContext.createScriptProcessor(16384,0,2);p._onAudioProcess=p._onAudioProcess.bind(p);p._node.addEventListener("audioprocess",p._onAudioProcess);p._node.connect(p._audioContext.destination);l({locateFile:function(A){return(new URL(A,p._baseUrl)).href}}).then(function(A){p._lib=A;p._onLibReady()});return p};$jscomp.inherits(f,u);f.prototype._onLibReady=
function(){this._lib.FS.writeFile("/timidity.cfg","\ndrumset 0\n\n 25\tDrum_000/025_Snare_Roll.pat \n 26\tDrum_000/026_Snap.pat \n 27\tDrum_000/027_High_Q.pat \n 31\tDrum_000/031_Sticks.pat \n 32\tDrum_000/032_Square_Click.pat \n 33\tDrum_000/033_Metronome_Click.pat \n 34\tDrum_000/034_Metronome_Bell.pat \n 35\tDrum_000/035_Kick_1.pat amp=100\n 36\tDrum_000/036_Kick_2.pat amp=100\n 37\tDrum_000/037_Stick_Rim.pat \n 38\tDrum_000/038_Snare_1.pat \n 39\tDrum_000/039_Clap_Hand.pat amp=100\n 40\tDrum_000/040_Snare_2.pat \n 41\tDrum_000/041_Tom_Low_2.pat amp=100\n 42\tDrum_000/042_Hi-Hat_Closed.pat \n 43\tDrum_000/043_Tom_Low_1.pat amp=100\n 44\tDrum_000/044_Hi-Hat_Pedal.pat \n 45\tDrum_000/045_Tom_Mid_2.pat amp=100\n 46\tDrum_000/046_Hi-Hat_Open.pat \n 47\tDrum_000/047_Tom_Mid_1.pat amp=100\n 48\tDrum_000/048_Tom_High_2.pat amp=100\n 49\tDrum_000/049_Cymbal_Crash_1.pat \n 50\tDrum_000/050_Tom_High_1.pat amp=100\n 51\tDrum_000/051_Cymbal_Ride_1.pat \n 52\tDrum_000/052_Cymbal_Chinese.pat \n 53\tDrum_000/053_Cymbal_Ride_Bell.pat amp=100\n 54\tDrum_000/054_Tombourine.pat \n 55\tDrum_000/055_Cymbal_Splash.pat \n 56\tDrum_000/056_Cow_Bell.pat \n 57\tDrum_000/057_Cymbal_Crash_2.pat \n 58\tDrum_000/058_Vibra-Slap.pat \n 59\tDrum_000/059_Cymbal_Ride_2.pat \n 60\tDrum_000/060_Bongo_High.pat \n 61\tDrum_000/061_Bongo_Low.pat \n 62\tDrum_000/062_Conga_High_1_Mute.pat \n 63\tDrum_000/063_Conga_High_2_Open.pat \n 64\tDrum_000/064_Conga_Low.pat \n 65\tDrum_000/065_Timbale_High.pat \n 66\tDrum_000/066_Timbale_Low.pat \n 67\tDrum_000/067_Agogo_High.pat \n 68\tDrum_000/068_Agogo_Low.pat \n 69\tDrum_000/069_Cabasa.pat amp=100\n 70\tDrum_000/070_Maracas.pat \n 71\tDrum_000/071_Whistle_1_High_Short.pat \n 72\tDrum_000/072_Whistle_2_Low_Long.pat \n 73\tDrum_000/073_Guiro_1_Short.pat \n 74\tDrum_000/074_Guiro_2_Long.pat \n 75\tDrum_000/075_Claves.pat amp=100\n 76\tDrum_000/076_Wood_Block_1_High.pat \n 77\tDrum_000/077_Wood_Block_2_Low.pat \n 78\tDrum_000/078_Cuica_1_Mute.pat amp=100\n 79\tDrum_000/079_Cuica_2_Open.pat amp=100\n 80\tDrum_000/080_Triangle_1_Mute.pat \n 81\tDrum_000/081_Triangle_2_Open.pat \n 82\tDrum_000/082_Shaker.pat \n 84\tDrum_000/084_Belltree.pat \n\nbank 0\n\n 0\tTone_000/000_Acoustic_Grand_Piano.pat amp=120 pan=center\n 1\tTone_000/001_Acoustic_Brite_Piano.pat \n 2\tTone_000/002_Electric_Grand_Piano.pat \n 4\tTone_000/004_Electric_Piano_1_Rhodes.pat \n 5\tTone_000/005_Electric_Piano_2_Chorused_Yamaha_DX.pat \n 6\tTone_000/006_Harpsichord.pat \n 7\tTone_000/007_Clavinet.pat \n 8\tTone_000/008_Celesta.pat \n 9\tTone_000/009_Glockenspiel.pat \n 13\tTone_000/013_Xylophone.pat \n 14\tTone_000/014_Tubular_Bells.pat \n 15\tTone_000/015_Dulcimer.pat \n 16\tTone_000/016_Hammond_Organ.pat \n 19\tTone_000/019_Church_Organ.pat \n 21\tTone_000/021_Accordion.pat \n 23\tTone_000/023_Tango_Accordion.pat \n 24\tTone_000/024_Nylon_Guitar.pat \n 25\tTone_000/025_Steel_Guitar.pat \n 26\tTone_000/026_Jazz_Guitar.pat \n 27\tTone_000/027_Clean_Electric_Guitar.pat \n 28\tTone_000/028_Muted_Electric_Guitar.pat \n 29\tTone_000/029_Overdriven_Guitar.pat \n 30\tTone_000/030_Distortion_Guitar.pat \n 32\tTone_000/032_Acoustic_Bass.pat \n 33\tTone_000/033_Finger_Bass.pat \n 34\tTone_000/034_Pick_Bass.pat \n 35\tTone_000/035_Fretless_Bass.pat \n 36\tTone_000/036_Slap_Bass_1.pat \n 37\tTone_000/037_Slap_Bass_2.pat \n 38\tTone_000/038_Synth_Bass_1.pat \n 40\tTone_000/040_Violin.pat \n 42\tTone_000/042_Cello.pat \n 44\tTone_000/044_Tremolo_Strings.pat \n 45\tTone_000/045_Pizzicato_Strings.pat \n 46\tTone_000/046_Harp.pat \n 47\tTone_000/047_Timpani.pat \n 48\tTone_000/048_String_Ensemble_1_Marcato.pat \n 53\tTone_000/053_Voice_Oohs.pat \n 56\tTone_000/056_Trumpet.pat \n 57\tTone_000/057_Trombone.pat \n 58\tTone_000/058_Tuba.pat \n 59\tTone_000/059_Muted_Trumpet.pat \n 60\tTone_000/060_French_Horn.pat \n 61\tTone_000/061_Brass_Section.pat \n 64\tTone_000/064_Soprano_Sax.pat \n 65\tTone_000/065_Alto_Sax.pat \n 66\tTone_000/066_Tenor_Sax.pat \n 67\tTone_000/067_Baritone_Sax.pat \n 68\tTone_000/068_Oboe.pat \n 69\tTone_000/069_English_Horn.pat \n 70\tTone_000/070_Bassoon.pat \n 71\tTone_000/071_Clarinet.pat \n 72\tTone_000/072_Piccolo.pat \n 73\tTone_000/073_Flute.pat \n 74\tTone_000/074_Recorder.pat \n 75\tTone_000/075_Pan_Flute.pat \n 76\tTone_000/076_Bottle_Blow.pat \n 79\tTone_000/079_Ocarina.pat \n 80\tTone_000/080_Square_Wave.pat \n 84\tTone_000/084_Charang.pat \n 88\tTone_000/088_New_Age.pat \n 94\tTone_000/094_Halo_Pad.pat \n 95\tTone_000/095_Sweep_Pad.pat \n 98\tTone_000/098_Crystal.pat \n 101\tTone_000/101_Goblins--Unicorn.pat \n 102\tTone_000/102_Echo_Voice.pat \n 104\tTone_000/104_Sitar.pat \n 114\tTone_000/114_Steel_Drums.pat \n 115\tTone_000/115_Wood_Block.pat \n 120\tTone_000/120_Guitar_Fret_Noise.pat \n 122\tTone_000/122_Seashore.pat \n 125\tTone_000/125_Helicopter.pat \n\n");
if(0!==this._lib._mid_init("/timidity.cfg"))return this._destroy(Error("Failed to initialize libtimidity"));this._bufferPtr=this._lib._malloc(65536);w("Initialized libtimidity");this._ready=!0;this.emit("_ready")};f.prototype.load=function(h){var p=this,A,B,F,E;return $jscomp.asyncExecutePromiseGeneratorProgram(function(D){switch(D.nextAddress){case 1:z("load %o",h);if(p.destroyed)throw Error("load() called after destroy()");p._audioContext.resume();p._songPtr&&p._destroySong();p.emit("unstarted");
p._stopInterval();if(!p._ready)return D.return(p.once("_ready",function(){return p.load(h)}));p.emit("buffering");p._currentUrlOrBuf=h;if("string"!==typeof h){if(h instanceof Uint8Array)A=h;else throw Error("load() expects a `string` or `Uint8Array` argument");D.jumpTo(2);break}return D.yield(p._fetch(new URL(h,p._baseUrl)),3);case 3:if(A=D.yieldResult,p._currentUrlOrBuf!==h)return D.return();case 2:B=p._loadSong(A);F=p._lib._mid_get_load_request_count(B);if(!(0<F)){D.jumpTo(4);break}E=p._getMissingInstruments(B,
F);w("Fetching instruments: %o",E);return D.yield(Promise.all(E.map(function(O){return p._fetchInstrument(O)})),5);case 5:if(p._currentUrlOrBuf!==h)return D.return();p._lib._mid_song_free(B);B=p._loadSong(A);F=p._lib._mid_get_load_request_count(B);0<F&&(E=p._getMissingInstruments(B,F),z("Playing with missing instruments: %o",E));case 4:p._songPtr=B,p._lib._mid_song_start(p._songPtr),w("Song and instruments are loaded"),D.jumpToEnd()}})};f.prototype._getMissingInstruments=function(h,p){for(var A=[],
B=0;B<p;B++){var F=this._lib._mid_get_load_request(h,B);F=this._lib.UTF8ToString(F);A.push(F)}return A};f.prototype._loadSong=function(h){var p=this._lib._mid_alloc_options(44100,32784,2,16384),A=this._lib._malloc(h.byteLength);this._lib.HEAPU8.set(h,A);h=this._lib._mid_istream_open_mem(A,h.byteLength);var B=this._lib._mid_song_load(h,p);this._lib._mid_istream_close(h);this._lib._free(p);this._lib._free(A);return 0===B?this._destroy(Error("Failed to load MIDI file")):B};f.prototype._fetchInstrument=
function(h){var p=this,A,B,F;return $jscomp.asyncExecutePromiseGeneratorProgram(function(E){if(1==E.nextAddress){if(p._pendingFetches[h])return E.return(p._pendingFetches[h]);A=new URL(h,p._baseUrl);B=p._fetch(A);p._pendingFetches[h]=B;return E.yield(B,2)}F=E.yieldResult;p._writeInstrumentFile(h,F);delete p._pendingFetches[h];return E.return(F)})};f.prototype._writeInstrumentFile=function(h,p){var A=h.split("/").slice(0,-1).join("/");this._mkdirp(A);this._lib.FS.writeFile(h,p,{encoding:"binary"})};
f.prototype._mkdirp=function(h){h=h.split("/");for(var p="/",A=0;A<h.length;A++){var B=h[A];try{this._lib.FS.mkdir(""+p+B)}catch(F){}p+=B+"/"}};f.prototype._fetch=function(h){var p,A,B,F;return $jscomp.asyncExecutePromiseGeneratorProgram(function(E){if(1==E.nextAddress)return p={mode:"cors",credentials:"same-origin"},E.yield(window.fetch(h,p),2);if(3!=E.nextAddress){A=E.yieldResult;if(200!==A.status)throw Error("Could not load "+h);return E.yield(A.arrayBuffer(),3)}B=E.yieldResult;F=new Uint8Array(B);
return E.return(F)})};f.prototype.play=function(){z("play");if(this.destroyed)throw Error("play() called after destroy()");this._audioContext.resume();this._playing=!0;this._ready&&!this._currentUrlOrBuf&&(this.emit("playing"),this._startInterval())};f.prototype._onAudioProcess=function(h){var p=this._songPtr&&this._playing?this._readMidiData():0;0<p&&this._currentUrlOrBuf&&(this._currentUrlOrBuf=null,this.emit("playing"),this._startInterval());var A=h.outputBuffer.getChannelData(0);h=h.outputBuffer.getChannelData(1);
for(var B=0;B<p;B++)A[B]=this._array[2*B]/32767,h[B]=this._array[2*B+1]/32767;for(B=p;16384>B;B++)A[B]=0,h[B]=0;this._songPtr&&this._playing&&0===p&&(this.seek(0),this.pause(),this._lib._mid_song_start(this._songPtr),this.emit("ended"))};f.prototype._readMidiData=function(){var h=this._lib._mid_song_read_wave(this._songPtr,this._bufferPtr,65536),p=h/4;if(0===p)return 0;this._array.set(this._lib.HEAP16.subarray(this._bufferPtr/2,(this._bufferPtr+h)/2));return p};f.prototype.pause=function(){z("pause");
if(this.destroyed)throw Error("pause() called after destroy()");this._playing=!1;this._stopInterval();this.emit("paused")};f.prototype.seek=function(h){z("seek %d",h);if(this.destroyed)throw Error("seek() called after destroy()");this._songPtr&&(this._lib._mid_song_seek(this._songPtr,Math.floor(1E3*h)),this._onTimeupdate())};f.prototype._onTimeupdate=function(){this.emit("timeupdate",this.currentTime)};f.prototype._startInterval=function(){var h=this;this._onTimeupdate();this._interval=setInterval(function(){return h._onTimeupdate()},
1E3)};f.prototype._stopInterval=function(){this._onTimeupdate();clearInterval(this._interval);this._interval=null};f.prototype.destroy=function(){z("destroy");if(this.destroyed)throw Error("destroy() called after destroy()");this._destroy()};f.prototype._destroy=function(h){this.destroyed||(this.destroyed=!0,this._stopInterval(),this._array=null,this._songPtr&&this._destroySong(),this._bufferPtr&&(this._lib._free(this._bufferPtr),this._bufferPtr=0),this._node&&(this._node.disconnect(),this._node.removeEventListener("audioprocess",
this._onAudioProcess)),this._audioContext&&this._audioContext.close(),h&&this.emit("error",h),z("destroyed (err %o)",h))};f.prototype._destroySong=function(){this._lib._mid_song_free(this._songPtr);this._songPtr=0};$jscomp.global.Object.defineProperties(f.prototype,{currentTime:{configurable:!0,enumerable:!0,get:function(){return this.destroyed||!this._songPtr?0:this._lib._mid_song_get_time(this._songPtr)/1E3}},duration:{configurable:!0,enumerable:!0,get:function(){return this.destroyed||!this._songPtr?
1:this._lib._mid_song_get_total_time(this._songPtr)/1E3}}});m.exports=f},{"./libtimidity":6,debug:3,events:1}]},{},[]);


/**
 ____        _ _    ___  ____    _  _    ___
/ ___|  __ _| | |_ / _ \/ ___|  | || |  / _ \
\___ \ / _` | | __| | | \___ \  | || |_| | | |
 ___) | (_| | | |_| |_| |___) | |__   _| |_| |
|____/ \__,_|_|\__|\___/|____/     |_|(_)___/

SaltOS: Framework to develop Rich Internet Applications
Copyright (C) 2007-2023 by Josep Sanz Campderrs
More information in https://www.saltos.org or info@saltos.org

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.
*/

"use strict";

/**
 * Main object
 *
 * This object contains all SaltOS code
 */
var saltos = saltos || {};

/**
 * HTML builder
 *
 * This function allow to create an DOM fragment from a string that contains html code, can
 * work with one or two arguments:
 *
 * @type => the type used when create the container element
 * @html => contains the html code that you want to use as template
 *
 * The main use is only using the html argument and omiting the type, in this case, the
 * type used will be a div, but if you want to create a fragment of object, for example
 * as tr or td, you need to specify that the coontainer type used to create the objects
 * must to be a table or tr, is you don't specify the type, the div container creates
 * a breaked portion of the element and they don't works as expected because the DOM
 * builded is bad, you can see this problem in action when work with tables and try to
 * create separate portions of the table as trs or tds.
 */
saltos.html = function () {
    var type = "div";
    var html = "";
    if (arguments.length == 1) {
        html = arguments[0];
    }
    if (arguments.length == 2) {
        type = arguments[0];
        html = arguments[1];
    }
    var div = document.createElement(type);
    div.innerHTML = html.trim();
    div = saltos.optimize(div);
    return div;
};

/**
 * Optimizer object
 *
 * This function checks an object to see if only contains one children and
 * in this case, returns directly the children instead of the original object,
 * otherwise nothing to do and returns the original object
 *
 * @obj => the object to check and optimize
 */
saltos.optimize = function (obj) {
    if (obj.children.length == 1) {
        return obj.firstElementChild;
    }
    return obj;
}


"use strict"

// VARIABLES GLOBALS
var _random_hash = "";
var _pdfViewer = null;
var _midi = {};

(function () {

    // PINTAR MENU
    _menu();

    // PROGRAMAR HASHCHANGE
    window.onhashchange = function () {
        // AGAFAR EL HASH ACTUAL
        var hash = decodeURI(window.location.hash);
        if (hash.substr(0,1) == "#") {
            hash = hash.substr(1);
        }
        if (hash.substr(0,7) != "search=" && !data.songs.hasOwnProperty(hash)) {
            // SINO, MIRAR SI HAY PARAMETRO HASH
            if (typeof URLSearchParams == "function") {
                var params = new URLSearchParams(window.location.search);
                if (params.has("hash")) {
                    hash = decodeURI(params.get("hash"));
                }
            }
            if (hash.substr(0,7) != "search=" && !data.songs.hasOwnProperty(hash)) {
                // SINO, MIRAR EL NOM DEL FITXER
                hash = decodeURI(window.location.href.split("/").pop().split(".")[0]);
                if (hash.substr(0,7) != "search=" && !data.songs.hasOwnProperty(hash)) {
                    // SINO, FER SERVIR COOKIE
                    hash = decodeURI(docCookies.getItem("hash"));
                    if (typeof(hash) == "undefined") {
                        hash = "";
                    }
                    if (hash.substr(0,7) != "search=" && !data.songs.hasOwnProperty(hash)) {
                        // SINO, FER SERVIR EL PRIMER HASH
                        hash = _random_hash;
                    }
                    // EL HISTORY NOMES S'ACTUALITZA EN CAS DE QUE SIGUI VIA COOKIE O VIA FIRST
                    history.replaceState(null,null,"#" + hash);
                }
            }
        }
        // ACTUALITZAR COOKIE PER MES ENDAVANT
        docCookies.setItem("hash", hash, 365 * 86400, "/");
        // DESACTIVAR ANTIGA SELECCIO
        document.querySelectorAll("#menu .collapse.show").forEach(function (_this) {
            new bootstrap.Collapse(_this);
        });
        document.querySelectorAll("#menu a.active").forEach(function (_this) {
            _this.classList.remove("active");
        });
        // AMAGAR CERCADOR I MENU
        document.querySelector("#result").classList.add("d-none");
        document.querySelectorAll("#sidebarMenu.show").forEach(function (_this) {
            new bootstrap.Collapse(_this);
        });
        // CHECK
        if (hash.substr(0,7) != "search=") {
            // ACTIVAR LA NOVA SELECCIO
            var hash0 = hash.split("-")[0];
            document.querySelectorAll("#c_" + hash0).forEach(function (_this) {
                new bootstrap.Collapse(_this);
            });
            document.querySelector("#c_" + hash0 + " a[href='#" + hash + "']").classList.add("active");
            // ACTUALITZAR TITOLS
            document.title = data.songs[hash].info + " - " + data.labels.title;
            document.getElementById("titol").innerHTML = data.songs[hash].info + " - " + data.labels.title;
            // PINTAR TAULA
            _files(hash);
            // PINTAR PDF
            _pdf(hash);
        } else {
            // POSAR PARAULES AL CERCADOR
            document.querySelectorAll("input.search").forEach(function (_this) {
                _this.value = hash.substr(7);
            });
            // PINTAR CERCADOR
            _search();
        }
        // ANAR AL INICI DE LA PAGINA
        window.scrollTo(0, 0);
        // GUARDAR IDIOMA PEL REDIRECCIONADOR DEL INDEX.HTML
        var lang = document.querySelector("html").getAttribute("lang");
        docCookies.setItem("lang", lang, 365 * 86400, "/");
    };

    // PROGRAMAR RESIZE
    window.addEventListener("resize",function () {
        if (document.getElementById("pdf").offsetParent === null) {
            return;
        }
        _pdfViewer.currentScaleValue = _pdfViewer.currentScale * 2;
        _pdfViewer.currentScaleValue = "page-width";
    });

    // PROGRAMAR CERCADOR
    document.querySelectorAll("input.search").forEach(function(_this) {
        _this.addEventListener("keypress",function (e) {
            if (e.which != 13) {
                return;
            }
            _search();
        });
    });
    document.querySelectorAll("a.search").forEach(function(_this) {
        _this.addEventListener("click",function () {
            _search();
        });
    });

    // PER AMAGAR ELS FITXERS I EL PDF QUAN S'OBRE EL MENU EN MODE MOBIL
    document.getElementById("sidebarMenu").addEventListener("show.bs.collapse", function (e) {
        if (e.target.getAttribute("id") != "sidebarMenu") {
            return;
        }
        document.getElementById("result").classList.add("d-none");
        document.getElementById("files").classList.add("d-none");
        document.getElementById("pdf").classList.add("d-none");
    });

    // PER MOSTRAR ELS FITXERS I EL PDF QUAN ES TANCA EL MENU EN MODE MOBIL
    document.getElementById("sidebarMenu").addEventListener("hide.bs.collapse", function (e) {
        if (e.target.getAttribute("id") != "sidebarMenu") {
            return;
        }
        if (document.getElementById("result").offsetParent !== null) {
            return;
        }
        document.getElementById("files").classList.remove("d-none");
        document.getElementById("pdf").classList.remove("d-none");
    });

    // PER PREVENIR QUAN ES FA CLIC A UN LINK AMB EL MATEIX HASH
    document.addEventListener("click", function(e) {
        // Per detectar nomes nodes del tipus <a ...>
        if(e.target.tagName.toLowerCase() !== "a") {
            return;
        }
        // Continuar
        var hash1 = decodeURI(window.location.hash);
        var hash2 = e.target.getAttribute("href");
        if (hash1 != hash2) {
            return;
        }
        document.querySelectorAll("#sidebarMenu.show").forEach(function (_this) {
            new bootstrap.Collapse(_this);
        });
        document.getElementById("result").classList.add("d-none");
        document.getElementById("files").classList.remove("d-none");
        document.getElementById("pdf").classList.remove("d-none");
    });

    // FORAR UNA EXECUCIO DEL HASHCHANGE
    window.dispatchEvent(new HashChangeEvent("hashchange"));

}());

// PER PINTAR EL MENU
function _menu()
{
    // NETEJAR MENU
    document.querySelectorAll("#menu > div:not(:first-child)").forEach(function (_this) {
        _this.remove();
    });
    // PINTAR MENU
    for (var key in data.cats) {
        var val = data.cats[key];
        document.getElementById("menu").append(saltos.html(str_replace(["__TITLE__","__HEADING__","__COLLAPSE__"],[val.name,"h_" + key,"c_" + key],data.template[0]) + data.template[2]));
        for (var key2 in val.array) {
            var val2 = val.array[key2];
            document.querySelector("#c_" + key + " ul").append(saltos.html("ul", str_replace(["__TITLE__","__LINK__"],[data.songs[val2].name,"#" + val2],data.template[1])));
        }
    }
    // CALCULAR RANDOM HASH
    var keys = Object.keys(data.cats);
    var key = keys[keys.length * Math.random() << 0];
    var val = data.cats[key];
    var key2 = val.array.length * Math.random() << 0;
    var val2 = val.array[key2];
    _random_hash = val2;
    // MOSTRAR MENU
    document.getElementById("menu").classList.remove("d-none");
}

// RETURN THE HUMAN SIZE (GBYTES, MBYTES, KBYTES OR BYTES)
function __getmail_gethumansize(size)
{
    if (size > 1073741824) {
        size = (size / 1073741824).toFixed(2) + " Gbytes";
    } else if (size > 1048576) {
        size = (size / 1048576).toFixed(2) + " Mbytes";
    } else if (size > 1024) {
        size = (size / 1024).toFixed(2) + " Kbytes";
    } else {
        size = size + " bytes";
    }
    return size;
}

// PER PINTAR LA TAULA
function _files(hash)
{
    // TREURE TOTS ELS REPRODUCTORS DE MIDI
    for (var file in _midi) {
        if (_midi[file].timidity) {
            _midi[file].player.destroy();
        }
        delete _midi[file];
    }
    // NETEJAR TAULA
    document.querySelector("#files tbody").innerHTML = "";
    // MUNTAR NOVA TAULA
    for (var key in data.songs[hash].files) {
        var val = data.songs[hash].files[key];
        var type = val.last.split('.').pop();
        var label = data.labels[type];
        if (type == "pdf") {
            var text = str_replace([type,".","-"],"",val.last).toUpperCase();
            if (text != "") {
                label += " " + str_replace("__TEXT__",text,data.labels["papersize"]);
            }
        }
        if (["midi","mp3","mp4"].includes(type)) {
            var num = str_replace([type,".","-"],"",val.last);
            if (num != "") {
                label += " " + str_replace("__NUM__",num,data.labels["pista"]);
            }
        }
        var file = "<a href='files/" + hash + "/" + hash + val.last + "'>" + hash + val.last + "</a>";
        var play = "";
        if (["mp3","mp4"].includes(type)) {
            play = "<audio preload='none' src='files/" + hash + "/" + hash + val.last + "' controls></audio>";
        }
        if (type == "midi") {
            play = "<midi src='files/" + hash + "/" + hash + val.last + "'></midi>";
        }
        var size = __getmail_gethumansize(val.size);
        document.querySelector("#files tbody").append(saltos.html("tbody", str_replace(["__TYPE__","__FILE__","__SIZE__","__PLAY__"],[label,file,size,play],data.template[4])));
    }
    // CREAR AUDIOPLAYER
    document.querySelectorAll("audio").forEach(function (_this) {
        _audiofy(_this);
    });
    // CREAR MIDIPLAYER
    document.querySelectorAll("midi").forEach(function (_this) {
        _midify(_this);
    });
    // MOSTRAR TAULA
    document.getElementById("files").classList.remove("d-none");
}

// PER PINTAR EL PDF DE LA PARTITURA
function _pdf(hash)
{
    document.getElementById("pdf").innerHTML="<div id='viewerContainer'><div id='viewer' class='pdfViewer'></div></div>";
    pdfjsLib.GlobalWorkerOptions.workerSrc = "lib/pdfjs/pdf.worker.min.js";
    var base = document.head.querySelector("base").getAttribute("href").split("/")[0];
    pdfjsLib.getDocument(base + "/files/" + hash + "/" + hash + ".pdf").promise.then(function (pdfDocument) {
        if (!pdfDocument.numPages) {
            return;
        }
        var container = document.getElementById("viewerContainer");
        var eventBus = new pdfjsViewer.EventBus();
        _pdfViewer = new pdfjsViewer.PDFViewer({
            container:container,
            eventBus:eventBus,
        });
        eventBus.on("pagesinit",function () {
            _pdfViewer.currentScaleValue = "page-width";
        });
        eventBus.on("annotationlayerrendered",function () {
            container.querySelectorAll("a").forEach(function (_this) {
                _this.setAttribute("target", "_blank");
            });
        });
        _pdfViewer.removePageBorders = true;
        _pdfViewer.setDocument(pdfDocument);
        container.style.position = "relative";
        document.getElementById("pdf").classList.remove("d-none");
    },function (message,exception) {
        console.log(message);
    });
}

// PER MUNTAR EL CERCADOR
function _search()
{
    var text = "";
    document.querySelectorAll("input.search").forEach(function (_this) {
        if (_this.value != "") {
            text = _this.value;
            _this.value = "";
        }
    });
    if (text == "") {
        return;
    }
    var hash = "search=" + text;
    var oldhash = decodeURI(window.location.hash);
    if (oldhash.substr(0,1) == "#") {
        oldhash = oldhash.substr(1);
    }
    if (hash != oldhash) {
        history.pushState(null,null,"#" + hash);
    }
    // ACTUALITZAR COOKIE PER MES ENDAVANT
    docCookies.setItem("hash", hash, 365 * 86400, "/");
    // DESACTIVAR ANTIGA SELECCIO
    document.querySelectorAll("#menu .collapse.show").forEach(function (_this) {
        new bootstrap.Collapse(_this);
    });
    document.querySelectorAll("#menu a.active").forEach(function (_this) {
        _this.classList.remove("active");
    });
    // ACTUALITZAR TITOLS
    document.title = data.labels.title;
    document.getElementById("titol").innerHTML = data.labels.title;
    // CERCAR PER PARAULES
    text = str_replace(["-","_","/"]," ",text);
    text = accent_fold(text).trim().split(" ");
    var result_by_num = {};
    for (var key in data.songs) {
        var val = data.songs[key];
        if (typeof(val.cache) == "undefined") {
            val.cache = accent_fold(val.info);
        }
        var num = 0;
        for (var key2 in text) {
            if (val.cache.search(new RegExp(text[key2],"i")) != -1) {
                num++;
            }
        }
        if (num > 0) {
            if (!result_by_num.hasOwnProperty(num)) {
                result_by_num[num] = {};
            }
            result_by_num[num][key] = accent_folded_hilite(val.info + " - " + data.labels.title,text);
        }
    }
    var result = {};
    for (var i = text.length; i > 0; i--) {
        if (result_by_num.hasOwnProperty(i)) {
            Object.assign(result,result_by_num[i]);
        }
    }
    // NETEJAR CERCADOR
    document.querySelectorAll("#result > div").forEach(function (_this) {
        _this.remove();
    });
    // MOSTRAR RESULTATS
    var a = Math.min(Object.keys(result).length,2);
    var b = Math.min(text.length,2);
    var c = str_replace(["__NUM__","__TEXT__"],["<b>" + Object.keys(result).length + "</b>","<b>" + text.join(" ") + "</b>"],data.labels["found" + a + b]);
    document.getElementById("result").append(saltos.html(str_replace("__RESULT__",c,data.template[3])));
    for (key in result) {
        var val = "<a href='#" + key + "'>" + result[key] + "</a>";
        document.getElementById("result").append(saltos.html(str_replace("__RESULT__",val,data.template[3])));
    }
    // TREURE DARRERA LINIA
    document.querySelector("#result .border-bottom:last-child").classList.remove("border-bottom");
    // MOSTRAR CERCADOR I AMAGAR LA RESTA
    document.querySelectorAll("#sidebarMenu.show").forEach(function (_this) {
        new bootstrap.Collapse(_this);
    });
    document.getElementById("result").classList.remove("d-none");
    document.getElementById("files").classList.add("d-none");
    document.getElementById("pdf").classList.add("d-none");
}

// HELPER PER LA FUNCIO MIDIFY
function _sec2time(sec)
{
    var min = ("0" + parseInt(sec / 60).toString()).substr(-2);
    var sec = ("0" + parseInt(sec % 60).toString()).substr(-2);
    return min + ":" + sec;
}

// AIXO CREAR EL WIDGET DEL AUDIOPLAYER
function _audioplayer(obj)
{
    var div = saltos.html('\
    <div class="audioplayer audioplayer-stopped midiplayer">\
        <div class="audioplayer-playpause" title="Play"><a href="#">Play</a></div>\
        <div class="audioplayer-time audioplayer-time-current">00:00</div>\
        <div class="audioplayer-bar">\
        <div class="audioplayer-bar-loaded"></div>\
        <div class="audioplayer-bar-played"></div>\
        </div>\
        <div class="audioplayer-time audioplayer-time-duration">&hellip;</div>\
        <div class="audioplayer-volume" title="Stop"><a href="#">Stop</a>\
    </div>\
    ');

    var obj2 = obj.cloneNode();
    obj2.classList.add("d-none");
    div.append(obj2);
    obj.replaceWith(div);
    return div;
}

// CREA EL REPRODUCTOR DE MIDI
function _midify(obj)
{
    var div = _audioplayer(obj);
    var file = div.querySelector("midi").getAttribute("src");

    _midi[file] = {
        timidity:null,
        player:null,
        div:div,
        state:"",
    };

    var fn = function (e) {
        var div = this.parentNode;
        var file = div.querySelector("midi").getAttribute("src");
        var action = this.getAttribute("class");

        // TRUCS PER EVITAR CARREGAR-HO TOT QUAN NO CAL
        if (action == "audioplayer-volume" && _midi[file].state == "") {
            return false;
        }
        if (action == "audioplayer-bar" && _midi[file].state == "") {
            return false;
        }

        if (!_midi[file].timidity) {
            var dir = window.location.href.substr(0,window.location.href.lastIndexOf("/"));
            var base = document.head.querySelector("base").getAttribute("href").split("/")[0];

            _midi[file].timidity = require('timidity');
            _midi[file].player = new _midi[file].timidity(dir + "/" + base + "/" + "lib/timidity");

            _midi[file].player.on("timeupdate", () => {
                if (_midi[file].player.duration == 1) {
                    return;
                }
                var currenttime = _midi[file].player.currentTime;
                var duration = _midi[file].player.duration;
                div.querySelector(".audioplayer-time-current").innerHTML = _sec2time(currenttime);
                div.querySelector(".audioplayer-time-duration").innerHTML = _sec2time(duration);
                div.querySelector(".audioplayer-bar-played").style.width = parseInt(currenttime * 100 / duration) + "%";
            });

            _midi[file].player.on("ended", () => {
                _midi[file].player.seek(0);
                _midi[file].state = "stop";
                div.classList.remove("audioplayer-playing");
                div.classList.add("audioplayer-stopped");
                div.querySelector(".audioplayer-playpause").setAttribute("title","Play");
                div.querySelector(".audioplayer-playpause a").innerHTML = "Play";
            });

            _midi[file].player.load(dir + "/" + base + "/" + file);
            div.querySelector(".audioplayer-bar-loaded").style.width = "100%";
        }

        if (action == "audioplayer-playpause") {
            if (_midi[file].state != "play") {
                _midi[file].player.play();
                _midi[file].state = "play";
                div.classList.remove("audioplayer-stopped");
                div.classList.add("audioplayer-playing");
                div.querySelector(".audioplayer-playpause").setAttribute("title","Pause");
                div.querySelector(".audioplayer-playpause a").innerHTML = "Pause";
            } else {
                _midi[file].player.pause();
                _midi[file].state = "pause";
                div.classList.remove("audioplayer-playing");
                div.classList.add("audioplayer-stopped");
                div.querySelector(".audioplayer-playpause").setAttribute("title","Play");
                div.querySelector(".audioplayer-playpause a").innerHTML = "Play";
            }
        }

        if (action == "audioplayer-volume") {
            if (_midi[file].state == "play") {
                _midi[file].player.pause();
            }
            _midi[file].player.seek(0);
            _midi[file].state = "stop";
            div.classList.remove("audioplayer-playing");
            div.classList.add("audioplayer-stopped");
            div.querySelector(".audioplayer-playpause").setAttribute("title","Play");
            div.querySelector(".audioplayer-playpause a").innerHTML = "Play";
        }

        if (action == "audioplayer-bar") {
            var x = ('ontouchstart' in window) ? e.originalEvent.touches[0].pageX : e.pageX;
            var duration = _midi[file].player.duration;
            var temp = div.querySelector(".audioplayer-bar-loaded").getBoundingClientRect();
            var left = temp.left;
            var width = temp.width;
            _midi[file].player.seek(parseFloat(duration * (x - left) / width));
        }

        return false;
    };

    div.querySelector(".audioplayer-playpause").addEventListener("click",fn);
    div.querySelector(".audioplayer-volume").addEventListener("click",fn);
    div.querySelector(".audioplayer-bar").addEventListener(('ontouchstart' in window) ? "touchstart" : "mousedown",fn);
}

// CREA EL REPRODUCTOR D'AUDIO
function _audiofy(obj)
{
    var div = _audioplayer(obj);
    var audio = div.querySelector("audio");

    audio.addEventListener("durationchange", () => {
        div.querySelector(".audioplayer-bar-loaded").style.width = "100%";
    });

    audio.addEventListener("timeupdate", () => {
        var currenttime = audio.currentTime;
        var duration = audio.duration;
        div.querySelector(".audioplayer-time-current").innerHTML = _sec2time(currenttime);
        div.querySelector(".audioplayer-time-duration").innerHTML = _sec2time(duration);
        div.querySelector(".audioplayer-bar-played").style.width = parseInt(currenttime * 100 / duration) + "%";
    });

    audio.addEventListener("ended", () => {
        audio.currentTime = 0;
        div.classList.remove("audioplayer-playing");
        div.classList.add("audioplayer-stopped");
        div.querySelector(".audioplayer-playpause").setAttribute("title","Play");
        div.querySelector(".audioplayer-playpause a").innerHTML = "Play";
    });

    var fn = function (e) {
        var div = this.parentNode;
        var audio = div.querySelector("audio");
        var action = this.getAttribute("class");

        if (action == "audioplayer-playpause") {
            if (audio.paused) {
                audio.play();
                div.classList.remove("audioplayer-stopped");
                div.classList.add("audioplayer-playing");
                div.querySelector(".audioplayer-playpause").setAttribute("title","Pause");
                div.querySelector(".audioplayer-playpause a").innerHTML = "Pause";
            } else {
                audio.pause();
                div.classList.remove("audioplayer-playing");
                div.classList.add("audioplayer-stopped");
                div.querySelector(".audioplayer-playpause").setAttribute("title","Play");
                div.querySelector(".audioplayer-playpause a").innerHTML = "Play";
            }
        }

        if (action == "audioplayer-volume") {
            if (!audio.paused) {
                audio.pause();
            }
            audio.currentTime = 0;
            div.classList.remove("audioplayer-playing");
            div.classList.add("audioplayer-stopped");
            div.querySelector(".audioplayer-playpause").setAttribute("title","Play");
            div.querySelector(".audioplayer-playpause a").innerHTML = "Play";
        }

        if (action == "audioplayer-bar") {
            if (isNaN(audio.duration)) {
                return;
            }
            var x = ('ontouchstart' in window) ? e.originalEvent.touches[0].pageX : e.pageX;
            var duration = audio.duration;
            var temp = div.querySelector(".audioplayer-bar-loaded").getBoundingClientRect();
            var left = temp.left;
            var width = temp.width;
            audio.currentTime = parseFloat(duration * (x - left) / width);
        }

        return false;
    };

    div.querySelector(".audioplayer-playpause").addEventListener("click",fn);
    div.querySelector(".audioplayer-volume").addEventListener("click",fn);
    div.querySelector(".audioplayer-bar").addEventListener(('ontouchstart' in window) ? "touchstart" : "mousedown",fn);
}
